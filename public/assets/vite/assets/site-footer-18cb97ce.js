/* empty css                           */import{a as ar,x as z,r as F,n as b,b as kt,c as G,d as Z,E as ot,i as Hu,t as Wu,e as qu}from"./class-map-c7357fe1.js";import{d as Uu,c as lr,S as cr,L as dr,f as no,b as ei,g as Ku,_ as S,e as ct,w as Pn,i as qe,u as Ut,o as Qt,h as Gu,a as Zc,l as Va,j as Ha,k as Ju,t as Yu}from"./chunk.6CTB5ZDJ-8ae3ae4d.js";import{t as J,o as xt,c as hs,a as Wa}from"./js.cookie-4cba6d86.js";import{t as Xu,e as Zu,c as Qu}from"./site-nav-e192922e.js";import{o as sn,a as tp}from"./animation-201fe7f0.js";import{g as ep}from"./_commonjsHelpers-de833af9.js";import{_ as ro,i as Qc,b as an,c as np,e as io,f as rp}from"./debounce-323e2cb5.js";import{g as ip}from"./request-8716ca80.js";import{D as op}from"./drb-dialog-helpers-2852633b.js";/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function td(n){return(t,e)=>{const{slot:r}=n??{},i="slot"+(r?`[name=${r}]`:":not([name])");return Uu(t,e,{get(){var s;const o=(s=this.renderRoot)==null?void 0:s.querySelector(i);return(o==null?void 0:o.assignedNodes(n))??[]}})}}var sp=ar`
  :host {
    --track-width: 2px;
    --track-color: rgb(128 128 128 / 25%);
    --indicator-color: var(--sl-color-primary-600);
    --speed: 2s;

    display: inline-flex;
    width: 1em;
    height: 1em;
    flex: none;
  }

  .spinner {
    flex: 1 1 auto;
    height: 100%;
    width: 100%;
  }

  .spinner__track,
  .spinner__indicator {
    fill: none;
    stroke-width: var(--track-width);
    r: calc(0.5em - var(--track-width) / 2);
    cx: 0.5em;
    cy: 0.5em;
    transform-origin: 50% 50%;
  }

  .spinner__track {
    stroke: var(--track-color);
    transform-origin: 0% 0%;
  }

  .spinner__indicator {
    stroke: var(--indicator-color);
    stroke-linecap: round;
    stroke-dasharray: 150% 75%;
    animation: spin var(--speed) linear infinite;
  }

  @keyframes spin {
    0% {
      transform: rotate(0deg);
      stroke-dasharray: 0.05em, 3em;
    }

    50% {
      transform: rotate(450deg);
      stroke-dasharray: 1.375em, 1.375em;
    }

    100% {
      transform: rotate(1080deg);
      stroke-dasharray: 0.05em, 3em;
    }
  }
`,ed=class extends cr{constructor(){super(...arguments),this.localize=new dr(this)}render(){return z`
      <svg part="base" class="spinner" role="progressbar" aria-label=${this.localize.term("loading")}>
        <circle class="spinner__track"></circle>
        <circle class="spinner__indicator"></circle>
      </svg>
    `}};ed.styles=[lr,sp];var Cr=new WeakMap,Er=new WeakMap,Or=new WeakMap,To=new WeakSet,ci=new WeakMap,ap=class{constructor(n,t){this.handleFormData=e=>{const r=this.options.disabled(this.host),i=this.options.name(this.host),o=this.options.value(this.host),s=this.host.tagName.toLowerCase()==="sl-button";this.host.isConnected&&!r&&!s&&typeof i=="string"&&i.length>0&&typeof o<"u"&&(Array.isArray(o)?o.forEach(a=>{e.formData.append(i,a.toString())}):e.formData.append(i,o.toString()))},this.handleFormSubmit=e=>{var r;const i=this.options.disabled(this.host),o=this.options.reportValidity;this.form&&!this.form.noValidate&&((r=Cr.get(this.form))==null||r.forEach(s=>{this.setUserInteracted(s,!0)})),this.form&&!this.form.noValidate&&!i&&!o(this.host)&&(e.preventDefault(),e.stopImmediatePropagation())},this.handleFormReset=()=>{this.options.setValue(this.host,this.options.defaultValue(this.host)),this.setUserInteracted(this.host,!1),ci.set(this.host,[])},this.handleInteraction=e=>{const r=ci.get(this.host);r.includes(e.type)||r.push(e.type),r.length===this.options.assumeInteractionOn.length&&this.setUserInteracted(this.host,!0)},this.checkFormValidity=()=>{if(this.form&&!this.form.noValidate){const e=this.form.querySelectorAll("*");for(const r of e)if(typeof r.checkValidity=="function"&&!r.checkValidity())return!1}return!0},this.reportFormValidity=()=>{if(this.form&&!this.form.noValidate){const e=this.form.querySelectorAll("*");for(const r of e)if(typeof r.reportValidity=="function"&&!r.reportValidity())return!1}return!0},(this.host=n).addController(this),this.options=ei({form:e=>{const r=e.form;if(r){const o=e.getRootNode().querySelector(`#${r}`);if(o)return o}return e.closest("form")},name:e=>e.name,value:e=>e.value,defaultValue:e=>e.defaultValue,disabled:e=>{var r;return(r=e.disabled)!=null?r:!1},reportValidity:e=>typeof e.reportValidity=="function"?e.reportValidity():!0,checkValidity:e=>typeof e.checkValidity=="function"?e.checkValidity():!0,setValue:(e,r)=>e.value=r,assumeInteractionOn:["sl-input"]},t)}hostConnected(){const n=this.options.form(this.host);n&&this.attachForm(n),ci.set(this.host,[]),this.options.assumeInteractionOn.forEach(t=>{this.host.addEventListener(t,this.handleInteraction)})}hostDisconnected(){this.detachForm(),ci.delete(this.host),this.options.assumeInteractionOn.forEach(n=>{this.host.removeEventListener(n,this.handleInteraction)})}hostUpdated(){const n=this.options.form(this.host);n||this.detachForm(),n&&this.form!==n&&(this.detachForm(),this.attachForm(n)),this.host.hasUpdated&&this.setValidity(this.host.validity.valid)}attachForm(n){n?(this.form=n,Cr.has(this.form)?Cr.get(this.form).add(this.host):Cr.set(this.form,new Set([this.host])),this.form.addEventListener("formdata",this.handleFormData),this.form.addEventListener("submit",this.handleFormSubmit),this.form.addEventListener("reset",this.handleFormReset),Er.has(this.form)||(Er.set(this.form,this.form.reportValidity),this.form.reportValidity=()=>this.reportFormValidity()),Or.has(this.form)||(Or.set(this.form,this.form.checkValidity),this.form.checkValidity=()=>this.checkFormValidity())):this.form=void 0}detachForm(){if(!this.form)return;const n=Cr.get(this.form);n&&(n.delete(this.host),n.size<=0&&(this.form.removeEventListener("formdata",this.handleFormData),this.form.removeEventListener("submit",this.handleFormSubmit),this.form.removeEventListener("reset",this.handleFormReset),Er.has(this.form)&&(this.form.reportValidity=Er.get(this.form),Er.delete(this.form)),Or.has(this.form)&&(this.form.checkValidity=Or.get(this.form),Or.delete(this.form)),this.form=void 0))}setUserInteracted(n,t){t?To.add(n):To.delete(n),n.requestUpdate()}doAction(n,t){if(this.form){const e=document.createElement("button");e.type=n,e.style.position="absolute",e.style.width="0",e.style.height="0",e.style.clipPath="inset(50%)",e.style.overflow="hidden",e.style.whiteSpace="nowrap",t&&(e.name=t.name,e.value=t.value,["formaction","formenctype","formmethod","formnovalidate","formtarget"].forEach(r=>{t.hasAttribute(r)&&e.setAttribute(r,t.getAttribute(r))})),this.form.append(e),e.click(),e.remove()}}getForm(){var n;return(n=this.form)!=null?n:null}reset(n){this.doAction("reset",n)}submit(n){this.doAction("submit",n)}setValidity(n){const t=this.host,e=!!To.has(t),r=!!t.required;t.toggleAttribute("data-required",r),t.toggleAttribute("data-optional",!r),t.toggleAttribute("data-invalid",!n),t.toggleAttribute("data-valid",n),t.toggleAttribute("data-user-invalid",!n&&e),t.toggleAttribute("data-user-valid",n&&e)}updateValidity(){const n=this.host;this.setValidity(n.validity.valid)}emitInvalidEvent(n){const t=new CustomEvent("sl-invalid",{bubbles:!1,composed:!1,cancelable:!0,detail:{}});n||t.preventDefault(),this.host.dispatchEvent(t)||n==null||n.preventDefault()}},na=Object.freeze({badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valid:!0,valueMissing:!1});Object.freeze(no(ei({},na),{valid:!1,valueMissing:!0}));Object.freeze(no(ei({},na),{valid:!1,customError:!0}));var lp=ar`
  :host {
    display: inline-block;
    position: relative;
    width: auto;
    cursor: pointer;
  }

  .button {
    display: inline-flex;
    align-items: stretch;
    justify-content: center;
    width: 100%;
    border-style: solid;
    border-width: var(--sl-input-border-width);
    font-family: var(--sl-input-font-family);
    font-weight: var(--sl-font-weight-semibold);
    text-decoration: none;
    user-select: none;
    -webkit-user-select: none;
    white-space: nowrap;
    vertical-align: middle;
    padding: 0;
    transition:
      var(--sl-transition-x-fast) background-color,
      var(--sl-transition-x-fast) color,
      var(--sl-transition-x-fast) border,
      var(--sl-transition-x-fast) box-shadow;
    cursor: inherit;
  }

  .button::-moz-focus-inner {
    border: 0;
  }

  .button:focus {
    outline: none;
  }

  .button:focus-visible {
    outline: var(--sl-focus-ring);
    outline-offset: var(--sl-focus-ring-offset);
  }

  .button--disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  /* When disabled, prevent mouse events from bubbling up from children */
  .button--disabled * {
    pointer-events: none;
  }

  .button__prefix,
  .button__suffix {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    pointer-events: none;
  }

  .button__label {
    display: inline-block;
  }

  .button__label::slotted(sl-icon) {
    vertical-align: -2px;
  }

  /*
   * Standard buttons
   */

  /* Default */
  .button--standard.button--default {
    background-color: var(--sl-color-neutral-0);
    border-color: var(--sl-input-border-color);
    color: var(--sl-color-neutral-700);
  }

  .button--standard.button--default:hover:not(.button--disabled) {
    background-color: var(--sl-color-primary-50);
    border-color: var(--sl-color-primary-300);
    color: var(--sl-color-primary-700);
  }

  .button--standard.button--default:active:not(.button--disabled) {
    background-color: var(--sl-color-primary-100);
    border-color: var(--sl-color-primary-400);
    color: var(--sl-color-primary-700);
  }

  /* Primary */
  .button--standard.button--primary {
    background-color: var(--sl-color-primary-600);
    border-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--primary:hover:not(.button--disabled) {
    background-color: var(--sl-color-primary-500);
    border-color: var(--sl-color-primary-500);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--primary:active:not(.button--disabled) {
    background-color: var(--sl-color-primary-600);
    border-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
  }

  /* Success */
  .button--standard.button--success {
    background-color: var(--sl-color-success-600);
    border-color: var(--sl-color-success-600);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--success:hover:not(.button--disabled) {
    background-color: var(--sl-color-success-500);
    border-color: var(--sl-color-success-500);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--success:active:not(.button--disabled) {
    background-color: var(--sl-color-success-600);
    border-color: var(--sl-color-success-600);
    color: var(--sl-color-neutral-0);
  }

  /* Neutral */
  .button--standard.button--neutral {
    background-color: var(--sl-color-neutral-600);
    border-color: var(--sl-color-neutral-600);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--neutral:hover:not(.button--disabled) {
    background-color: var(--sl-color-neutral-500);
    border-color: var(--sl-color-neutral-500);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--neutral:active:not(.button--disabled) {
    background-color: var(--sl-color-neutral-600);
    border-color: var(--sl-color-neutral-600);
    color: var(--sl-color-neutral-0);
  }

  /* Warning */
  .button--standard.button--warning {
    background-color: var(--sl-color-warning-600);
    border-color: var(--sl-color-warning-600);
    color: var(--sl-color-neutral-0);
  }
  .button--standard.button--warning:hover:not(.button--disabled) {
    background-color: var(--sl-color-warning-500);
    border-color: var(--sl-color-warning-500);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--warning:active:not(.button--disabled) {
    background-color: var(--sl-color-warning-600);
    border-color: var(--sl-color-warning-600);
    color: var(--sl-color-neutral-0);
  }

  /* Danger */
  .button--standard.button--danger {
    background-color: var(--sl-color-danger-600);
    border-color: var(--sl-color-danger-600);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--danger:hover:not(.button--disabled) {
    background-color: var(--sl-color-danger-500);
    border-color: var(--sl-color-danger-500);
    color: var(--sl-color-neutral-0);
  }

  .button--standard.button--danger:active:not(.button--disabled) {
    background-color: var(--sl-color-danger-600);
    border-color: var(--sl-color-danger-600);
    color: var(--sl-color-neutral-0);
  }

  /*
   * Outline buttons
   */

  .button--outline {
    background: none;
    border: solid 1px;
  }

  /* Default */
  .button--outline.button--default {
    border-color: var(--sl-input-border-color);
    color: var(--sl-color-neutral-700);
  }

  .button--outline.button--default:hover:not(.button--disabled),
  .button--outline.button--default.button--checked:not(.button--disabled) {
    border-color: var(--sl-color-primary-600);
    background-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--default:active:not(.button--disabled) {
    border-color: var(--sl-color-primary-700);
    background-color: var(--sl-color-primary-700);
    color: var(--sl-color-neutral-0);
  }

  /* Primary */
  .button--outline.button--primary {
    border-color: var(--sl-color-primary-600);
    color: var(--sl-color-primary-600);
  }

  .button--outline.button--primary:hover:not(.button--disabled),
  .button--outline.button--primary.button--checked:not(.button--disabled) {
    background-color: var(--sl-color-primary-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--primary:active:not(.button--disabled) {
    border-color: var(--sl-color-primary-700);
    background-color: var(--sl-color-primary-700);
    color: var(--sl-color-neutral-0);
  }

  /* Success */
  .button--outline.button--success {
    border-color: var(--sl-color-success-600);
    color: var(--sl-color-success-600);
  }

  .button--outline.button--success:hover:not(.button--disabled),
  .button--outline.button--success.button--checked:not(.button--disabled) {
    background-color: var(--sl-color-success-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--success:active:not(.button--disabled) {
    border-color: var(--sl-color-success-700);
    background-color: var(--sl-color-success-700);
    color: var(--sl-color-neutral-0);
  }

  /* Neutral */
  .button--outline.button--neutral {
    border-color: var(--sl-color-neutral-600);
    color: var(--sl-color-neutral-600);
  }

  .button--outline.button--neutral:hover:not(.button--disabled),
  .button--outline.button--neutral.button--checked:not(.button--disabled) {
    background-color: var(--sl-color-neutral-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--neutral:active:not(.button--disabled) {
    border-color: var(--sl-color-neutral-700);
    background-color: var(--sl-color-neutral-700);
    color: var(--sl-color-neutral-0);
  }

  /* Warning */
  .button--outline.button--warning {
    border-color: var(--sl-color-warning-600);
    color: var(--sl-color-warning-600);
  }

  .button--outline.button--warning:hover:not(.button--disabled),
  .button--outline.button--warning.button--checked:not(.button--disabled) {
    background-color: var(--sl-color-warning-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--warning:active:not(.button--disabled) {
    border-color: var(--sl-color-warning-700);
    background-color: var(--sl-color-warning-700);
    color: var(--sl-color-neutral-0);
  }

  /* Danger */
  .button--outline.button--danger {
    border-color: var(--sl-color-danger-600);
    color: var(--sl-color-danger-600);
  }

  .button--outline.button--danger:hover:not(.button--disabled),
  .button--outline.button--danger.button--checked:not(.button--disabled) {
    background-color: var(--sl-color-danger-600);
    color: var(--sl-color-neutral-0);
  }

  .button--outline.button--danger:active:not(.button--disabled) {
    border-color: var(--sl-color-danger-700);
    background-color: var(--sl-color-danger-700);
    color: var(--sl-color-neutral-0);
  }

  @media (forced-colors: active) {
    .button.button--outline.button--checked:not(.button--disabled) {
      outline: solid 2px transparent;
    }
  }

  /*
   * Text buttons
   */

  .button--text {
    background-color: transparent;
    border-color: transparent;
    color: var(--sl-color-primary-600);
  }

  .button--text:hover:not(.button--disabled) {
    background-color: transparent;
    border-color: transparent;
    color: var(--sl-color-primary-500);
  }

  .button--text:focus-visible:not(.button--disabled) {
    background-color: transparent;
    border-color: transparent;
    color: var(--sl-color-primary-500);
  }

  .button--text:active:not(.button--disabled) {
    background-color: transparent;
    border-color: transparent;
    color: var(--sl-color-primary-700);
  }

  /*
   * Size modifiers
   */

  .button--small {
    height: auto;
    min-height: var(--sl-input-height-small);
    font-size: var(--sl-button-font-size-small);
    line-height: calc(var(--sl-input-height-small) - var(--sl-input-border-width) * 2);
    border-radius: var(--sl-input-border-radius-small);
  }

  .button--medium {
    height: auto;
    min-height: var(--sl-input-height-medium);
    font-size: var(--sl-button-font-size-medium);
    line-height: calc(var(--sl-input-height-medium) - var(--sl-input-border-width) * 2);
    border-radius: var(--sl-input-border-radius-medium);
  }

  .button--large {
    height: auto;
    min-height: var(--sl-input-height-large);
    font-size: var(--sl-button-font-size-large);
    line-height: calc(var(--sl-input-height-large) - var(--sl-input-border-width) * 2);
    border-radius: var(--sl-input-border-radius-large);
  }

  /*
   * Pill modifier
   */

  .button--pill.button--small {
    border-radius: var(--sl-input-height-small);
  }

  .button--pill.button--medium {
    border-radius: var(--sl-input-height-medium);
  }

  .button--pill.button--large {
    border-radius: var(--sl-input-height-large);
  }

  /*
   * Circle modifier
   */

  .button--circle {
    padding-left: 0;
    padding-right: 0;
  }

  .button--circle.button--small {
    width: var(--sl-input-height-small);
    border-radius: 50%;
  }

  .button--circle.button--medium {
    width: var(--sl-input-height-medium);
    border-radius: 50%;
  }

  .button--circle.button--large {
    width: var(--sl-input-height-large);
    border-radius: 50%;
  }

  .button--circle .button__prefix,
  .button--circle .button__suffix,
  .button--circle .button__caret {
    display: none;
  }

  /*
   * Caret modifier
   */

  .button--caret .button__suffix {
    display: none;
  }

  .button--caret .button__caret {
    height: auto;
  }

  /*
   * Loading modifier
   */

  .button--loading {
    position: relative;
    cursor: wait;
  }

  .button--loading .button__prefix,
  .button--loading .button__label,
  .button--loading .button__suffix,
  .button--loading .button__caret {
    visibility: hidden;
  }

  .button--loading sl-spinner {
    --indicator-color: currentColor;
    position: absolute;
    font-size: 1em;
    height: 1em;
    width: 1em;
    top: calc(50% - 0.5em);
    left: calc(50% - 0.5em);
  }

  /*
   * Badges
   */

  .button ::slotted(sl-badge) {
    position: absolute;
    top: 0;
    right: 0;
    translate: 50% -50%;
    pointer-events: none;
  }

  .button--rtl ::slotted(sl-badge) {
    right: auto;
    left: 0;
    translate: -50% -50%;
  }

  /*
   * Button spacing
   */

  .button--has-label.button--small .button__label {
    padding: 0 var(--sl-spacing-small);
  }

  .button--has-label.button--medium .button__label {
    padding: 0 var(--sl-spacing-medium);
  }

  .button--has-label.button--large .button__label {
    padding: 0 var(--sl-spacing-large);
  }

  .button--has-prefix.button--small {
    padding-inline-start: var(--sl-spacing-x-small);
  }

  .button--has-prefix.button--small .button__label {
    padding-inline-start: var(--sl-spacing-x-small);
  }

  .button--has-prefix.button--medium {
    padding-inline-start: var(--sl-spacing-small);
  }

  .button--has-prefix.button--medium .button__label {
    padding-inline-start: var(--sl-spacing-small);
  }

  .button--has-prefix.button--large {
    padding-inline-start: var(--sl-spacing-small);
  }

  .button--has-prefix.button--large .button__label {
    padding-inline-start: var(--sl-spacing-small);
  }

  .button--has-suffix.button--small,
  .button--caret.button--small {
    padding-inline-end: var(--sl-spacing-x-small);
  }

  .button--has-suffix.button--small .button__label,
  .button--caret.button--small .button__label {
    padding-inline-end: var(--sl-spacing-x-small);
  }

  .button--has-suffix.button--medium,
  .button--caret.button--medium {
    padding-inline-end: var(--sl-spacing-small);
  }

  .button--has-suffix.button--medium .button__label,
  .button--caret.button--medium .button__label {
    padding-inline-end: var(--sl-spacing-small);
  }

  .button--has-suffix.button--large,
  .button--caret.button--large {
    padding-inline-end: var(--sl-spacing-small);
  }

  .button--has-suffix.button--large .button__label,
  .button--caret.button--large .button__label {
    padding-inline-end: var(--sl-spacing-small);
  }

  /*
   * Button groups support a variety of button types (e.g. buttons with tooltips, buttons as dropdown triggers, etc.).
   * This means buttons aren't always direct descendants of the button group, thus we can't target them with the
   * ::slotted selector. To work around this, the button group component does some magic to add these special classes to
   * buttons and we style them here instead.
   */

  :host([data-sl-button-group__button--first]:not([data-sl-button-group__button--last])) .button {
    border-start-end-radius: 0;
    border-end-end-radius: 0;
  }

  :host([data-sl-button-group__button--inner]) .button {
    border-radius: 0;
  }

  :host([data-sl-button-group__button--last]:not([data-sl-button-group__button--first])) .button {
    border-start-start-radius: 0;
    border-end-start-radius: 0;
  }

  /* All except the first */
  :host([data-sl-button-group__button]:not([data-sl-button-group__button--first])) {
    margin-inline-start: calc(-1 * var(--sl-input-border-width));
  }

  /* Add a visual separator between solid buttons */
  :host(
      [data-sl-button-group__button]:not(
          [data-sl-button-group__button--first],
          [data-sl-button-group__button--radio],
          [variant='default']
        ):not(:hover)
    )
    .button:after {
    content: '';
    position: absolute;
    top: 0;
    inset-inline-start: 0;
    bottom: 0;
    border-left: solid 1px rgb(128 128 128 / 33%);
    mix-blend-mode: multiply;
  }

  /* Bump hovered, focused, and checked buttons up so their focus ring isn't clipped */
  :host([data-sl-button-group__button--hover]) {
    z-index: 1;
  }

  /* Focus and checked are always on top */
  :host([data-sl-button-group__button--focus]),
  :host([data-sl-button-group__button][checked]) {
    z-index: 2;
  }
`,ra=class{constructor(n,...t){this.slotNames=[],this.handleSlotChange=e=>{const r=e.target;(this.slotNames.includes("[default]")&&!r.name||r.name&&this.slotNames.includes(r.name))&&this.host.requestUpdate()},(this.host=n).addController(this),this.slotNames=t}hasDefaultSlot(){return[...this.host.childNodes].some(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent.trim()!=="")return!0;if(n.nodeType===n.ELEMENT_NODE){const t=n;if(t.tagName.toLowerCase()==="sl-visually-hidden")return!1;if(!t.hasAttribute("slot"))return!0}return!1})}hasNamedSlot(n){return this.host.querySelector(`:scope > [slot="${n}"]`)!==null}test(n){return n==="[default]"?this.hasDefaultSlot():this.hasNamedSlot(n)}hostConnected(){this.host.shadowRoot.addEventListener("slotchange",this.handleSlotChange)}hostDisconnected(){this.host.shadowRoot.removeEventListener("slotchange",this.handleSlotChange)}},V=class extends cr{constructor(){super(...arguments),this.formControlController=new ap(this,{assumeInteractionOn:["click"]}),this.hasSlotController=new ra(this,"[default]","prefix","suffix"),this.localize=new dr(this),this.hasFocus=!1,this.invalid=!1,this.title="",this.variant="default",this.size="medium",this.caret=!1,this.disabled=!1,this.loading=!1,this.outline=!1,this.pill=!1,this.circle=!1,this.type="button",this.name="",this.value="",this.href="",this.rel="noreferrer noopener"}get validity(){return this.isButton()?this.button.validity:na}get validationMessage(){return this.isButton()?this.button.validationMessage:""}firstUpdated(){this.isButton()&&this.formControlController.updateValidity()}handleBlur(){this.hasFocus=!1,this.emit("sl-blur")}handleFocus(){this.hasFocus=!0,this.emit("sl-focus")}handleClick(){this.type==="submit"&&this.formControlController.submit(this),this.type==="reset"&&this.formControlController.reset(this)}handleInvalid(n){this.formControlController.setValidity(!1),this.formControlController.emitInvalidEvent(n)}isButton(){return!this.href}isLink(){return!!this.href}handleDisabledChange(){this.isButton()&&this.formControlController.setValidity(this.disabled)}click(){this.button.click()}focus(n){this.button.focus(n)}blur(){this.button.blur()}checkValidity(){return this.isButton()?this.button.checkValidity():!0}getForm(){return this.formControlController.getForm()}reportValidity(){return this.isButton()?this.button.reportValidity():!0}setCustomValidity(n){this.isButton()&&(this.button.setCustomValidity(n),this.formControlController.updateValidity())}render(){const n=this.isLink(),t=n?qe`a`:qe`button`;return Ut`
      <${t}
        part="base"
        class=${kt({button:!0,"button--default":this.variant==="default","button--primary":this.variant==="primary","button--success":this.variant==="success","button--neutral":this.variant==="neutral","button--warning":this.variant==="warning","button--danger":this.variant==="danger","button--text":this.variant==="text","button--small":this.size==="small","button--medium":this.size==="medium","button--large":this.size==="large","button--caret":this.caret,"button--circle":this.circle,"button--disabled":this.disabled,"button--focused":this.hasFocus,"button--loading":this.loading,"button--standard":!this.outline,"button--outline":this.outline,"button--pill":this.pill,"button--rtl":this.localize.dir()==="rtl","button--has-label":this.hasSlotController.test("[default]"),"button--has-prefix":this.hasSlotController.test("prefix"),"button--has-suffix":this.hasSlotController.test("suffix")})}
        ?disabled=${Qt(n?void 0:this.disabled)}
        type=${Qt(n?void 0:this.type)}
        title=${this.title}
        name=${Qt(n?void 0:this.name)}
        value=${Qt(n?void 0:this.value)}
        href=${Qt(n&&!this.disabled?this.href:void 0)}
        target=${Qt(n?this.target:void 0)}
        download=${Qt(n?this.download:void 0)}
        rel=${Qt(n?this.rel:void 0)}
        role=${Qt(n?void 0:"button")}
        aria-disabled=${this.disabled?"true":"false"}
        tabindex=${this.disabled?"-1":"0"}
        @blur=${this.handleBlur}
        @focus=${this.handleFocus}
        @invalid=${this.isButton()?this.handleInvalid:null}
        @click=${this.handleClick}
      >
        <slot name="prefix" part="prefix" class="button__prefix"></slot>
        <slot part="label" class="button__label"></slot>
        <slot name="suffix" part="suffix" class="button__suffix"></slot>
        ${this.caret?Ut` <sl-icon part="caret" class="button__caret" library="system" name="caret"></sl-icon> `:""}
        ${this.loading?Ut`<sl-spinner part="spinner"></sl-spinner>`:""}
      </${t}>
    `}};V.styles=[lr,lp];V.dependencies={"sl-icon":Ku,"sl-spinner":ed};S([ct(".button")],V.prototype,"button",2);S([F()],V.prototype,"hasFocus",2);S([F()],V.prototype,"invalid",2);S([b()],V.prototype,"title",2);S([b({reflect:!0})],V.prototype,"variant",2);S([b({reflect:!0})],V.prototype,"size",2);S([b({type:Boolean,reflect:!0})],V.prototype,"caret",2);S([b({type:Boolean,reflect:!0})],V.prototype,"disabled",2);S([b({type:Boolean,reflect:!0})],V.prototype,"loading",2);S([b({type:Boolean,reflect:!0})],V.prototype,"outline",2);S([b({type:Boolean,reflect:!0})],V.prototype,"pill",2);S([b({type:Boolean,reflect:!0})],V.prototype,"circle",2);S([b()],V.prototype,"type",2);S([b()],V.prototype,"name",2);S([b()],V.prototype,"value",2);S([b()],V.prototype,"href",2);S([b()],V.prototype,"target",2);S([b()],V.prototype,"rel",2);S([b()],V.prototype,"download",2);S([b()],V.prototype,"form",2);S([b({attribute:"formaction"})],V.prototype,"formAction",2);S([b({attribute:"formenctype"})],V.prototype,"formEnctype",2);S([b({attribute:"formmethod"})],V.prototype,"formMethod",2);S([b({attribute:"formnovalidate",type:Boolean})],V.prototype,"formNoValidate",2);S([b({attribute:"formtarget"})],V.prototype,"formTarget",2);S([Pn("disabled",{waitUntilFirstUpdate:!0})],V.prototype,"handleDisabledChange",1);V.define("sl-button");var qa=new WeakMap;function nd(n){let t=qa.get(n);return t||(t=window.getComputedStyle(n,null),qa.set(n,t)),t}function cp(n){if(typeof n.checkVisibility=="function")return n.checkVisibility({checkOpacity:!1,checkVisibilityCSS:!0});const t=nd(n);return t.visibility!=="hidden"&&t.display!=="none"}function dp(n){const t=nd(n),{overflowY:e,overflowX:r}=t;return e==="scroll"||r==="scroll"?!0:e!=="auto"||r!=="auto"?!1:n.scrollHeight>n.clientHeight&&e==="auto"||n.scrollWidth>n.clientWidth&&r==="auto"}function hp(n){const t=n.tagName.toLowerCase(),e=Number(n.getAttribute("tabindex"));if(n.hasAttribute("tabindex")&&(isNaN(e)||e<=-1)||n.hasAttribute("disabled")||n.closest("[inert]"))return!1;if(t==="input"&&n.getAttribute("type")==="radio"){const o=n.getRootNode(),s=`input[type='radio'][name="${n.getAttribute("name")}"]`,a=o.querySelector(`${s}:checked`);return a?a===n:o.querySelector(s)===n}return cp(n)?(t==="audio"||t==="video")&&n.hasAttribute("controls")||n.hasAttribute("tabindex")||n.hasAttribute("contenteditable")&&n.getAttribute("contenteditable")!=="false"||["button","input","select","textarea","a","audio","video","summary","iframe"].includes(t)?!0:dp(n):!1}function up(n,t){var e;return((e=n.getRootNode({composed:!0}))==null?void 0:e.host)!==t}function Ua(n){const t=new WeakMap,e=[];function r(i){if(i instanceof Element){if(i.hasAttribute("inert")||i.closest("[inert]")||t.has(i))return;t.set(i,!0),!e.includes(i)&&hp(i)&&e.push(i),i instanceof HTMLSlotElement&&up(i,n)&&i.assignedElements({flatten:!0}).forEach(o=>{r(o)}),i.shadowRoot!==null&&i.shadowRoot.mode==="open"&&r(i.shadowRoot)}for(const o of i.children)r(o)}return r(n),e.sort((i,o)=>{const s=Number(i.getAttribute("tabindex"))||0;return(Number(o.getAttribute("tabindex"))||0)-s})}function*ia(n=document.activeElement){n!=null&&(yield n,"shadowRoot"in n&&n.shadowRoot&&n.shadowRoot.mode!=="closed"&&(yield*Gu(ia(n.shadowRoot.activeElement))))}function pp(){return[...ia()].pop()}var Mr=[],fp=class{constructor(n){this.tabDirection="forward",this.handleFocusIn=()=>{this.isActive()&&this.checkFocus()},this.handleKeyDown=t=>{var e;if(t.key!=="Tab"||this.isExternalActivated||!this.isActive())return;const r=pp();if(this.previousFocus=r,this.previousFocus&&this.possiblyHasTabbableChildren(this.previousFocus))return;t.shiftKey?this.tabDirection="backward":this.tabDirection="forward";const i=Ua(this.element);let o=i.findIndex(a=>a===r);this.previousFocus=this.currentFocus;const s=this.tabDirection==="forward"?1:-1;for(;;){o+s>=i.length?o=0:o+s<0?o=i.length-1:o+=s,this.previousFocus=this.currentFocus;const a=i[o];if(this.tabDirection==="backward"&&this.previousFocus&&this.possiblyHasTabbableChildren(this.previousFocus)||a&&this.possiblyHasTabbableChildren(a))return;t.preventDefault(),this.currentFocus=a,(e=this.currentFocus)==null||e.focus({preventScroll:!1});const l=[...ia()];if(l.includes(this.currentFocus)||!l.includes(this.previousFocus))break}setTimeout(()=>this.checkFocus())},this.handleKeyUp=()=>{this.tabDirection="forward"},this.element=n,this.elementsWithTabbableControls=["iframe"]}activate(){Mr.push(this.element),document.addEventListener("focusin",this.handleFocusIn),document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}deactivate(){Mr=Mr.filter(n=>n!==this.element),this.currentFocus=null,document.removeEventListener("focusin",this.handleFocusIn),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp)}isActive(){return Mr[Mr.length-1]===this.element}activateExternal(){this.isExternalActivated=!0}deactivateExternal(){this.isExternalActivated=!1}checkFocus(){if(this.isActive()&&!this.isExternalActivated){const n=Ua(this.element);if(!this.element.matches(":focus-within")){const t=n[0],e=n[n.length-1],r=this.tabDirection==="forward"?t:e;typeof(r==null?void 0:r.focus)=="function"&&(this.currentFocus=r,r.focus({preventScroll:!1}))}}}possiblyHasTabbableChildren(n){return this.elementsWithTabbableControls.includes(n.tagName.toLowerCase())||n.hasAttribute("controls")}},mp=ar`
  :host {
    --width: 31rem;
    --header-spacing: var(--sl-spacing-large);
    --body-spacing: var(--sl-spacing-large);
    --footer-spacing: var(--sl-spacing-large);

    display: contents;
  }

  .dialog {
    display: flex;
    align-items: center;
    justify-content: center;
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    z-index: var(--sl-z-index-dialog);
  }

  .dialog__panel {
    display: flex;
    flex-direction: column;
    z-index: 2;
    width: var(--width);
    max-width: calc(100% - var(--sl-spacing-2x-large));
    max-height: calc(100% - var(--sl-spacing-2x-large));
    background-color: var(--sl-panel-background-color);
    border-radius: var(--sl-border-radius-medium);
    box-shadow: var(--sl-shadow-x-large);
  }

  .dialog__panel:focus {
    outline: none;
  }

  /* Ensure there's enough vertical padding for phones that don't update vh when chrome appears (e.g. iPhone) */
  @media screen and (max-width: 420px) {
    .dialog__panel {
      max-height: 80vh;
    }
  }

  .dialog--open .dialog__panel {
    display: flex;
    opacity: 1;
  }

  .dialog__header {
    flex: 0 0 auto;
    display: flex;
  }

  .dialog__title {
    flex: 1 1 auto;
    font: inherit;
    font-size: var(--sl-font-size-large);
    line-height: var(--sl-line-height-dense);
    padding: var(--header-spacing);
    margin: 0;
  }

  .dialog__header-actions {
    flex-shrink: 0;
    display: flex;
    flex-wrap: wrap;
    justify-content: end;
    gap: var(--sl-spacing-2x-small);
    padding: 0 var(--header-spacing);
  }

  .dialog__header-actions sl-icon-button,
  .dialog__header-actions ::slotted(sl-icon-button) {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    font-size: var(--sl-font-size-medium);
  }

  .dialog__body {
    flex: 1 1 auto;
    display: block;
    padding: var(--body-spacing);
    overflow: auto;
    -webkit-overflow-scrolling: touch;
  }

  .dialog__footer {
    flex: 0 0 auto;
    text-align: right;
    padding: var(--footer-spacing);
  }

  .dialog__footer ::slotted(sl-button:not(:first-of-type)) {
    margin-inline-start: var(--sl-spacing-x-small);
  }

  .dialog:not(.dialog--has-footer) .dialog__footer {
    display: none;
  }

  .dialog__overlay {
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    background-color: var(--sl-overlay-background-color);
  }

  @media (forced-colors: active) {
    .dialog__panel {
      border: solid 1px var(--sl-color-neutral-0);
    }
  }
`,rd=new Map,gp=new WeakMap;function bp(n){return n??{keyframes:[],options:{duration:0}}}function Ka(n,t){return t.toLowerCase()==="rtl"?{keyframes:n.rtlKeyframes||n.keyframes,options:n.options}:n}function Be(n,t){rd.set(n,bp(t))}function De(n,t,e){const r=gp.get(n);if(r!=null&&r[t])return Ka(r[t],e.dir);const i=rd.get(t);return i?Ka(i,e.dir):{keyframes:[],options:{duration:0}}}function Qn(n,t){return new Promise(e=>{function r(i){i.target===n&&(n.removeEventListener(t,r),e())}n.addEventListener(t,r)})}function $e(n,t,e){return new Promise(r=>{if((e==null?void 0:e.duration)===1/0)throw new Error("Promise-based animations must be finite.");const i=n.animate(t,no(ei({},e),{duration:yp()?0:e.duration}));i.addEventListener("cancel",r,{once:!0}),i.addEventListener("finish",r,{once:!0})})}function Ga(n){return n=n.toString().toLowerCase(),n.indexOf("ms")>-1?parseFloat(n):n.indexOf("s")>-1?parseFloat(n)*1e3:parseFloat(n)}function yp(){return window.matchMedia("(prefers-reduced-motion: reduce)").matches}function Ue(n){return Promise.all(n.getAnimations().map(t=>new Promise(e=>{t.cancel(),requestAnimationFrame(e)})))}var Ce=class extends cr{constructor(){super(...arguments),this.hasSlotController=new ra(this,"footer"),this.localize=new dr(this),this.modal=new fp(this),this.open=!1,this.label="",this.noHeader=!1,this.handleDocumentKeyDown=n=>{n.key==="Escape"&&this.modal.isActive()&&this.open&&(n.stopPropagation(),this.requestClose("keyboard"))}}firstUpdated(){this.dialog.hidden=!this.open,this.open&&(this.addOpenListeners(),this.modal.activate(),Va(this))}disconnectedCallback(){super.disconnectedCallback(),this.modal.deactivate(),Ha(this),this.removeOpenListeners()}requestClose(n){if(this.emit("sl-request-close",{cancelable:!0,detail:{source:n}}).defaultPrevented){const e=De(this,"dialog.denyClose",{dir:this.localize.dir()});$e(this.panel,e.keyframes,e.options);return}this.hide()}addOpenListeners(){var n;"CloseWatcher"in window?((n=this.closeWatcher)==null||n.destroy(),this.closeWatcher=new CloseWatcher,this.closeWatcher.onclose=()=>this.requestClose("keyboard")):document.addEventListener("keydown",this.handleDocumentKeyDown)}removeOpenListeners(){var n;(n=this.closeWatcher)==null||n.destroy(),document.removeEventListener("keydown",this.handleDocumentKeyDown)}async handleOpenChange(){if(this.open){this.emit("sl-show"),this.addOpenListeners(),this.originalTrigger=document.activeElement,this.modal.activate(),Va(this);const n=this.querySelector("[autofocus]");n&&n.removeAttribute("autofocus"),await Promise.all([Ue(this.dialog),Ue(this.overlay)]),this.dialog.hidden=!1,requestAnimationFrame(()=>{this.emit("sl-initial-focus",{cancelable:!0}).defaultPrevented||(n?n.focus({preventScroll:!0}):this.panel.focus({preventScroll:!0})),n&&n.setAttribute("autofocus","")});const t=De(this,"dialog.show",{dir:this.localize.dir()}),e=De(this,"dialog.overlay.show",{dir:this.localize.dir()});await Promise.all([$e(this.panel,t.keyframes,t.options),$e(this.overlay,e.keyframes,e.options)]),this.emit("sl-after-show")}else{this.emit("sl-hide"),this.removeOpenListeners(),this.modal.deactivate(),await Promise.all([Ue(this.dialog),Ue(this.overlay)]);const n=De(this,"dialog.hide",{dir:this.localize.dir()}),t=De(this,"dialog.overlay.hide",{dir:this.localize.dir()});await Promise.all([$e(this.overlay,t.keyframes,t.options).then(()=>{this.overlay.hidden=!0}),$e(this.panel,n.keyframes,n.options).then(()=>{this.panel.hidden=!0})]),this.dialog.hidden=!0,this.overlay.hidden=!1,this.panel.hidden=!1,Ha(this);const e=this.originalTrigger;typeof(e==null?void 0:e.focus)=="function"&&setTimeout(()=>e.focus()),this.emit("sl-after-hide")}}async show(){if(!this.open)return this.open=!0,Qn(this,"sl-after-show")}async hide(){if(this.open)return this.open=!1,Qn(this,"sl-after-hide")}render(){return z`
      <div
        part="base"
        class=${kt({dialog:!0,"dialog--open":this.open,"dialog--has-footer":this.hasSlotController.test("footer")})}
      >
        <div part="overlay" class="dialog__overlay" @click=${()=>this.requestClose("overlay")} tabindex="-1"></div>

        <div
          part="panel"
          class="dialog__panel"
          role="dialog"
          aria-modal="true"
          aria-hidden=${this.open?"false":"true"}
          aria-label=${Qt(this.noHeader?this.label:void 0)}
          aria-labelledby=${Qt(this.noHeader?void 0:"title")}
          tabindex="-1"
        >
          ${this.noHeader?"":z`
                <header part="header" class="dialog__header">
                  <h2 part="title" class="dialog__title" id="title">
                    <slot name="label"> ${this.label.length>0?this.label:String.fromCharCode(65279)} </slot>
                  </h2>
                  <div part="header-actions" class="dialog__header-actions">
                    <slot name="header-actions"></slot>
                    <sl-icon-button
                      part="close-button"
                      exportparts="base:close-button__base"
                      class="dialog__close"
                      name="x-lg"
                      label=${this.localize.term("close")}
                      library="system"
                      @click="${()=>this.requestClose("close-button")}"
                    ></sl-icon-button>
                  </div>
                </header>
              `}
          ${""}
          <div part="body" class="dialog__body" tabindex="-1"><slot></slot></div>

          <footer part="footer" class="dialog__footer">
            <slot name="footer"></slot>
          </footer>
        </div>
      </div>
    `}};Ce.styles=[lr,mp];Ce.dependencies={"sl-icon-button":Zc};S([ct(".dialog")],Ce.prototype,"dialog",2);S([ct(".dialog__panel")],Ce.prototype,"panel",2);S([ct(".dialog__overlay")],Ce.prototype,"overlay",2);S([b({type:Boolean,reflect:!0})],Ce.prototype,"open",2);S([b({reflect:!0})],Ce.prototype,"label",2);S([b({attribute:"no-header",type:Boolean,reflect:!0})],Ce.prototype,"noHeader",2);S([Pn("open",{waitUntilFirstUpdate:!0})],Ce.prototype,"handleOpenChange",1);Be("dialog.show",{keyframes:[{opacity:0,scale:.8},{opacity:1,scale:1}],options:{duration:250,easing:"ease"}});Be("dialog.hide",{keyframes:[{opacity:1,scale:1},{opacity:0,scale:.8}],options:{duration:250,easing:"ease"}});Be("dialog.denyClose",{keyframes:[{scale:1},{scale:1.02},{scale:1}],options:{duration:250}});Be("dialog.overlay.show",{keyframes:[{opacity:0},{opacity:1}],options:{duration:250}});Be("dialog.overlay.hide",{keyframes:[{opacity:1},{opacity:0}],options:{duration:250}});Ce.define("sl-dialog");var vp=ar`
  :host {
    --arrow-color: var(--sl-color-neutral-1000);
    --arrow-size: 6px;

    /*
     * These properties are computed to account for the arrow's dimensions after being rotated 45ยบ. The constant
     * 0.7071 is derived from sin(45), which is the diagonal size of the arrow's container after rotating.
     */
    --arrow-size-diagonal: calc(var(--arrow-size) * 0.7071);
    --arrow-padding-offset: calc(var(--arrow-size-diagonal) - var(--arrow-size));

    display: contents;
  }

  .popup {
    position: absolute;
    isolation: isolate;
    max-width: var(--auto-size-available-width, none);
    max-height: var(--auto-size-available-height, none);
  }

  .popup--fixed {
    position: fixed;
  }

  .popup:not(.popup--active) {
    display: none;
  }

  .popup__arrow {
    position: absolute;
    width: calc(var(--arrow-size-diagonal) * 2);
    height: calc(var(--arrow-size-diagonal) * 2);
    rotate: 45deg;
    background: var(--arrow-color);
    z-index: -1;
  }

  /* Hover bridge */
  .popup-hover-bridge:not(.popup-hover-bridge--visible) {
    display: none;
  }

  .popup-hover-bridge {
    position: fixed;
    z-index: calc(var(--sl-z-index-dropdown) - 1);
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    clip-path: polygon(
      var(--hover-bridge-top-left-x, 0) var(--hover-bridge-top-left-y, 0),
      var(--hover-bridge-top-right-x, 0) var(--hover-bridge-top-right-y, 0),
      var(--hover-bridge-bottom-right-x, 0) var(--hover-bridge-bottom-right-y, 0),
      var(--hover-bridge-bottom-left-x, 0) var(--hover-bridge-bottom-left-y, 0)
    );
  }
`;const tn=Math.min,Nt=Math.max,Oi=Math.round,di=Math.floor,ye=n=>({x:n,y:n}),wp={left:"right",right:"left",bottom:"top",top:"bottom"},xp={start:"end",end:"start"};function us(n,t,e){return Nt(n,tn(t,e))}function hr(n,t){return typeof n=="function"?n(t):n}function en(n){return n.split("-")[0]}function ur(n){return n.split("-")[1]}function id(n){return n==="x"?"y":"x"}function oa(n){return n==="y"?"height":"width"}function Mn(n){return["top","bottom"].includes(en(n))?"y":"x"}function sa(n){return id(Mn(n))}function kp(n,t,e){e===void 0&&(e=!1);const r=ur(n),i=sa(n),o=oa(i);let s=i==="x"?r===(e?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(s=Mi(s)),[s,Mi(s)]}function Sp(n){const t=Mi(n);return[ps(n),t,ps(t)]}function ps(n){return n.replace(/start|end/g,t=>xp[t])}function Cp(n,t,e){const r=["left","right"],i=["right","left"],o=["top","bottom"],s=["bottom","top"];switch(n){case"top":case"bottom":return e?t?i:r:t?r:i;case"left":case"right":return t?o:s;default:return[]}}function Ep(n,t,e,r){const i=ur(n);let o=Cp(en(n),e==="start",r);return i&&(o=o.map(s=>s+"-"+i),t&&(o=o.concat(o.map(ps)))),o}function Mi(n){return n.replace(/left|right|bottom|top/g,t=>wp[t])}function Op(n){return{top:0,right:0,bottom:0,left:0,...n}}function od(n){return typeof n!="number"?Op(n):{top:n,right:n,bottom:n,left:n}}function Ti(n){const{x:t,y:e,width:r,height:i}=n;return{width:r,height:i,top:e,left:t,right:t+r,bottom:e+i,x:t,y:e}}function Ja(n,t,e){let{reference:r,floating:i}=n;const o=Mn(t),s=sa(t),a=oa(s),l=en(t),c=o==="y",d=r.x+r.width/2-i.width/2,h=r.y+r.height/2-i.height/2,u=r[a]/2-i[a]/2;let p;switch(l){case"top":p={x:d,y:r.y-i.height};break;case"bottom":p={x:d,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:h};break;case"left":p={x:r.x-i.width,y:h};break;default:p={x:r.x,y:r.y}}switch(ur(t)){case"start":p[s]-=u*(e&&c?-1:1);break;case"end":p[s]+=u*(e&&c?-1:1);break}return p}const Mp=async(n,t,e)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:s}=e,a=o.filter(Boolean),l=await(s.isRTL==null?void 0:s.isRTL(t));let c=await s.getElementRects({reference:n,floating:t,strategy:i}),{x:d,y:h}=Ja(c,r,l),u=r,p={},f=0;for(let m=0;m<a.length;m++){const{name:g,fn:y}=a[m],{x:w,y:k,data:M,reset:T}=await y({x:d,y:h,initialPlacement:r,placement:u,strategy:i,middlewareData:p,rects:c,platform:s,elements:{reference:n,floating:t}});d=w??d,h=k??h,p={...p,[g]:{...p[g],...M}},T&&f<=50&&(f++,typeof T=="object"&&(T.placement&&(u=T.placement),T.rects&&(c=T.rects===!0?await s.getElementRects({reference:n,floating:t,strategy:i}):T.rects),{x:d,y:h}=Ja(c,u,l)),m=-1)}return{x:d,y:h,placement:u,strategy:i,middlewareData:p}};async function aa(n,t){var e;t===void 0&&(t={});const{x:r,y:i,platform:o,rects:s,elements:a,strategy:l}=n,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:h="floating",altBoundary:u=!1,padding:p=0}=hr(t,n),f=od(p),g=a[u?h==="floating"?"reference":"floating":h],y=Ti(await o.getClippingRect({element:(e=await(o.isElement==null?void 0:o.isElement(g)))==null||e?g:g.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(a.floating)),boundary:c,rootBoundary:d,strategy:l})),w=h==="floating"?{x:r,y:i,width:s.floating.width,height:s.floating.height}:s.reference,k=await(o.getOffsetParent==null?void 0:o.getOffsetParent(a.floating)),M=await(o.isElement==null?void 0:o.isElement(k))?await(o.getScale==null?void 0:o.getScale(k))||{x:1,y:1}:{x:1,y:1},T=Ti(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:w,offsetParent:k,strategy:l}):w);return{top:(y.top-T.top+f.top)/M.y,bottom:(T.bottom-y.bottom+f.bottom)/M.y,left:(y.left-T.left+f.left)/M.x,right:(T.right-y.right+f.right)/M.x}}const Tp=n=>({name:"arrow",options:n,async fn(t){const{x:e,y:r,placement:i,rects:o,platform:s,elements:a,middlewareData:l}=t,{element:c,padding:d=0}=hr(n,t)||{};if(c==null)return{};const h=od(d),u={x:e,y:r},p=sa(i),f=oa(p),m=await s.getDimensions(c),g=p==="y",y=g?"top":"left",w=g?"bottom":"right",k=g?"clientHeight":"clientWidth",M=o.reference[f]+o.reference[p]-u[p]-o.floating[f],T=u[p]-o.reference[p],I=await(s.getOffsetParent==null?void 0:s.getOffsetParent(c));let $=I?I[k]:0;(!$||!await(s.isElement==null?void 0:s.isElement(I)))&&($=a.floating[k]||o.floating[f]);const H=M/2-T/2,A=$/2-m[f]/2-1,U=tn(h[y],A),et=tn(h[w],A),X=U,jt=$-m[f]-et,j=$/2-m[f]/2+H,$t=us(X,j,jt),Mt=!l.arrow&&ur(i)!=null&&j!==$t&&o.reference[f]/2-(j<X?U:et)-m[f]/2<0,Vt=Mt?j<X?j-X:j-jt:0;return{[p]:u[p]+Vt,data:{[p]:$t,centerOffset:j-$t-Vt,...Mt&&{alignmentOffset:Vt}},reset:Mt}}}),Ap=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(t){var e,r;const{placement:i,middlewareData:o,rects:s,initialPlacement:a,platform:l,elements:c}=t,{mainAxis:d=!0,crossAxis:h=!0,fallbackPlacements:u,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:f="none",flipAlignment:m=!0,...g}=hr(n,t);if((e=o.arrow)!=null&&e.alignmentOffset)return{};const y=en(i),w=Mn(a),k=en(a)===a,M=await(l.isRTL==null?void 0:l.isRTL(c.floating)),T=u||(k||!m?[Mi(a)]:Sp(a)),I=f!=="none";!u&&I&&T.push(...Ep(a,m,f,M));const $=[a,...T],H=await aa(t,g),A=[];let U=((r=o.flip)==null?void 0:r.overflows)||[];if(d&&A.push(H[y]),h){const j=kp(i,s,M);A.push(H[j[0]],H[j[1]])}if(U=[...U,{placement:i,overflows:A}],!A.every(j=>j<=0)){var et,X;const j=(((et=o.flip)==null?void 0:et.index)||0)+1,$t=$[j];if($t)return{data:{index:j,overflows:U},reset:{placement:$t}};let Mt=(X=U.filter(Vt=>Vt.overflows[0]<=0).sort((Vt,he)=>Vt.overflows[1]-he.overflows[1])[0])==null?void 0:X.placement;if(!Mt)switch(p){case"bestFit":{var jt;const Vt=(jt=U.filter(he=>{if(I){const ue=Mn(he.placement);return ue===w||ue==="y"}return!0}).map(he=>[he.placement,he.overflows.filter(ue=>ue>0).reduce((ue,ai)=>ue+ai,0)]).sort((he,ue)=>he[1]-ue[1])[0])==null?void 0:jt[0];Vt&&(Mt=Vt);break}case"initialPlacement":Mt=a;break}if(i!==Mt)return{reset:{placement:Mt}}}return{}}}};async function _p(n,t){const{placement:e,platform:r,elements:i}=n,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),s=en(e),a=ur(e),l=Mn(e)==="y",c=["left","top"].includes(s)?-1:1,d=o&&l?-1:1,h=hr(t,n);let{mainAxis:u,crossAxis:p,alignmentAxis:f}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return a&&typeof f=="number"&&(p=a==="end"?f*-1:f),l?{x:p*d,y:u*c}:{x:u*c,y:p*d}}const Dp=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(t){var e,r;const{x:i,y:o,placement:s,middlewareData:a}=t,l=await _p(t,n);return s===((e=a.offset)==null?void 0:e.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+l.x,y:o+l.y,data:{...l,placement:s}}}}},$p=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(t){const{x:e,y:r,placement:i}=t,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:g=>{let{x:y,y:w}=g;return{x:y,y:w}}},...l}=hr(n,t),c={x:e,y:r},d=await aa(t,l),h=Mn(en(i)),u=id(h);let p=c[u],f=c[h];if(o){const g=u==="y"?"top":"left",y=u==="y"?"bottom":"right",w=p+d[g],k=p-d[y];p=us(w,p,k)}if(s){const g=h==="y"?"top":"left",y=h==="y"?"bottom":"right",w=f+d[g],k=f-d[y];f=us(w,f,k)}const m=a.fn({...t,[u]:p,[h]:f});return{...m,data:{x:m.x-e,y:m.y-r,enabled:{[u]:o,[h]:s}}}}}},Np=function(n){return n===void 0&&(n={}),{name:"size",options:n,async fn(t){var e,r;const{placement:i,rects:o,platform:s,elements:a}=t,{apply:l=()=>{},...c}=hr(n,t),d=await aa(t,c),h=en(i),u=ur(i),p=Mn(i)==="y",{width:f,height:m}=o.floating;let g,y;h==="top"||h==="bottom"?(g=h,y=u===(await(s.isRTL==null?void 0:s.isRTL(a.floating))?"start":"end")?"left":"right"):(y=h,g=u==="end"?"top":"bottom");const w=m-d.top-d.bottom,k=f-d.left-d.right,M=tn(m-d[g],w),T=tn(f-d[y],k),I=!t.middlewareData.shift;let $=M,H=T;if((e=t.middlewareData.shift)!=null&&e.enabled.x&&(H=k),(r=t.middlewareData.shift)!=null&&r.enabled.y&&($=w),I&&!u){const U=Nt(d.left,0),et=Nt(d.right,0),X=Nt(d.top,0),jt=Nt(d.bottom,0);p?H=f-2*(U!==0||et!==0?U+et:Nt(d.left,d.right)):$=m-2*(X!==0||jt!==0?X+jt:Nt(d.top,d.bottom))}await l({...t,availableWidth:H,availableHeight:$});const A=await s.getDimensions(a.floating);return f!==A.width||m!==A.height?{reset:{rects:!0}}:{}}}};function oo(){return typeof window<"u"}function pr(n){return sd(n)?(n.nodeName||"").toLowerCase():"#document"}function Rt(n){var t;return(n==null||(t=n.ownerDocument)==null?void 0:t.defaultView)||window}function Ee(n){var t;return(t=(sd(n)?n.ownerDocument:n.document)||window.document)==null?void 0:t.documentElement}function sd(n){return oo()?n instanceof Node||n instanceof Rt(n).Node:!1}function ne(n){return oo()?n instanceof Element||n instanceof Rt(n).Element:!1}function ve(n){return oo()?n instanceof HTMLElement||n instanceof Rt(n).HTMLElement:!1}function Ya(n){return!oo()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof Rt(n).ShadowRoot}function ni(n){const{overflow:t,overflowX:e,overflowY:r,display:i}=re(n);return/auto|scroll|overlay|hidden|clip/.test(t+r+e)&&!["inline","contents"].includes(i)}function Ip(n){return["table","td","th"].includes(pr(n))}function so(n){return[":popover-open",":modal"].some(t=>{try{return n.matches(t)}catch{return!1}})}function ao(n){const t=la(),e=ne(n)?re(n):n;return["transform","translate","scale","rotate","perspective"].some(r=>e[r]?e[r]!=="none":!1)||(e.containerType?e.containerType!=="normal":!1)||!t&&(e.backdropFilter?e.backdropFilter!=="none":!1)||!t&&(e.filter?e.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(e.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(e.contain||"").includes(r))}function Pp(n){let t=nn(n);for(;ve(t)&&!tr(t);){if(ao(t))return t;if(so(t))return null;t=nn(t)}return null}function la(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function tr(n){return["html","body","#document"].includes(pr(n))}function re(n){return Rt(n).getComputedStyle(n)}function lo(n){return ne(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function nn(n){if(pr(n)==="html")return n;const t=n.assignedSlot||n.parentNode||Ya(n)&&n.host||Ee(n);return Ya(t)?t.host:t}function ad(n){const t=nn(n);return tr(t)?n.ownerDocument?n.ownerDocument.body:n.body:ve(t)&&ni(t)?t:ad(t)}function Vr(n,t,e){var r;t===void 0&&(t=[]),e===void 0&&(e=!0);const i=ad(n),o=i===((r=n.ownerDocument)==null?void 0:r.body),s=Rt(i);if(o){const a=fs(s);return t.concat(s,s.visualViewport||[],ni(i)?i:[],a&&e?Vr(a):[])}return t.concat(i,Vr(i,[],e))}function fs(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function ld(n){const t=re(n);let e=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const i=ve(n),o=i?n.offsetWidth:e,s=i?n.offsetHeight:r,a=Oi(e)!==o||Oi(r)!==s;return a&&(e=o,r=s),{width:e,height:r,$:a}}function ca(n){return ne(n)?n:n.contextElement}function Kn(n){const t=ca(n);if(!ve(t))return ye(1);const e=t.getBoundingClientRect(),{width:r,height:i,$:o}=ld(t);let s=(o?Oi(e.width):e.width)/r,a=(o?Oi(e.height):e.height)/i;return(!s||!Number.isFinite(s))&&(s=1),(!a||!Number.isFinite(a))&&(a=1),{x:s,y:a}}const Rp=ye(0);function cd(n){const t=Rt(n);return!la()||!t.visualViewport?Rp:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Lp(n,t,e){return t===void 0&&(t=!1),!e||t&&e!==Rt(n)?!1:t}function Tn(n,t,e,r){t===void 0&&(t=!1),e===void 0&&(e=!1);const i=n.getBoundingClientRect(),o=ca(n);let s=ye(1);t&&(r?ne(r)&&(s=Kn(r)):s=Kn(n));const a=Lp(o,e,r)?cd(o):ye(0);let l=(i.left+a.x)/s.x,c=(i.top+a.y)/s.y,d=i.width/s.x,h=i.height/s.y;if(o){const u=Rt(o),p=r&&ne(r)?Rt(r):r;let f=u,m=fs(f);for(;m&&r&&p!==f;){const g=Kn(m),y=m.getBoundingClientRect(),w=re(m),k=y.left+(m.clientLeft+parseFloat(w.paddingLeft))*g.x,M=y.top+(m.clientTop+parseFloat(w.paddingTop))*g.y;l*=g.x,c*=g.y,d*=g.x,h*=g.y,l+=k,c+=M,f=Rt(m),m=fs(f)}}return Ti({width:d,height:h,x:l,y:c})}function da(n,t){const e=lo(n).scrollLeft;return t?t.left+e:Tn(Ee(n)).left+e}function dd(n,t,e){e===void 0&&(e=!1);const r=n.getBoundingClientRect(),i=r.left+t.scrollLeft-(e?0:da(n,r)),o=r.top+t.scrollTop;return{x:i,y:o}}function zp(n){let{elements:t,rect:e,offsetParent:r,strategy:i}=n;const o=i==="fixed",s=Ee(r),a=t?so(t.floating):!1;if(r===s||a&&o)return e;let l={scrollLeft:0,scrollTop:0},c=ye(1);const d=ye(0),h=ve(r);if((h||!h&&!o)&&((pr(r)!=="body"||ni(s))&&(l=lo(r)),ve(r))){const p=Tn(r);c=Kn(r),d.x=p.x+r.clientLeft,d.y=p.y+r.clientTop}const u=s&&!h&&!o?dd(s,l,!0):ye(0);return{width:e.width*c.x,height:e.height*c.y,x:e.x*c.x-l.scrollLeft*c.x+d.x+u.x,y:e.y*c.y-l.scrollTop*c.y+d.y+u.y}}function Bp(n){return Array.from(n.getClientRects())}function Fp(n){const t=Ee(n),e=lo(n),r=n.ownerDocument.body,i=Nt(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=Nt(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let s=-e.scrollLeft+da(n);const a=-e.scrollTop;return re(r).direction==="rtl"&&(s+=Nt(t.clientWidth,r.clientWidth)-i),{width:i,height:o,x:s,y:a}}function jp(n,t){const e=Rt(n),r=Ee(n),i=e.visualViewport;let o=r.clientWidth,s=r.clientHeight,a=0,l=0;if(i){o=i.width,s=i.height;const c=la();(!c||c&&t==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:o,height:s,x:a,y:l}}function Vp(n,t){const e=Tn(n,!0,t==="fixed"),r=e.top+n.clientTop,i=e.left+n.clientLeft,o=ve(n)?Kn(n):ye(1),s=n.clientWidth*o.x,a=n.clientHeight*o.y,l=i*o.x,c=r*o.y;return{width:s,height:a,x:l,y:c}}function Xa(n,t,e){let r;if(t==="viewport")r=jp(n,e);else if(t==="document")r=Fp(Ee(n));else if(ne(t))r=Vp(t,e);else{const i=cd(n);r={x:t.x-i.x,y:t.y-i.y,width:t.width,height:t.height}}return Ti(r)}function hd(n,t){const e=nn(n);return e===t||!ne(e)||tr(e)?!1:re(e).position==="fixed"||hd(e,t)}function Hp(n,t){const e=t.get(n);if(e)return e;let r=Vr(n,[],!1).filter(a=>ne(a)&&pr(a)!=="body"),i=null;const o=re(n).position==="fixed";let s=o?nn(n):n;for(;ne(s)&&!tr(s);){const a=re(s),l=ao(s);!l&&a.position==="fixed"&&(i=null),(o?!l&&!i:!l&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||ni(s)&&!l&&hd(n,s))?r=r.filter(d=>d!==s):i=a,s=nn(s)}return t.set(n,r),r}function Wp(n){let{element:t,boundary:e,rootBoundary:r,strategy:i}=n;const s=[...e==="clippingAncestors"?so(t)?[]:Hp(t,this._c):[].concat(e),r],a=s[0],l=s.reduce((c,d)=>{const h=Xa(t,d,i);return c.top=Nt(h.top,c.top),c.right=tn(h.right,c.right),c.bottom=tn(h.bottom,c.bottom),c.left=Nt(h.left,c.left),c},Xa(t,a,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function qp(n){const{width:t,height:e}=ld(n);return{width:t,height:e}}function Up(n,t,e){const r=ve(t),i=Ee(t),o=e==="fixed",s=Tn(n,!0,o,t);let a={scrollLeft:0,scrollTop:0};const l=ye(0);if(r||!r&&!o)if((pr(t)!=="body"||ni(i))&&(a=lo(t)),r){const u=Tn(t,!0,o,t);l.x=u.x+t.clientLeft,l.y=u.y+t.clientTop}else i&&(l.x=da(i));const c=i&&!r&&!o?dd(i,a):ye(0),d=s.left+a.scrollLeft-l.x-c.x,h=s.top+a.scrollTop-l.y-c.y;return{x:d,y:h,width:s.width,height:s.height}}function Ao(n){return re(n).position==="static"}function Za(n,t){if(!ve(n)||re(n).position==="fixed")return null;if(t)return t(n);let e=n.offsetParent;return Ee(n)===e&&(e=e.ownerDocument.body),e}function ud(n,t){const e=Rt(n);if(so(n))return e;if(!ve(n)){let i=nn(n);for(;i&&!tr(i);){if(ne(i)&&!Ao(i))return i;i=nn(i)}return e}let r=Za(n,t);for(;r&&Ip(r)&&Ao(r);)r=Za(r,t);return r&&tr(r)&&Ao(r)&&!ao(r)?e:r||Pp(n)||e}const Kp=async function(n){const t=this.getOffsetParent||ud,e=this.getDimensions,r=await e(n.floating);return{reference:Up(n.reference,await t(n.floating),n.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function Gp(n){return re(n).direction==="rtl"}const vi={convertOffsetParentRelativeRectToViewportRelativeRect:zp,getDocumentElement:Ee,getClippingRect:Wp,getOffsetParent:ud,getElementRects:Kp,getClientRects:Bp,getDimensions:qp,getScale:Kn,isElement:ne,isRTL:Gp};function pd(n,t){return n.x===t.x&&n.y===t.y&&n.width===t.width&&n.height===t.height}function Jp(n,t){let e=null,r;const i=Ee(n);function o(){var a;clearTimeout(r),(a=e)==null||a.disconnect(),e=null}function s(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),o();const c=n.getBoundingClientRect(),{left:d,top:h,width:u,height:p}=c;if(a||t(),!u||!p)return;const f=di(h),m=di(i.clientWidth-(d+u)),g=di(i.clientHeight-(h+p)),y=di(d),k={rootMargin:-f+"px "+-m+"px "+-g+"px "+-y+"px",threshold:Nt(0,tn(1,l))||1};let M=!0;function T(I){const $=I[0].intersectionRatio;if($!==l){if(!M)return s();$?s(!1,$):r=setTimeout(()=>{s(!1,1e-7)},1e3)}$===1&&!pd(c,n.getBoundingClientRect())&&s(),M=!1}try{e=new IntersectionObserver(T,{...k,root:i.ownerDocument})}catch{e=new IntersectionObserver(T,k)}e.observe(n)}return s(!0),o}function Yp(n,t,e,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:o=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=ca(n),d=i||o?[...c?Vr(c):[],...Vr(t)]:[];d.forEach(y=>{i&&y.addEventListener("scroll",e,{passive:!0}),o&&y.addEventListener("resize",e)});const h=c&&a?Jp(c,e):null;let u=-1,p=null;s&&(p=new ResizeObserver(y=>{let[w]=y;w&&w.target===c&&p&&(p.unobserve(t),cancelAnimationFrame(u),u=requestAnimationFrame(()=>{var k;(k=p)==null||k.observe(t)})),e()}),c&&!l&&p.observe(c),p.observe(t));let f,m=l?Tn(n):null;l&&g();function g(){const y=Tn(n);m&&!pd(m,y)&&e(),m=y,f=requestAnimationFrame(g)}return e(),()=>{var y;d.forEach(w=>{i&&w.removeEventListener("scroll",e),o&&w.removeEventListener("resize",e)}),h==null||h(),(y=p)==null||y.disconnect(),p=null,l&&cancelAnimationFrame(f)}}const Xp=Dp,Zp=$p,Qp=Ap,Qa=Np,tf=Tp,ef=(n,t,e)=>{const r=new Map,i={platform:vi,...e},o={...i.platform,_c:r};return Mp(n,t,{...i,platform:o})};function nf(n){return rf(n)}function _o(n){return n.assignedSlot?n.assignedSlot:n.parentNode instanceof ShadowRoot?n.parentNode.host:n.parentNode}function rf(n){for(let t=n;t;t=_o(t))if(t instanceof Element&&getComputedStyle(t).display==="none")return null;for(let t=_o(n);t;t=_o(t)){if(!(t instanceof Element))continue;const e=getComputedStyle(t);if(e.display!=="contents"&&(e.position!=="static"||ao(e)||t.tagName==="BODY"))return t}return null}function of(n){return n!==null&&typeof n=="object"&&"getBoundingClientRect"in n&&("contextElement"in n?n instanceof Element:!0)}var q=class extends cr{constructor(){super(...arguments),this.localize=new dr(this),this.active=!1,this.placement="top",this.strategy="absolute",this.distance=0,this.skidding=0,this.arrow=!1,this.arrowPlacement="anchor",this.arrowPadding=10,this.flip=!1,this.flipFallbackPlacements="",this.flipFallbackStrategy="best-fit",this.flipPadding=0,this.shift=!1,this.shiftPadding=0,this.autoSizePadding=0,this.hoverBridge=!1,this.updateHoverBridge=()=>{if(this.hoverBridge&&this.anchorEl){const n=this.anchorEl.getBoundingClientRect(),t=this.popup.getBoundingClientRect(),e=this.placement.includes("top")||this.placement.includes("bottom");let r=0,i=0,o=0,s=0,a=0,l=0,c=0,d=0;e?n.top<t.top?(r=n.left,i=n.bottom,o=n.right,s=n.bottom,a=t.left,l=t.top,c=t.right,d=t.top):(r=t.left,i=t.bottom,o=t.right,s=t.bottom,a=n.left,l=n.top,c=n.right,d=n.top):n.left<t.left?(r=n.right,i=n.top,o=t.left,s=t.top,a=n.right,l=n.bottom,c=t.left,d=t.bottom):(r=t.right,i=t.top,o=n.left,s=n.top,a=t.right,l=t.bottom,c=n.left,d=n.bottom),this.style.setProperty("--hover-bridge-top-left-x",`${r}px`),this.style.setProperty("--hover-bridge-top-left-y",`${i}px`),this.style.setProperty("--hover-bridge-top-right-x",`${o}px`),this.style.setProperty("--hover-bridge-top-right-y",`${s}px`),this.style.setProperty("--hover-bridge-bottom-left-x",`${a}px`),this.style.setProperty("--hover-bridge-bottom-left-y",`${l}px`),this.style.setProperty("--hover-bridge-bottom-right-x",`${c}px`),this.style.setProperty("--hover-bridge-bottom-right-y",`${d}px`)}}}async connectedCallback(){super.connectedCallback(),await this.updateComplete,this.start()}disconnectedCallback(){super.disconnectedCallback(),this.stop()}async updated(n){super.updated(n),n.has("active")&&(this.active?this.start():this.stop()),n.has("anchor")&&this.handleAnchorChange(),this.active&&(await this.updateComplete,this.reposition())}async handleAnchorChange(){if(await this.stop(),this.anchor&&typeof this.anchor=="string"){const n=this.getRootNode();this.anchorEl=n.getElementById(this.anchor)}else this.anchor instanceof Element||of(this.anchor)?this.anchorEl=this.anchor:this.anchorEl=this.querySelector('[slot="anchor"]');this.anchorEl instanceof HTMLSlotElement&&(this.anchorEl=this.anchorEl.assignedElements({flatten:!0})[0]),this.anchorEl&&this.active&&this.start()}start(){!this.anchorEl||!this.active||(this.cleanup=Yp(this.anchorEl,this.popup,()=>{this.reposition()}))}async stop(){return new Promise(n=>{this.cleanup?(this.cleanup(),this.cleanup=void 0,this.removeAttribute("data-current-placement"),this.style.removeProperty("--auto-size-available-width"),this.style.removeProperty("--auto-size-available-height"),requestAnimationFrame(()=>n())):n()})}reposition(){if(!this.active||!this.anchorEl)return;const n=[Xp({mainAxis:this.distance,crossAxis:this.skidding})];this.sync?n.push(Qa({apply:({rects:e})=>{const r=this.sync==="width"||this.sync==="both",i=this.sync==="height"||this.sync==="both";this.popup.style.width=r?`${e.reference.width}px`:"",this.popup.style.height=i?`${e.reference.height}px`:""}})):(this.popup.style.width="",this.popup.style.height=""),this.flip&&n.push(Qp({boundary:this.flipBoundary,fallbackPlacements:this.flipFallbackPlacements,fallbackStrategy:this.flipFallbackStrategy==="best-fit"?"bestFit":"initialPlacement",padding:this.flipPadding})),this.shift&&n.push(Zp({boundary:this.shiftBoundary,padding:this.shiftPadding})),this.autoSize?n.push(Qa({boundary:this.autoSizeBoundary,padding:this.autoSizePadding,apply:({availableWidth:e,availableHeight:r})=>{this.autoSize==="vertical"||this.autoSize==="both"?this.style.setProperty("--auto-size-available-height",`${r}px`):this.style.removeProperty("--auto-size-available-height"),this.autoSize==="horizontal"||this.autoSize==="both"?this.style.setProperty("--auto-size-available-width",`${e}px`):this.style.removeProperty("--auto-size-available-width")}})):(this.style.removeProperty("--auto-size-available-width"),this.style.removeProperty("--auto-size-available-height")),this.arrow&&n.push(tf({element:this.arrowEl,padding:this.arrowPadding}));const t=this.strategy==="absolute"?e=>vi.getOffsetParent(e,nf):vi.getOffsetParent;ef(this.anchorEl,this.popup,{placement:this.placement,middleware:n,strategy:this.strategy,platform:no(ei({},vi),{getOffsetParent:t})}).then(({x:e,y:r,middlewareData:i,placement:o})=>{const s=this.localize.dir()==="rtl",a={top:"bottom",right:"left",bottom:"top",left:"right"}[o.split("-")[0]];if(this.setAttribute("data-current-placement",o),Object.assign(this.popup.style,{left:`${e}px`,top:`${r}px`}),this.arrow){const l=i.arrow.x,c=i.arrow.y;let d="",h="",u="",p="";if(this.arrowPlacement==="start"){const f=typeof l=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"";d=typeof c=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"",h=s?f:"",p=s?"":f}else if(this.arrowPlacement==="end"){const f=typeof l=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"";h=s?"":f,p=s?f:"",u=typeof c=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:""}else this.arrowPlacement==="center"?(p=typeof l=="number"?"calc(50% - var(--arrow-size-diagonal))":"",d=typeof c=="number"?"calc(50% - var(--arrow-size-diagonal))":""):(p=typeof l=="number"?`${l}px`:"",d=typeof c=="number"?`${c}px`:"");Object.assign(this.arrowEl.style,{top:d,right:h,bottom:u,left:p,[a]:"calc(var(--arrow-size-diagonal) * -1)"})}}),requestAnimationFrame(()=>this.updateHoverBridge()),this.emit("sl-reposition")}render(){return z`
      <slot name="anchor" @slotchange=${this.handleAnchorChange}></slot>

      <span
        part="hover-bridge"
        class=${kt({"popup-hover-bridge":!0,"popup-hover-bridge--visible":this.hoverBridge&&this.active})}
      ></span>

      <div
        part="popup"
        class=${kt({popup:!0,"popup--active":this.active,"popup--fixed":this.strategy==="fixed","popup--has-arrow":this.arrow})}
      >
        <slot></slot>
        ${this.arrow?z`<div part="arrow" class="popup__arrow" role="presentation"></div>`:""}
      </div>
    `}};q.styles=[lr,vp];S([ct(".popup")],q.prototype,"popup",2);S([ct(".popup__arrow")],q.prototype,"arrowEl",2);S([b()],q.prototype,"anchor",2);S([b({type:Boolean,reflect:!0})],q.prototype,"active",2);S([b({reflect:!0})],q.prototype,"placement",2);S([b({reflect:!0})],q.prototype,"strategy",2);S([b({type:Number})],q.prototype,"distance",2);S([b({type:Number})],q.prototype,"skidding",2);S([b({type:Boolean})],q.prototype,"arrow",2);S([b({attribute:"arrow-placement"})],q.prototype,"arrowPlacement",2);S([b({attribute:"arrow-padding",type:Number})],q.prototype,"arrowPadding",2);S([b({type:Boolean})],q.prototype,"flip",2);S([b({attribute:"flip-fallback-placements",converter:{fromAttribute:n=>n.split(" ").map(t=>t.trim()).filter(t=>t!==""),toAttribute:n=>n.join(" ")}})],q.prototype,"flipFallbackPlacements",2);S([b({attribute:"flip-fallback-strategy"})],q.prototype,"flipFallbackStrategy",2);S([b({type:Object})],q.prototype,"flipBoundary",2);S([b({attribute:"flip-padding",type:Number})],q.prototype,"flipPadding",2);S([b({type:Boolean})],q.prototype,"shift",2);S([b({type:Object})],q.prototype,"shiftBoundary",2);S([b({attribute:"shift-padding",type:Number})],q.prototype,"shiftPadding",2);S([b({attribute:"auto-size"})],q.prototype,"autoSize",2);S([b()],q.prototype,"sync",2);S([b({type:Object})],q.prototype,"autoSizeBoundary",2);S([b({attribute:"auto-size-padding",type:Number})],q.prototype,"autoSizePadding",2);S([b({attribute:"hover-bridge",type:Boolean})],q.prototype,"hoverBridge",2);q.define("sl-popup");var sf=ar`
  :host {
    --max-width: 20rem;
    --hide-delay: 0ms;
    --show-delay: 150ms;

    display: contents;
  }

  .tooltip {
    --arrow-size: var(--sl-tooltip-arrow-size);
    --arrow-color: var(--sl-tooltip-background-color);
  }

  .tooltip::part(popup) {
    z-index: var(--sl-z-index-tooltip);
  }

  .tooltip[placement^='top']::part(popup) {
    transform-origin: bottom;
  }

  .tooltip[placement^='bottom']::part(popup) {
    transform-origin: top;
  }

  .tooltip[placement^='left']::part(popup) {
    transform-origin: right;
  }

  .tooltip[placement^='right']::part(popup) {
    transform-origin: left;
  }

  .tooltip__body {
    display: block;
    width: max-content;
    max-width: var(--max-width);
    border-radius: var(--sl-tooltip-border-radius);
    background-color: var(--sl-tooltip-background-color);
    font-family: var(--sl-tooltip-font-family);
    font-size: var(--sl-tooltip-font-size);
    font-weight: var(--sl-tooltip-font-weight);
    line-height: var(--sl-tooltip-line-height);
    text-align: start;
    white-space: normal;
    color: var(--sl-tooltip-color);
    padding: var(--sl-tooltip-padding);
    pointer-events: none;
    user-select: none;
    -webkit-user-select: none;
  }
`,mt=class extends cr{constructor(){super(),this.localize=new dr(this),this.content="",this.placement="top",this.disabled=!1,this.distance=8,this.open=!1,this.skidding=0,this.trigger="hover focus",this.hoist=!1,this.handleBlur=()=>{this.hasTrigger("focus")&&this.hide()},this.handleClick=()=>{this.hasTrigger("click")&&(this.open?this.hide():this.show())},this.handleFocus=()=>{this.hasTrigger("focus")&&this.show()},this.handleDocumentKeyDown=n=>{n.key==="Escape"&&(n.stopPropagation(),this.hide())},this.handleMouseOver=()=>{if(this.hasTrigger("hover")){const n=Ga(getComputedStyle(this).getPropertyValue("--show-delay"));clearTimeout(this.hoverTimeout),this.hoverTimeout=window.setTimeout(()=>this.show(),n)}},this.handleMouseOut=()=>{if(this.hasTrigger("hover")){const n=Ga(getComputedStyle(this).getPropertyValue("--hide-delay"));clearTimeout(this.hoverTimeout),this.hoverTimeout=window.setTimeout(()=>this.hide(),n)}},this.addEventListener("blur",this.handleBlur,!0),this.addEventListener("focus",this.handleFocus,!0),this.addEventListener("click",this.handleClick),this.addEventListener("mouseover",this.handleMouseOver),this.addEventListener("mouseout",this.handleMouseOut)}disconnectedCallback(){var n;super.disconnectedCallback(),(n=this.closeWatcher)==null||n.destroy(),document.removeEventListener("keydown",this.handleDocumentKeyDown)}firstUpdated(){this.body.hidden=!this.open,this.open&&(this.popup.active=!0,this.popup.reposition())}hasTrigger(n){return this.trigger.split(" ").includes(n)}async handleOpenChange(){var n,t;if(this.open){if(this.disabled)return;this.emit("sl-show"),"CloseWatcher"in window?((n=this.closeWatcher)==null||n.destroy(),this.closeWatcher=new CloseWatcher,this.closeWatcher.onclose=()=>{this.hide()}):document.addEventListener("keydown",this.handleDocumentKeyDown),await Ue(this.body),this.body.hidden=!1,this.popup.active=!0;const{keyframes:e,options:r}=De(this,"tooltip.show",{dir:this.localize.dir()});await $e(this.popup.popup,e,r),this.popup.reposition(),this.emit("sl-after-show")}else{this.emit("sl-hide"),(t=this.closeWatcher)==null||t.destroy(),document.removeEventListener("keydown",this.handleDocumentKeyDown),await Ue(this.body);const{keyframes:e,options:r}=De(this,"tooltip.hide",{dir:this.localize.dir()});await $e(this.popup.popup,e,r),this.popup.active=!1,this.body.hidden=!0,this.emit("sl-after-hide")}}async handleOptionsChange(){this.hasUpdated&&(await this.updateComplete,this.popup.reposition())}handleDisabledChange(){this.disabled&&this.open&&this.hide()}async show(){if(!this.open)return this.open=!0,Qn(this,"sl-after-show")}async hide(){if(this.open)return this.open=!1,Qn(this,"sl-after-hide")}render(){return z`
      <sl-popup
        part="base"
        exportparts="
          popup:base__popup,
          arrow:base__arrow
        "
        class=${kt({tooltip:!0,"tooltip--open":this.open})}
        placement=${this.placement}
        distance=${this.distance}
        skidding=${this.skidding}
        strategy=${this.hoist?"fixed":"absolute"}
        flip
        shift
        arrow
        hover-bridge
      >
        ${""}
        <slot slot="anchor" aria-describedby="tooltip"></slot>

        ${""}
        <div part="body" id="tooltip" class="tooltip__body" role="tooltip" aria-live=${this.open?"polite":"off"}>
          <slot name="content">${this.content}</slot>
        </div>
      </sl-popup>
    `}};mt.styles=[lr,sf];mt.dependencies={"sl-popup":q};S([ct("slot:not([name])")],mt.prototype,"defaultSlot",2);S([ct(".tooltip__body")],mt.prototype,"body",2);S([ct("sl-popup")],mt.prototype,"popup",2);S([b()],mt.prototype,"content",2);S([b()],mt.prototype,"placement",2);S([b({type:Boolean,reflect:!0})],mt.prototype,"disabled",2);S([b({type:Number})],mt.prototype,"distance",2);S([b({type:Boolean,reflect:!0})],mt.prototype,"open",2);S([b({type:Number})],mt.prototype,"skidding",2);S([b()],mt.prototype,"trigger",2);S([b({type:Boolean})],mt.prototype,"hoist",2);S([Pn("open",{waitUntilFirstUpdate:!0})],mt.prototype,"handleOpenChange",1);S([Pn(["content","distance","hoist","placement","skidding"])],mt.prototype,"handleOptionsChange",1);S([Pn("disabled")],mt.prototype,"handleDisabledChange",1);Be("tooltip.show",{keyframes:[{opacity:0,scale:.8},{opacity:1,scale:1}],options:{duration:150,easing:"ease"}});Be("tooltip.hide",{keyframes:[{opacity:1,scale:1},{opacity:0,scale:.8}],options:{duration:150,easing:"ease"}});mt.define("sl-tooltip");var af=ar`
  :host {
    display: contents;

    /* For better DX, we'll reset the margin here so the base part can inherit it */
    margin: 0;
  }

  .alert {
    position: relative;
    display: flex;
    align-items: stretch;
    background-color: var(--sl-panel-background-color);
    border: solid var(--sl-panel-border-width) var(--sl-panel-border-color);
    border-top-width: calc(var(--sl-panel-border-width) * 3);
    border-radius: var(--sl-border-radius-medium);
    font-family: var(--sl-font-sans);
    font-size: var(--sl-font-size-small);
    font-weight: var(--sl-font-weight-normal);
    line-height: 1.6;
    color: var(--sl-color-neutral-700);
    margin: inherit;
    overflow: hidden;
  }

  .alert:not(.alert--has-icon) .alert__icon,
  .alert:not(.alert--closable) .alert__close-button {
    display: none;
  }

  .alert__icon {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    font-size: var(--sl-font-size-large);
    padding-inline-start: var(--sl-spacing-large);
  }

  .alert--has-countdown {
    border-bottom: none;
  }

  .alert--primary {
    border-top-color: var(--sl-color-primary-600);
  }

  .alert--primary .alert__icon {
    color: var(--sl-color-primary-600);
  }

  .alert--success {
    border-top-color: var(--sl-color-success-600);
  }

  .alert--success .alert__icon {
    color: var(--sl-color-success-600);
  }

  .alert--neutral {
    border-top-color: var(--sl-color-neutral-600);
  }

  .alert--neutral .alert__icon {
    color: var(--sl-color-neutral-600);
  }

  .alert--warning {
    border-top-color: var(--sl-color-warning-600);
  }

  .alert--warning .alert__icon {
    color: var(--sl-color-warning-600);
  }

  .alert--danger {
    border-top-color: var(--sl-color-danger-600);
  }

  .alert--danger .alert__icon {
    color: var(--sl-color-danger-600);
  }

  .alert__message {
    flex: 1 1 auto;
    display: block;
    padding: var(--sl-spacing-large);
    overflow: hidden;
  }

  .alert__close-button {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    font-size: var(--sl-font-size-medium);
    padding-inline-end: var(--sl-spacing-medium);
  }

  .alert__countdown {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: calc(var(--sl-panel-border-width) * 3);
    background-color: var(--sl-panel-border-color);
    display: flex;
  }

  .alert__countdown--ltr {
    justify-content: flex-end;
  }

  .alert__countdown .alert__countdown-elapsed {
    height: 100%;
    width: 0;
  }

  .alert--primary .alert__countdown-elapsed {
    background-color: var(--sl-color-primary-600);
  }

  .alert--success .alert__countdown-elapsed {
    background-color: var(--sl-color-success-600);
  }

  .alert--neutral .alert__countdown-elapsed {
    background-color: var(--sl-color-neutral-600);
  }

  .alert--warning .alert__countdown-elapsed {
    background-color: var(--sl-color-warning-600);
  }

  .alert--danger .alert__countdown-elapsed {
    background-color: var(--sl-color-danger-600);
  }

  .alert__timer {
    display: none;
  }
`,Ft=class fn extends cr{constructor(){super(...arguments),this.hasSlotController=new ra(this,"icon","suffix"),this.localize=new dr(this),this.open=!1,this.closable=!1,this.variant="primary",this.duration=1/0,this.remainingTime=this.duration}static get toastStack(){return this.currentToastStack||(this.currentToastStack=Object.assign(document.createElement("div"),{className:"sl-toast-stack"})),this.currentToastStack}firstUpdated(){this.base.hidden=!this.open}restartAutoHide(){this.handleCountdownChange(),clearTimeout(this.autoHideTimeout),clearInterval(this.remainingTimeInterval),this.open&&this.duration<1/0&&(this.autoHideTimeout=window.setTimeout(()=>this.hide(),this.duration),this.remainingTime=this.duration,this.remainingTimeInterval=window.setInterval(()=>{this.remainingTime-=100},100))}pauseAutoHide(){var t;(t=this.countdownAnimation)==null||t.pause(),clearTimeout(this.autoHideTimeout),clearInterval(this.remainingTimeInterval)}resumeAutoHide(){var t;this.duration<1/0&&(this.autoHideTimeout=window.setTimeout(()=>this.hide(),this.remainingTime),this.remainingTimeInterval=window.setInterval(()=>{this.remainingTime-=100},100),(t=this.countdownAnimation)==null||t.play())}handleCountdownChange(){if(this.open&&this.duration<1/0&&this.countdown){const{countdownElement:t}=this,e="100%",r="0";this.countdownAnimation=t.animate([{width:e},{width:r}],{duration:this.duration,easing:"linear"})}}handleCloseClick(){this.hide()}async handleOpenChange(){if(this.open){this.emit("sl-show"),this.duration<1/0&&this.restartAutoHide(),await Ue(this.base),this.base.hidden=!1;const{keyframes:t,options:e}=De(this,"alert.show",{dir:this.localize.dir()});await $e(this.base,t,e),this.emit("sl-after-show")}else{this.emit("sl-hide"),clearTimeout(this.autoHideTimeout),clearInterval(this.remainingTimeInterval),await Ue(this.base);const{keyframes:t,options:e}=De(this,"alert.hide",{dir:this.localize.dir()});await $e(this.base,t,e),this.base.hidden=!0,this.emit("sl-after-hide")}}handleDurationChange(){this.restartAutoHide()}async show(){if(!this.open)return this.open=!0,Qn(this,"sl-after-show")}async hide(){if(this.open)return this.open=!1,Qn(this,"sl-after-hide")}async toast(){return new Promise(t=>{this.handleCountdownChange(),fn.toastStack.parentElement===null&&document.body.append(fn.toastStack),fn.toastStack.appendChild(this),requestAnimationFrame(()=>{this.clientWidth,this.show()}),this.addEventListener("sl-after-hide",()=>{fn.toastStack.removeChild(this),t(),fn.toastStack.querySelector("sl-alert")===null&&fn.toastStack.remove()},{once:!0})})}render(){return z`
      <div
        part="base"
        class=${kt({alert:!0,"alert--open":this.open,"alert--closable":this.closable,"alert--has-countdown":!!this.countdown,"alert--has-icon":this.hasSlotController.test("icon"),"alert--primary":this.variant==="primary","alert--success":this.variant==="success","alert--neutral":this.variant==="neutral","alert--warning":this.variant==="warning","alert--danger":this.variant==="danger"})}
        role="alert"
        aria-hidden=${this.open?"false":"true"}
        @mouseenter=${this.pauseAutoHide}
        @mouseleave=${this.resumeAutoHide}
      >
        <div part="icon" class="alert__icon">
          <slot name="icon"></slot>
        </div>

        <div part="message" class="alert__message" aria-live="polite">
          <slot></slot>
        </div>

        ${this.closable?z`
              <sl-icon-button
                part="close-button"
                exportparts="base:close-button__base"
                class="alert__close-button"
                name="x-lg"
                library="system"
                label=${this.localize.term("close")}
                @click=${this.handleCloseClick}
              ></sl-icon-button>
            `:""}

        <div role="timer" class="alert__timer">${this.remainingTime}</div>

        ${this.countdown?z`
              <div
                class=${kt({alert__countdown:!0,"alert__countdown--ltr":this.countdown==="ltr"})}
              >
                <div class="alert__countdown-elapsed"></div>
              </div>
            `:""}
      </div>
    `}};Ft.styles=[lr,af];Ft.dependencies={"sl-icon-button":Zc};S([ct('[part~="base"]')],Ft.prototype,"base",2);S([ct(".alert__countdown-elapsed")],Ft.prototype,"countdownElement",2);S([b({type:Boolean,reflect:!0})],Ft.prototype,"open",2);S([b({type:Boolean,reflect:!0})],Ft.prototype,"closable",2);S([b({reflect:!0})],Ft.prototype,"variant",2);S([b({type:Number})],Ft.prototype,"duration",2);S([b({type:String,reflect:!0})],Ft.prototype,"countdown",2);S([F()],Ft.prototype,"remainingTime",2);S([Pn("open",{waitUntilFirstUpdate:!0})],Ft.prototype,"handleOpenChange",1);S([Pn("duration")],Ft.prototype,"handleDurationChange",1);var lf=Ft;Be("alert.show",{keyframes:[{opacity:0,scale:.8},{opacity:1,scale:1}],options:{duration:250,easing:"ease"}});Be("alert.hide",{keyframes:[{opacity:1,scale:1},{opacity:0,scale:.8}],options:{duration:250,easing:"ease"}});lf.define("sl-alert");function hi(n){if(typeof n!="string"||!n)throw new Error("expected a non-empty string, got: "+n)}function Do(n){if(typeof n!="number")throw new Error("expected a number, got: "+n)}const cf=1,df=1,Rn="emoji",er="keyvalue",ha="favorites",hf="tokens",fd="tokens",uf="unicode",md="count",pf="group",ff="order",gd="group-order",ms="eTag",Ai="url",tl="skinTone",fr="readonly",ua="readwrite",bd="skinUnicodes",mf="skinUnicodes",gf="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",bf="en";function yf(n,t){const e=new Set,r=[];for(const i of n){const o=t(i);e.has(o)||(e.add(o),r.push(i))}return r}function el(n){return yf(n,t=>t.unicode)}function vf(n){function t(e,r,i){const o=r?n.createObjectStore(e,{keyPath:r}):n.createObjectStore(e);if(i)for(const[s,[a,l]]of Object.entries(i))o.createIndex(s,a,{multiEntry:l});return o}t(er),t(Rn,uf,{[fd]:[hf,!0],[gd]:[[pf,ff]],[bd]:[mf,!0]}),t(ha,void 0,{[md]:[""]})}const gs={},wi={},_i={};function yd(n,t,e){e.onerror=()=>t(e.error),e.onblocked=()=>t(new Error("IDB blocked")),e.onsuccess=()=>n(e.result)}async function wf(n){const t=await new Promise((e,r)=>{const i=indexedDB.open(n,cf);gs[n]=i,i.onupgradeneeded=o=>{o.oldVersion<df&&vf(i.result)},yd(e,r,i)});return t.onclose=()=>pa(n),t}function xf(n){return wi[n]||(wi[n]=wf(n)),wi[n]}function Fe(n,t,e,r){return new Promise((i,o)=>{const s=n.transaction(t,e,{durability:"relaxed"}),a=typeof t=="string"?s.objectStore(t):t.map(c=>s.objectStore(c));let l;r(a,s,c=>{l=c}),s.oncomplete=()=>i(l),s.onerror=()=>o(s.error)})}function pa(n){const t=gs[n],e=t&&t.result;if(e){e.close();const r=_i[n];if(r)for(const i of r)i()}delete gs[n],delete wi[n],delete _i[n]}function kf(n){return new Promise((t,e)=>{pa(n);const r=indexedDB.deleteDatabase(n);yd(t,e,r)})}function Sf(n,t){let e=_i[n];e||(e=_i[n]=[]),e.push(t)}const Cf=new Set([":D","XD",":'D","O:)",":X",":P",";P","XP",":L",":Z",":j","8D","XO","8)",":B",":O",":S",":'o","Dx","X(","D:",":C",">0)",":3","</3","<3","\\M/",":E","8#"]);function Gn(n){return n.split(/[\s_]+/).map(t=>!t.match(/\w/)||Cf.has(t)?t.toLowerCase():t.replace(/[)(:,]/g,"").replace(/โ/g,"'").toLowerCase()).filter(Boolean)}const Ef=2;function vd(n){return n.filter(Boolean).map(t=>t.toLowerCase()).filter(t=>t.length>=Ef)}function Of(n){return n.map(({annotation:e,emoticon:r,group:i,order:o,shortcodes:s,skins:a,tags:l,emoji:c,version:d})=>{const h=[...new Set(vd([...(s||[]).map(Gn).flat(),...(l||[]).map(Gn).flat(),...Gn(e),r]))].sort(),u={annotation:e,group:i,order:o,tags:l,tokens:h,unicode:c,version:d};if(r&&(u.emoticon=r),s&&(u.shortcodes=s),a){u.skinTones=[],u.skinUnicodes=[],u.skinVersions=[];for(const{tone:p,emoji:f,version:m}of a)u.skinTones.push(p),u.skinUnicodes.push(f),u.skinVersions.push(m)}return u})}function wd(n,t,e,r){n[t](e).onsuccess=i=>r&&r(i.target.result)}function An(n,t,e){wd(n,"get",t,e)}function xd(n,t,e){wd(n,"getAll",t,e)}function fa(n){n.commit&&n.commit()}function Mf(n,t){let e=n[0];for(let r=1;r<n.length;r++){const i=n[r];t(e)>t(i)&&(e=i)}return e}function kd(n,t){const e=Mf(n,i=>i.length),r=[];for(const i of e)n.some(o=>o.findIndex(s=>t(s)===t(i))===-1)||r.push(i);return r}async function Tf(n){return!await ma(n,er,Ai)}async function Af(n,t,e){const[r,i]=await Promise.all([ms,Ai].map(o=>ma(n,er,o)));return r===e&&i===t}async function _f(n,t){return Fe(n,Rn,fr,(r,i,o)=>{let s;const a=()=>{r.getAll(s&&IDBKeyRange.lowerBound(s,!0),50).onsuccess=l=>{const c=l.target.result;for(const d of c)if(s=d.unicode,t(d))return o(d);if(c.length<50)return o();a()}};a()})}async function Sd(n,t,e,r){try{const i=Of(t);await Fe(n,[Rn,er],ua,([o,s],a)=>{let l,c,d=0;function h(){++d===2&&u()}function u(){if(!(l===r&&c===e)){o.clear();for(const p of i)o.put(p);s.put(r,ms),s.put(e,Ai),fa(a)}}An(s,ms,p=>{l=p,h()}),An(s,Ai,p=>{c=p,h()})})}finally{}}async function Df(n,t){return Fe(n,Rn,fr,(e,r,i)=>{const o=IDBKeyRange.bound([t,0],[t+1,0],!1,!0);xd(e.index(gd),o,i)})}async function Cd(n,t){const e=vd(Gn(t));return e.length?Fe(n,Rn,fr,(r,i,o)=>{const s=[],a=()=>{s.length===e.length&&l()},l=()=>{const c=kd(s,d=>d.unicode);o(c.sort((d,h)=>d.order<h.order?-1:1))};for(let c=0;c<e.length;c++){const d=e[c],h=c===e.length-1?IDBKeyRange.bound(d,d+"๏ฟฟ",!1,!0):IDBKeyRange.only(d);xd(r.index(fd),h,u=>{s.push(u),a()})}}):[]}async function $f(n,t){const e=await Cd(n,t);return e.length?e.filter(r=>(r.shortcodes||[]).map(o=>o.toLowerCase()).includes(t.toLowerCase()))[0]||null:await _f(n,i=>(i.shortcodes||[]).includes(t.toLowerCase()))||null}async function Nf(n,t){return Fe(n,Rn,fr,(e,r,i)=>An(e,t,o=>{if(o)return i(o);An(e.index(bd),t,s=>i(s||null))}))}function ma(n,t,e){return Fe(n,t,fr,(r,i,o)=>An(r,e,o))}function If(n,t,e,r){return Fe(n,t,ua,(i,o)=>{i.put(r,e),fa(o)})}function Pf(n,t){return Fe(n,ha,ua,(e,r)=>An(e,t,i=>{e.put((i||0)+1,t),fa(r)}))}function Rf(n,t,e){return e===0?[]:Fe(n,[ha,Rn],fr,([r,i],o,s)=>{const a=[];r.index(md).openCursor(void 0,"prev").onsuccess=l=>{const c=l.target.result;if(!c)return s(a);function d(p){if(a.push(p),a.length===e)return s(a);c.continue()}const h=c.primaryKey,u=t.byName(h);if(u)return d(u);An(i,h,p=>{if(p)return d(p);c.continue()})}})}const ui="";function Lf(n,t){const e=new Map;for(const i of n){const o=t(i);for(const s of o){let a=e;for(let c=0;c<s.length;c++){const d=s.charAt(c);let h=a.get(d);h||(h=new Map,a.set(d,h)),a=h}let l=a.get(ui);l||(l=[],a.set(ui,l)),l.push(i)}}return(i,o)=>{let s=e;for(let c=0;c<i.length;c++){const d=i.charAt(c),h=s.get(d);if(h)s=h;else return[]}if(o)return s.get(ui)||[];const a=[],l=[s];for(;l.length;){const d=[...l.shift().entries()].sort((h,u)=>h[0]<u[0]?-1:1);for(const[h,u]of d)h===ui?a.push(...u):l.push(u)}return a}}const zf=["name","url"];function Bf(n){const t=n&&Array.isArray(n),e=t&&n.length&&(!n[0]||zf.some(r=>!(r in n[0])));if(!t||e)throw new Error("Custom emojis are in the wrong format")}function nl(n){Bf(n);const t=(u,p)=>u.name.toLowerCase()<p.name.toLowerCase()?-1:1,e=n.sort(t),i=Lf(n,u=>{const p=new Set;if(u.shortcodes)for(const f of u.shortcodes)for(const m of Gn(f))p.add(m);return p}),o=u=>i(u,!0),s=u=>i(u,!1),a=u=>{const p=Gn(u),f=p.map((m,g)=>(g<p.length-1?o:s)(m));return kd(f,m=>m.name).sort(t)},l=new Map,c=new Map;for(const u of n){c.set(u.name.toLowerCase(),u);for(const p of u.shortcodes||[])l.set(p.toLowerCase(),u)}return{all:e,search:a,byShortcode:u=>l.get(u.toLowerCase()),byName:u=>c.get(u.toLowerCase())}}const Ff=typeof wrappedJSObject<"u";function Tr(n){if(!n)return n;if(Ff&&(n=structuredClone(n)),delete n.tokens,n.skinTones){const t=n.skinTones.length;n.skins=Array(t);for(let e=0;e<t;e++)n.skins[e]={tone:n.skinTones[e],unicode:n.skinUnicodes[e],version:n.skinVersions[e]};delete n.skinTones,delete n.skinUnicodes,delete n.skinVersions}return n}function Ed(n){n||console.warn("emoji-picker-element is more efficient if the dataSource server exposes an ETag header.")}const jf=["annotation","emoji","group","order","version"];function Vf(n){if(!n||!Array.isArray(n)||!n[0]||typeof n[0]!="object"||jf.some(t=>!(t in n[0])))throw new Error("Emoji data is in the wrong format")}function Od(n,t){if(Math.floor(n.status/100)!==2)throw new Error("Failed to fetch: "+t+":  "+n.status)}async function Hf(n){const t=await fetch(n,{method:"HEAD"});Od(t,n);const e=t.headers.get("etag");return Ed(e),e}async function bs(n){const t=await fetch(n);Od(t,n);const e=t.headers.get("etag");Ed(e);const r=await t.json();return Vf(r),[e,r]}function Wf(n){for(var t="",e=new Uint8Array(n),r=e.byteLength,i=-1;++i<r;)t+=String.fromCharCode(e[i]);return t}function qf(n){for(var t=n.length,e=new ArrayBuffer(t),r=new Uint8Array(e),i=-1;++i<t;)r[i]=n.charCodeAt(i);return e}async function Md(n){const t=JSON.stringify(n);let e=qf(t);const r=await crypto.subtle.digest("SHA-1",e),i=Wf(r);return btoa(i)}async function Uf(n,t){let e,r=await Hf(t);if(!r){const i=await bs(t);r=i[0],e=i[1],r||(r=await Md(e))}await Af(n,t,r)||(e||(e=(await bs(t))[1]),await Sd(n,e,t,r))}async function Kf(n,t){let[e,r]=await bs(t);e||(e=await Md(r)),await Sd(n,r,t,e)}class Gf{constructor({dataSource:t=gf,locale:e=bf,customEmoji:r=[]}={}){this.dataSource=t,this.locale=e,this._dbName=`emoji-picker-element-${this.locale}`,this._db=void 0,this._lazyUpdate=void 0,this._custom=nl(r),this._clear=this._clear.bind(this),this._ready=this._init()}async _init(){const t=this._db=await xf(this._dbName);Sf(this._dbName,this._clear);const e=this.dataSource;await Tf(t)?await Kf(t,e):this._lazyUpdate=Uf(t,e)}async ready(){const t=async()=>(this._ready||(this._ready=this._init()),this._ready);await t(),this._db||await t()}async getEmojiByGroup(t){return Do(t),await this.ready(),el(await Df(this._db,t)).map(Tr)}async getEmojiBySearchQuery(t){hi(t),await this.ready();const e=this._custom.search(t),r=el(await Cd(this._db,t)).map(Tr);return[...e,...r]}async getEmojiByShortcode(t){hi(t),await this.ready();const e=this._custom.byShortcode(t);return e||Tr(await $f(this._db,t))}async getEmojiByUnicodeOrName(t){hi(t),await this.ready();const e=this._custom.byName(t);return e||Tr(await Nf(this._db,t))}async getPreferredSkinTone(){return await this.ready(),await ma(this._db,er,tl)||0}async setPreferredSkinTone(t){return Do(t),await this.ready(),If(this._db,er,tl,t)}async incrementFavoriteEmojiCount(t){return hi(t),await this.ready(),Pf(this._db,t)}async getTopFavoriteEmoji(t){return Do(t),await this.ready(),(await Rf(this._db,this._custom,t)).map(Tr)}set customEmoji(t){this._custom=nl(t)}get customEmoji(){return this._custom.all}async _shutdown(){await this.ready();try{await this._lazyUpdate}catch{}}_clear(){this._db=this._ready=this._lazyUpdate=void 0}async close(){await this._shutdown(),await pa(this._dbName)}async delete(){await this._shutdown(),await kf(this._dbName)}}const ys=[[-1,"โจ","custom"],[0,"๐","smileys-emotion"],[1,"๐","people-body"],[3,"๐ฑ","animals-nature"],[4,"๐","food-drink"],[5,"๐๏ธ","travel-places"],[6,"โฝ","activities"],[7,"๐","objects"],[8,"โ๏ธ","symbols"],[9,"๐","flags"]].map(([n,t,e])=>({id:n,emoji:t,name:e})),$o=ys.slice(1),Jf=2,rl=6,Td=typeof requestIdleCallback=="function"?requestIdleCallback:setTimeout;function il(n){return n.unicode.includes("โ")}const Yf={"๐ซฉ":16,"๐ซจ":15.1,"๐ซ":14,"๐ฅฒ":13.1,"๐ฅป":12.1,"๐ฅฐ":11,"๐คฉ":5,"๐ฑโโ๏ธ":4,"๐คฃ":3,"๐๏ธโ๐จ๏ธ":2,"๐":1,"๐๏ธ":.7,"๐":.6},Xf=1e3,Zf="๐๏ธ",Qf=8,tm=["๐","๐","โค๏ธ","๐๏ธ","๐","๐","๐ญ","โบ๏ธ","๐","๐ฉ","๐","๐","๐","๐"],Ad='"Twemoji Mozilla","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji","EmojiOne Color","Android Emoji",sans-serif',em=(n,t)=>n<t?-1:n>t?1:0,ol=(n,t)=>{const e=document.createElement("canvas");e.width=e.height=1;const r=e.getContext("2d",{willReadFrequently:!0});return r.textBaseline="top",r.font=`100px ${Ad}`,r.fillStyle=t,r.scale(.01,.01),r.fillText(n,0,0),r.getImageData(0,0,1,1).data},nm=(n,t)=>{const e=[...n].join(","),r=[...t].join(",");return e===r&&!e.startsWith("0,0,0,")};function rm(n){const t=ol(n,"#000"),e=ol(n,"#fff");return t&&e&&nm(t,e)}function im(){const n=Object.entries(Yf);try{for(const[t,e]of n)if(rm(t))return e}catch{}finally{}return n[0][1]}let No;const Io=()=>(No||(No=new Promise(n=>Td(()=>n(im())))),No),vs=new Map,om="๏ธ",sm="\uD83C",am="โ",lm=127995,cm=57339;function dm(n,t){if(t===0)return n;const e=n.indexOf(am);return e!==-1?n.substring(0,e)+String.fromCodePoint(lm+t-1)+n.substring(e):(n.endsWith(om)&&(n=n.substring(0,n.length-1)),n+sm+String.fromCodePoint(cm+t-1))}function pe(n){n.preventDefault(),n.stopPropagation()}function Po(n,t,e){return t+=n?-1:1,t<0?t=e.length-1:t>=e.length&&(t=0),t}function _d(n,t){const e=new Set,r=[];for(const i of n){const o=t(i);e.has(o)||(e.add(o),r.push(i))}return r}function hm(n,t){const e=r=>{const i={};for(const o of r)typeof o.tone=="number"&&o.version<=t&&(i[o.tone]=o.unicode);return i};return n.map(({unicode:r,skins:i,shortcodes:o,url:s,name:a,category:l,annotation:c})=>({unicode:r,name:a,shortcodes:o,url:s,category:l,annotation:c,id:r||a,skins:i&&e(i)}))}const xi=requestAnimationFrame;let um=typeof ResizeObserver=="function";function pm(n,t,e){let r;um?(r=new ResizeObserver(e),r.observe(n)):xi(e),t.addEventListener("abort",()=>{r&&r.disconnect()})}function sl(n){{const t=document.createRange();return t.selectNode(n.firstChild),t.getBoundingClientRect().width}}let Ro;function fm(n,t,e){let r=!0;for(const i of n){const o=e(i),s=sl(o);typeof Ro>"u"&&(Ro=sl(t));const a=s/1.8<Ro;vs.set(i.unicode,a),a||(r=!1)}return r}function mm(n){return _d(n,t=>t)}function gm(n){n&&(n.scrollTop=0)}function Ir(n,t,e){let r=n.get(t);return r||(r=e(),n.set(t,r)),r}function al(n){return""+n}function bm(n){const t=document.createElement("template");return t.innerHTML=n,t}const ym=new WeakMap,vm=new WeakMap,wm=Symbol("un-keyed"),xm="replaceChildren"in Element.prototype;function km(n,t){xm?n.replaceChildren(...t):(n.innerHTML="",n.append(...t))}function Sm(n,t){let e=n.firstChild,r=0;for(;e;){if(t[r]!==e)return!0;e=e.nextSibling,r++}return r!==t.length}function Cm(n,t){const{targetNode:e}=t;let{targetParentNode:r}=t,i=!1;r?i=Sm(r,n):(i=!0,t.targetNode=void 0,t.targetParentNode=r=e.parentNode),i&&km(r,n)}function Em(n,t){for(const e of t){const{targetNode:r,currentExpression:i,binding:{expressionIndex:o,attributeName:s,attributeValuePre:a,attributeValuePost:l}}=e,c=n[o];if(i!==c)if(e.currentExpression=c,s)r.setAttribute(s,a+al(c)+l);else{let d;Array.isArray(c)?Cm(c,e):c instanceof Element?(d=c,r.replaceWith(d)):r.nodeValue=al(c),d&&(e.targetNode=d)}}}function Om(n){let t="",e=!1,r=!1,i=-1;const o=new Map,s=[];for(let l=0,c=n.length;l<c;l++){const d=n[l];if(t+=d,l===c-1)break;for(let y=0;y<d.length;y++)switch(d.charAt(y)){case"<":{d.charAt(y+1)==="/"?s.pop():(e=!0,s.push(++i));break}case">":{e=!1,r=!1;break}case"=":{r=!0;break}}const h=s[s.length-1],u=Ir(o,h,()=>[]);let p,f,m;if(r){const y=/(\S+)="?([^"=]*)$/.exec(d);p=y[1],f=y[2],m=/^[^">]*/.exec(n[l+1])[0]}const g={attributeName:p,attributeValuePre:f,attributeValuePost:m,expressionIndex:l};u.push(g),!e&&!r&&(t+=" ")}return{template:bm(t),elementsToBindings:o}}function ll(n,t,e){for(let r=0;r<n.length;r++){const i=n[r],o=i.attributeName?t:t.firstChild,s={binding:i,targetNode:o,targetParentNode:void 0,currentExpression:void 0};e.push(s)}}function Mm(n,t){const e=[];let r;if(t.size===1&&(r=t.get(0)))ll(r,n,e);else{const i=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT);let o=n,s=-1;do{const a=t.get(++s);a&&ll(a,o,e)}while(o=i.nextNode())}return e}function Tm(n){const{template:t,elementsToBindings:e}=Ir(ym,n,()=>Om(n)),r=t.cloneNode(!0).content.firstElementChild,i=Mm(r,e);return function(s){return Em(s,i),r}}function Am(n){const t=Ir(vm,n,()=>new Map);let e=wm;function r(o,...s){const a=Ir(t,o,()=>new Map);return Ir(a,e,()=>Tm(o))(s)}function i(o,s,a){return o.map((l,c)=>{const d=e;e=a(l);try{return s(l,c)}finally{e=d}})}return{map:i,html:r}}function _m(n,t,e,r,i,o,s,a,l){const{labelWithSkin:c,titleForEmoji:d,unicodeWithSkin:h}=e,{html:u,map:p}=Am(t);function f(w,k,M){return p(w,(T,I)=>u`<button role="${k?"option":"menuitem"}" aria-selected="${k?I===t.activeSearchItem:""}" aria-label="${c(T,t.currentSkinTone)}" title="${d(T)}" class="${"emoji"+(k&&I===t.activeSearchItem?" active":"")+(T.unicode?"":" custom-emoji")}" id="${`${M}-${T.id}`}" style="${T.unicode?"":`--custom-emoji-background: url(${JSON.stringify(T.url)})`}">${T.unicode?h(T,t.currentSkinTone):""}</button>`,T=>`${M}-${T.id}`)}const g=(()=>u`<section data-ref="rootElement" class="picker" aria-label="${t.i18n.regionLabel}" style="${t.pickerStyle||""}"><div class="pad-top"></div><div class="search-row"><div class="search-wrapper"><input id="search" class="search" type="search" role="combobox" enterkeyhint="search" placeholder="${t.i18n.searchLabel}" autocapitalize="none" autocomplete="off" spellcheck="true" aria-expanded="${!!(t.searchMode&&t.currentEmojis.length)}" aria-controls="search-results" aria-describedby="search-description" aria-autocomplete="list" aria-activedescendant="${t.activeSearchItemId?`emo-${t.activeSearchItemId}`:""}" data-ref="searchElement" data-on-input="onSearchInput" data-on-keydown="onSearchKeydown"><label class="sr-only" for="search">${t.i18n.searchLabel}</label> <span id="search-description" class="sr-only">${t.i18n.searchDescription}</span></div><div class="skintone-button-wrapper ${t.skinTonePickerExpandedAfterAnimation?"expanded":""}"><button id="skintone-button" class="emoji ${t.skinTonePickerExpanded?"hide-focus":""}" aria-label="${t.skinToneButtonLabel}" title="${t.skinToneButtonLabel}" aria-describedby="skintone-description" aria-haspopup="listbox" aria-expanded="${t.skinTonePickerExpanded}" aria-controls="skintone-list" data-on-click="onClickSkinToneButton">${t.skinToneButtonText||""}</button></div><span id="skintone-description" class="sr-only">${t.i18n.skinToneDescription}</span><div data-ref="skinToneDropdown" id="skintone-list" class="skintone-list hide-focus ${t.skinTonePickerExpanded?"":"hidden no-animate"}" style="transform:translateY(${t.skinTonePickerExpanded?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))"})" role="listbox" aria-label="${t.i18n.skinTonesLabel}" aria-activedescendant="skintone-${t.activeSkinTone}" aria-hidden="${!t.skinTonePickerExpanded}" tabIndex="-1" data-on-focusout="onSkinToneOptionsFocusOut" data-on-click="onSkinToneOptionsClick" data-on-keydown="onSkinToneOptionsKeydown" data-on-keyup="onSkinToneOptionsKeyup">${p(t.skinTones,(w,k)=>u`<div id="skintone-${k}" class="emoji ${k===t.activeSkinTone?"active":""}" aria-selected="${k===t.activeSkinTone}" role="option" title="${t.i18n.skinTones[k]}" aria-label="${t.i18n.skinTones[k]}">${w}</div>`,w=>w)}</div></div><div class="nav" role="tablist" style="grid-template-columns:repeat(${t.groups.length},1fr)" aria-label="${t.i18n.categoriesLabel}" data-on-keydown="onNavKeydown" data-on-click="onNavClick">${p(t.groups,w=>u`<button role="tab" class="nav-button" aria-controls="tab-${w.id}" aria-label="${t.i18n.categories[w.name]}" aria-selected="${!t.searchMode&&t.currentGroup.id===w.id}" title="${t.i18n.categories[w.name]}" data-group-id="${w.id}"><div class="nav-emoji emoji">${w.emoji}</div></button>`,w=>w.id)}</div><div class="indicator-wrapper"><div class="indicator" style="transform:translateX(${(t.isRtl?-1:1)*t.currentGroupIndex*100}%)"></div></div><div class="message ${t.message?"":"gone"}" role="alert" aria-live="polite">${t.message||""}</div><div data-ref="tabpanelElement" class="tabpanel ${!t.databaseLoaded||t.message?"gone":""}" role="${t.searchMode?"region":"tabpanel"}" aria-label="${t.searchMode?t.i18n.searchResultsLabel:t.i18n.categories[t.currentGroup.name]}" id="${t.searchMode?"":`tab-${t.currentGroup.id}`}" tabIndex="0" data-on-click="onEmojiClick"><div data-action="calculateEmojiGridStyle">${p(t.currentEmojisWithCategories,(w,k)=>u`<div><div id="menu-label-${k}" class="category ${t.currentEmojisWithCategories.length===1&&t.currentEmojisWithCategories[0].category===""?"gone":""}" aria-hidden="true">${t.searchMode?t.i18n.searchResultsLabel:w.category?w.category:t.currentEmojisWithCategories.length>1?t.i18n.categories.custom:t.i18n.categories[t.currentGroup.name]}</div><div class="emoji-menu ${k!==0&&!t.searchMode&&t.currentGroup.id===-1?"visibility-auto":""}" style="${`--num-rows: ${Math.ceil(w.emojis.length/t.numColumns)}`}" data-action="updateOnIntersection" role="${t.searchMode?"listbox":"menu"}" aria-labelledby="menu-label-${k}" id="${t.searchMode?"search-results":""}">${f(w.emojis,t.searchMode,"emo")}</div></div>`,w=>w.category)}</div></div><div class="favorites onscreen emoji-menu ${t.message?"gone":""}" role="menu" aria-label="${t.i18n.favoritesLabel}" data-on-click="onEmojiClick">${f(t.currentFavorites,!1,"fav")}</div><button data-ref="baselineEmoji" aria-hidden="true" tabindex="-1" class="abs-pos hidden emoji baseline-emoji">๐</button></section>`)(),y=(w,k)=>{for(const M of n.querySelectorAll(`[${w}]`))k(M,M.getAttribute(w))};if(l){n.appendChild(g);for(const w of["click","focusout","input","keydown","keyup"])y(`data-on-${w}`,(k,M)=>{k.addEventListener(w,r[M])});y("data-ref",(w,k)=>{o[k]=w}),s.addEventListener("abort",()=>{n.removeChild(g)})}y("data-action",(w,k)=>{let M=a.get(k);M||a.set(k,M=new WeakSet),M.has(w)||(M.add(w),i[k](w))})}const Di=typeof queueMicrotask=="function"?queueMicrotask:n=>Promise.resolve().then(n);function Dm(n){let t=!1,e;const r=new Map,i=new Set;let o;const s=()=>{if(t)return;const c=[...i];i.clear();try{for(const d of c)d()}finally{o=!1,i.size&&(o=!0,Di(s))}},a=new Proxy({},{get(c,d){if(e){let h=r.get(d);h||(h=new Set,r.set(d,h)),h.add(e)}return c[d]},set(c,d,h){if(c[d]!==h){c[d]=h;const u=r.get(d);if(u){for(const p of u)i.add(p);o||(o=!0,Di(s))}}return!0}}),l=c=>{const d=()=>{const h=e;e=d;try{return c()}finally{e=h}};return d()};return n.addEventListener("abort",()=>{t=!0}),{state:a,createEffect:l}}function Lo(n,t,e){if(n.length!==t.length)return!1;for(let r=0;r<n.length;r++)if(!e(n[r],t[r]))return!1;return!0}const cl=new WeakMap;function $m(n,t,e){{const r=n.closest(".tabpanel");let i=cl.get(r);i||(i=new IntersectionObserver(e,{root:r,rootMargin:"50% 0px 50% 0px",threshold:0}),cl.set(r,i),t.addEventListener("abort",()=>{i.disconnect()})),i.observe(n)}}const zo=[],{assign:pi}=Object;function Nm(n,t){const e={},r=new AbortController,i=r.signal,{state:o,createEffect:s}=Dm(i),a=new Map;pi(o,{skinToneEmoji:void 0,i18n:void 0,database:void 0,customEmoji:void 0,customCategorySorting:void 0,emojiVersion:void 0}),pi(o,t),pi(o,{initialLoad:!0,currentEmojis:[],currentEmojisWithCategories:[],rawSearchText:"",searchText:"",searchMode:!1,activeSearchItem:-1,message:void 0,skinTonePickerExpanded:!1,skinTonePickerExpandedAfterAnimation:!1,currentSkinTone:0,activeSkinTone:0,skinToneButtonText:void 0,pickerStyle:void 0,skinToneButtonLabel:"",skinTones:[],currentFavorites:[],defaultFavoriteEmojis:void 0,numColumns:Qf,isRtl:!1,currentGroupIndex:0,groups:$o,databaseLoaded:!1,activeSearchItemId:void 0}),s(()=>{o.currentGroup!==o.groups[o.currentGroupIndex]&&(o.currentGroup=o.groups[o.currentGroupIndex])});const l=v=>{n.getElementById(v).focus()},c=v=>n.getElementById(`emo-${v.id}`),d=(v,C)=>{e.rootElement.dispatchEvent(new CustomEvent(v,{detail:C,bubbles:!0,composed:!0}))},h=(v,C)=>v.id===C.id,u=(v,C)=>{const{category:N,emojis:R}=v,{category:dt,emojis:bt}=C;return N!==dt?!1:Lo(R,bt,h)},p=v=>{Lo(o.currentEmojis,v,h)||(o.currentEmojis=v)},f=v=>{o.searchMode!==v&&(o.searchMode=v)},m=v=>{Lo(o.currentEmojisWithCategories,v,u)||(o.currentEmojisWithCategories=v)},g=(v,C)=>C&&v.skins&&v.skins[C]||v.unicode,k={labelWithSkin:(v,C)=>mm([v.name||g(v,C),v.annotation,...v.shortcodes||zo].filter(Boolean)).join(", "),titleForEmoji:v=>v.annotation||(v.shortcodes||zo).join(", "),unicodeWithSkin:g},M={onClickSkinToneButton:zu,onEmojiClick:Ru,onNavClick:he,onNavKeydown:ue,onSearchKeydown:Vt,onSkinToneOptionsClick:Lu,onSkinToneOptionsFocusOut:ju,onSkinToneOptionsKeydown:Bu,onSkinToneOptionsKeyup:Fu,onSearchInput:Vu},T={calculateEmojiGridStyle:H,updateOnIntersection:A};let I=!0;s(()=>{_m(n,o,k,M,T,e,i,a,I),I=!1}),o.emojiVersion||Io().then(v=>{v||(o.message=o.i18n.emojiUnsupportedMessage)}),s(()=>{async function v(){let C=!1;const N=setTimeout(()=>{C=!0,o.message=o.i18n.loadingMessage},Xf);try{await o.database.ready(),o.databaseLoaded=!0}catch(R){console.error(R),o.message=o.i18n.networkErrorMessage}finally{clearTimeout(N),C&&(C=!1,o.message="")}}o.database&&v()}),s(()=>{o.pickerStyle=`
      --num-groups: ${o.groups.length}; 
      --indicator-opacity: ${o.searchMode?0:1}; 
      --num-skintones: ${rl};`}),s(()=>{o.customEmoji&&o.database&&$()}),s(()=>{o.customEmoji&&o.customEmoji.length?o.groups!==ys&&(o.groups=ys):o.groups!==$o&&(o.currentGroupIndex&&o.currentGroupIndex--,o.groups=$o)}),s(()=>{async function v(){o.databaseLoaded&&(o.currentSkinTone=await o.database.getPreferredSkinTone())}v()}),s(()=>{o.skinTones=Array(rl).fill().map((v,C)=>dm(o.skinToneEmoji,C))}),s(()=>{o.skinToneButtonText=o.skinTones[o.currentSkinTone]}),s(()=>{o.skinToneButtonLabel=o.i18n.skinToneLabel.replace("{skinTone}",o.i18n.skinTones[o.currentSkinTone])}),s(()=>{async function v(){const{database:C}=o,N=(await Promise.all(tm.map(R=>C.getEmojiByUnicodeOrName(R)))).filter(Boolean);o.defaultFavoriteEmojis=N}o.databaseLoaded&&v()});function $(){const{customEmoji:v,database:C}=o,N=v||zo;C.customEmoji!==N&&(C.customEmoji=N)}s(()=>{async function v(){$();const{database:C,defaultFavoriteEmojis:N,numColumns:R}=o,dt=await C.getTopFavoriteEmoji(R),bt=await j(_d([...dt,...N],Zt=>Zt.unicode||Zt.name).slice(0,R));o.currentFavorites=bt}o.databaseLoaded&&o.defaultFavoriteEmojis&&v()});function H(v){pm(v,i,()=>{{const C=getComputedStyle(e.rootElement),N=parseInt(C.getPropertyValue("--num-columns"),10),R=C.getPropertyValue("direction")==="rtl";o.numColumns=N,o.isRtl=R}})}function A(v){$m(v,i,C=>{for(const{target:N,isIntersecting:R}of C)N.classList.toggle("onscreen",R)})}s(()=>{async function v(){const{searchText:C,currentGroup:N,databaseLoaded:R,customEmoji:dt}=o;if(!R)o.currentEmojis=[],o.searchMode=!1;else if(C.length>=Jf){const bt=await Mt(C);o.searchText===C&&(p(bt),f(!0))}else{const{id:bt}=N;if(bt!==-1||dt&&dt.length){const Zt=await $t(bt);o.currentGroup.id===bt&&(p(Zt),f(!1))}}}v()});const U=()=>{xi(()=>gm(e.tabpanelElement))};s(()=>{const{currentEmojis:v,emojiVersion:C}=o,N=v.filter(R=>R.unicode).filter(R=>il(R)&&!vs.has(R.unicode));if(!C&&N.length)p(v),xi(()=>et(N));else{const R=C?v:v.filter(X);p(R),U()}});function et(v){fm(v,e.baselineEmoji,c)?U():o.currentEmojis=[...o.currentEmojis]}function X(v){return!v.unicode||!il(v)||vs.get(v.unicode)}async function jt(v){const C=o.emojiVersion||await Io();return v.filter(({version:N})=>!N||N<=C)}async function j(v){return hm(v,o.emojiVersion||await Io())}async function $t(v){const C=v===-1?o.customEmoji:await o.database.getEmojiByGroup(v);return j(await jt(C))}async function Mt(v){return j(await jt(await o.database.getEmojiBySearchQuery(v)))}s(()=>{}),s(()=>{function v(){const{searchMode:N,currentEmojis:R}=o;if(N)return[{category:"",emojis:R}];const dt=new Map;for(const bt of R){const Zt=bt.category||"";let li=dt.get(Zt);li||(li=[],dt.set(Zt,li)),li.push(bt)}return[...dt.entries()].map(([bt,Zt])=>({category:bt,emojis:Zt})).sort((bt,Zt)=>o.customCategorySorting(bt.category,Zt.category))}const C=v();m(C)}),s(()=>{o.activeSearchItemId=o.activeSearchItem!==-1&&o.currentEmojis[o.activeSearchItem].id}),s(()=>{const{rawSearchText:v}=o;Td(()=>{o.searchText=(v||"").trim(),o.activeSearchItem=-1})});function Vt(v){if(!o.searchMode||!o.currentEmojis.length)return;const C=N=>{pe(v),o.activeSearchItem=Po(N,o.activeSearchItem,o.currentEmojis)};switch(v.key){case"ArrowDown":return C(!1);case"ArrowUp":return C(!0);case"Enter":if(o.activeSearchItem===-1)o.activeSearchItem=0;else return pe(v),ai(o.currentEmojis[o.activeSearchItem].id)}}function he(v){const{target:C}=v,N=C.closest(".nav-button");if(!N)return;const R=parseInt(N.dataset.groupId,10);e.searchElement.value="",o.rawSearchText="",o.searchText="",o.activeSearchItem=-1,o.currentGroupIndex=o.groups.findIndex(dt=>dt.id===R)}function ue(v){const{target:C,key:N}=v,R=dt=>{dt&&(pe(v),dt.focus())};switch(N){case"ArrowLeft":return R(C.previousElementSibling);case"ArrowRight":return R(C.nextElementSibling);case"Home":return R(C.parentElement.firstElementChild);case"End":return R(C.parentElement.lastElementChild)}}async function ai(v){const C=await o.database.getEmojiByUnicodeOrName(v),N=[...o.currentEmojis,...o.currentFavorites].find(dt=>dt.id===v),R=N.unicode&&g(N,o.currentSkinTone);await o.database.incrementFavoriteEmojiCount(v),d("emoji-click",{emoji:C,skinTone:o.currentSkinTone,...R&&{unicode:R},...N.name&&{name:N.name}})}async function Ru(v){const{target:C}=v;if(!C.classList.contains("emoji"))return;pe(v);const N=C.id.substring(4);ai(N)}function Mo(v){o.currentSkinTone=v,o.skinTonePickerExpanded=!1,l("skintone-button"),d("skin-tone-change",{skinTone:v}),o.database.setPreferredSkinTone(v)}function Lu(v){const{target:{id:C}}=v,N=C&&C.match(/^skintone-(\d)/);if(!N)return;pe(v);const R=parseInt(N[1],10);Mo(R)}function zu(v){o.skinTonePickerExpanded=!o.skinTonePickerExpanded,o.activeSkinTone=o.currentSkinTone,o.skinTonePickerExpanded&&(pe(v),xi(()=>l("skintone-list")))}s(()=>{o.skinTonePickerExpanded?e.skinToneDropdown.addEventListener("transitionend",()=>{o.skinTonePickerExpandedAfterAnimation=!0},{once:!0}):o.skinTonePickerExpandedAfterAnimation=!1});function Bu(v){if(!o.skinTonePickerExpanded)return;const C=async N=>{pe(v),o.activeSkinTone=N};switch(v.key){case"ArrowUp":return C(Po(!0,o.activeSkinTone,o.skinTones));case"ArrowDown":return C(Po(!1,o.activeSkinTone,o.skinTones));case"Home":return C(0);case"End":return C(o.skinTones.length-1);case"Enter":return pe(v),Mo(o.activeSkinTone);case"Escape":return pe(v),o.skinTonePickerExpanded=!1,l("skintone-button")}}function Fu(v){if(o.skinTonePickerExpanded)switch(v.key){case" ":return pe(v),Mo(o.activeSkinTone)}}async function ju(v){const{relatedTarget:C}=v;(!C||C.id!=="skintone-list")&&(o.skinTonePickerExpanded=!1)}function Vu(v){o.rawSearchText=v.target.value}return{$set(v){pi(o,v)},$destroy(){r.abort()}}}const Im="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",Pm="en";var Rm={categoriesLabel:"Categories",emojiUnsupportedMessage:"Your browser does not support color emoji.",favoritesLabel:"Favorites",loadingMessage:"Loadingโฆ",networkErrorMessage:"Could not load emoji.",regionLabel:"Emoji picker",searchDescription:"When search results are available, press up or down to select and enter to choose.",searchLabel:"Search",searchResultsLabel:"Search results",skinToneDescription:"When expanded, press up or down to select and enter to choose.",skinToneLabel:"Choose a skin tone (currently {skinTone})",skinTonesLabel:"Skin tones",skinTones:["Default","Light","Medium-Light","Medium","Medium-Dark","Dark"],categories:{custom:"Custom","smileys-emotion":"Smileys and emoticons","people-body":"People and body","animals-nature":"Animals and nature","food-drink":"Food and drink","travel-places":"Travel and places",activities:"Activities",objects:"Objects",symbols:"Symbols",flags:"Flags"}},Lm=':host{--emoji-size:1.375rem;--emoji-padding:0.5rem;--category-emoji-size:var(--emoji-size);--category-emoji-padding:var(--emoji-padding);--indicator-height:3px;--input-border-radius:0.5rem;--input-border-size:1px;--input-font-size:1rem;--input-line-height:1.5;--input-padding:0.25rem;--num-columns:8;--outline-size:2px;--border-size:1px;--border-radius:0;--skintone-border-radius:1rem;--category-font-size:1rem;display:flex;width:min-content;height:400px}:host,:host(.light){color-scheme:light;--background:#fff;--border-color:#e0e0e0;--indicator-color:#385ac1;--input-border-color:#999;--input-font-color:#111;--input-placeholder-color:#999;--outline-color:#999;--category-font-color:#111;--button-active-background:#e6e6e6;--button-hover-background:#d9d9d9}:host(.dark){color-scheme:dark;--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}@media (prefers-color-scheme:dark){:host{color-scheme:dark;--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}}:host([hidden]){display:none}button{margin:0;padding:0;border:0;background:0 0;box-shadow:none;-webkit-tap-highlight-color:transparent}button::-moz-focus-inner{border:0}input{padding:0;margin:0;line-height:1.15;font-family:inherit}input[type=search]{-webkit-appearance:none}:focus{outline:var(--outline-color) solid var(--outline-size);outline-offset:calc(-1*var(--outline-size))}:host([data-js-focus-visible]) :focus:not([data-focus-visible-added]){outline:0}:focus:not(:focus-visible){outline:0}.hide-focus{outline:0}*{box-sizing:border-box}.picker{contain:content;display:flex;flex-direction:column;background:var(--background);border:var(--border-size) solid var(--border-color);border-radius:var(--border-radius);width:100%;height:100%;overflow:hidden;--total-emoji-size:calc(var(--emoji-size) + (2 * var(--emoji-padding)));--total-category-emoji-size:calc(var(--category-emoji-size) + (2 * var(--category-emoji-padding)))}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.hidden{opacity:0;pointer-events:none}.abs-pos{position:absolute;left:0;top:0}.gone{display:none!important}.skintone-button-wrapper,.skintone-list{background:var(--background);z-index:3}.skintone-button-wrapper.expanded{z-index:1}.skintone-list{position:absolute;inset-inline-end:0;top:0;z-index:2;overflow:visible;border-bottom:var(--border-size) solid var(--border-color);border-radius:0 0 var(--skintone-border-radius) var(--skintone-border-radius);will-change:transform;transition:transform .2s ease-in-out;transform-origin:center 0}@media (prefers-reduced-motion:reduce){.skintone-list{transition-duration:.001s}}@supports not (inset-inline-end:0){.skintone-list{right:0}}.skintone-list.no-animate{transition:none}.tabpanel{overflow-y:auto;scrollbar-gutter:stable;-webkit-overflow-scrolling:touch;will-change:transform;min-height:0;flex:1;contain:content}.emoji-menu{display:grid;grid-template-columns:repeat(var(--num-columns),var(--total-emoji-size));justify-content:space-around;align-items:flex-start;width:100%}.emoji-menu.visibility-auto{content-visibility:auto;contain-intrinsic-size:calc(var(--num-columns)*var(--total-emoji-size)) calc(var(--num-rows)*var(--total-emoji-size))}.category{padding:var(--emoji-padding);font-size:var(--category-font-size);color:var(--category-font-color)}.emoji,button.emoji{font-size:var(--emoji-size);display:flex;align-items:center;justify-content:center;border-radius:100%;height:var(--total-emoji-size);width:var(--total-emoji-size);line-height:1;overflow:hidden;font-family:var(--emoji-font-family);cursor:pointer}@media (hover:hover) and (pointer:fine){.emoji:hover,button.emoji:hover{background:var(--button-hover-background)}}.emoji.active,.emoji:active,button.emoji.active,button.emoji:active{background:var(--button-active-background)}.onscreen .custom-emoji::after{content:"";width:var(--emoji-size);height:var(--emoji-size);background-repeat:no-repeat;background-position:center center;background-size:contain;background-image:var(--custom-emoji-background)}.nav,.nav-button{align-items:center}.nav{display:grid;justify-content:space-between;contain:content}.nav-button{display:flex;justify-content:center}.nav-emoji{font-size:var(--category-emoji-size);width:var(--total-category-emoji-size);height:var(--total-category-emoji-size)}.indicator-wrapper{display:flex;border-bottom:1px solid var(--border-color)}.indicator{width:calc(100%/var(--num-groups));height:var(--indicator-height);opacity:var(--indicator-opacity);background-color:var(--indicator-color);will-change:transform,opacity;transition:opacity .1s linear,transform .25s ease-in-out}@media (prefers-reduced-motion:reduce){.indicator{will-change:opacity;transition:opacity .1s linear}}.pad-top,input.search{background:var(--background);width:100%}.pad-top{height:var(--emoji-padding);z-index:3}.search-row{display:flex;align-items:center;position:relative;padding-inline-start:var(--emoji-padding);padding-bottom:var(--emoji-padding)}.search-wrapper{flex:1;min-width:0}input.search{padding:var(--input-padding);border-radius:var(--input-border-radius);border:var(--input-border-size) solid var(--input-border-color);color:var(--input-font-color);font-size:var(--input-font-size);line-height:var(--input-line-height)}input.search::placeholder{color:var(--input-placeholder-color)}.favorites{overflow-y:auto;scrollbar-gutter:stable;display:flex;flex-direction:row;border-top:var(--border-size) solid var(--border-color);contain:content}.message{padding:var(--emoji-padding)}';const Dd=["customEmoji","customCategorySorting","database","dataSource","i18n","locale","skinToneEmoji","emojiVersion"],zm=`:host{--emoji-font-family:${Ad}}`;class $d extends HTMLElement{constructor(t){super(),this.attachShadow({mode:"open"});const e=document.createElement("style");e.textContent=Lm+zm,this.shadowRoot.appendChild(e),this._ctx={locale:Pm,dataSource:Im,skinToneEmoji:Zf,customCategorySorting:em,customEmoji:null,i18n:Rm,emojiVersion:null,...t};for(const r of Dd)r!=="database"&&Object.prototype.hasOwnProperty.call(this,r)&&(this._ctx[r]=this[r],delete this[r]);this._dbFlush()}connectedCallback(){this._cmp||(this._cmp=Nm(this.shadowRoot,this._ctx))}disconnectedCallback(){Di(()=>{if(!this.isConnected&&this._cmp){this._cmp.$destroy(),this._cmp=void 0;const{database:t}=this._ctx;t.close().catch(e=>console.error(e))}})}static get observedAttributes(){return["locale","data-source","skin-tone-emoji","emoji-version"]}attributeChangedCallback(t,e,r){this._set(t.replace(/-([a-z])/g,(i,o)=>o.toUpperCase()),t==="emoji-version"?parseFloat(r):r)}_set(t,e){this._ctx[t]=e,this._cmp&&this._cmp.$set({[t]:e}),["locale","dataSource"].includes(t)&&this._dbFlush()}_dbCreate(){const{locale:t,dataSource:e,database:r}=this._ctx;(!r||r.locale!==t||r.dataSource!==e)&&this._set("database",new Gf({locale:t,dataSource:e}))}_dbFlush(){Di(()=>this._dbCreate())}}const Nd={};for(const n of Dd)Nd[n]={get(){return n==="database"&&this._dbCreate(),this._ctx[n]},set(t){if(n==="database")throw new Error("database is read-only");this._set(n,t)}};Object.defineProperties($d.prototype,Nd);customElements.get("emoji-picker")||customElements.define("emoji-picker",$d);var Bm=Object.defineProperty,Fm=Object.getOwnPropertyDescriptor,mr=(n,t,e,r)=>{for(var i=r>1?void 0:r?Fm(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&Bm(t,e,i),i};let _n=class extends G{constructor(){var n;super(...arguments),this.input=this.querySelector("input"),this.contentEl=this.querySelector("[data-type-ahead-content]"),this._initialContentHtml=((n=this.contentEl)==null?void 0:n.innerHTML)||"",this._searchAbortController=new AbortController,this._throttledSearch=Xu(this._search,300,{leading:!1}),this.queryPath="",this.queryKey="q",this.external=!1,this.fetching=!1,this.shouldReFetch=!1}connectedCallback(){super.connectedCallback(),this.initialize()}initialize(){!this.input||!this.contentEl||this.input.addEventListener("input",()=>{this.input.value?this._throttledSearch():this.reset()})}_setContent(n){this.contentEl.innerHTML!==n&&(this.contentEl.innerHTML=n,this.dispatchEvent(new CustomEvent("drb-type-ahead-updated",{bubbles:!0,composed:!0})))}async _search(){var t;if(this.fetching){this.shouldReFetch=!0;return}this.fetching=!0;const n=this.queryPath.startsWith("/")?new URL(window.location.origin+this.queryPath):new URL(this.queryPath);n.searchParams.set(this.queryKey,this.input.value);try{const e=await fetch(n.toString(),{method:"GET",headers:this.external?{}:{"X-Requested-With":"XMLHttpRequest"},signal:this._searchAbortController.signal});if(!e.ok)throw new Error("Something went wrong");const i=e.headers.get("content-type")==="application/json"?await e.json():await e.text();this._setContent(((t=this.transformContent)==null?void 0:t.call(this,i))||i)}catch(e){console.warn("Search error:",e)}finally{this.fetching=!1,this.shouldReFetch&&(this.shouldReFetch=!1,this._search())}}abort(){this._throttledSearch.cancel(),this._searchAbortController.abort(),this._searchAbortController=new AbortController,this.fetching=!1,this.shouldReFetch=!1}reset(n=!0){n&&(this.input.value=""),this.abort(),this._setContent(this._initialContentHtml)}render(){return z`
      <slot></slot>
    `}};mr([b({attribute:"query-path",type:String})],_n.prototype,"queryPath",2);mr([b({attribute:"query-key",type:String})],_n.prototype,"queryKey",2);mr([b({type:Boolean})],_n.prototype,"external",2);mr([F()],_n.prototype,"fetching",2);mr([F()],_n.prototype,"shouldReFetch",2);_n=mr([J("drb-type-ahead")],_n);const jm=`:host{display:contents}sl-popup::part(popup){visibility:var(--popover-visibility);z-index:9999;z-index:var(--zi-default-overlay, 9999);min-width:150px;min-width:var(--popover-min-width, 150px);max-width:var(--popover-max-width);max-height:var(--popover-max-height);padding:12px;padding:var(--popover-padding, 12px);overflow-x:hidden;transition-property:opacity,transform,visibility;transition-duration:.2s;transition-duration:var(--popover-transition-duration, .2s);transition-timing-function:cubic-bezier(.34,1.56,.64,1);transition-timing-function:var(--popover-transition-timing-function, cubic-bezier(.34, 1.56, .64, 1));transition-delay:0;transition-delay:var(--popover-transition-delay, 0);border:1px solid rgba(230.8,230.7,232.9,.5);border:var(--popover-border, 1px solid rgba(230.8, 230.7, 232.9, .5));border-radius:8px;border-radius:var(--popover-radius, 8px);opacity:var(--popover-opacity);background:#fff;background:var(--popover-bg, #fff);box-shadow:0 15px 50px #1b20321a;box-shadow:var(--popover-box-shadow, 0px 15px 50px 0px rgba(27, 32, 50, .1))}sl-popup:not([active])::part(popup){display:block;visibility:hidden;height:0;padding:0;transform:var(--popover-none-transform);transform:var(--popover-initial-transform);transition:none;opacity:0;pointer-events:none}sl-popup::part(arrow){--arrow-color: var(--popover-arrow-color, rgb(242.9, 242.85, 243.95))}
`;var Vm=Object.defineProperty,Hm=Object.getOwnPropertyDescriptor,ae=(n,t,e,r)=>{for(var i=r>1?void 0:r?Hm(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&Vm(t,e,i),i};let Lt=class extends G{constructor(){super(...arguments),this.isActive=!1,this.shift=!1,this.flip=!1,this.hoverBridge=!1,this.placement="bottom-end",this.distance=0,this.sync="",this.autoSize="",this.strategy="absolute"}scrollContainerTo(n){var e,r,i;const t=(i=(r=(e=this.shadowRoot)==null?void 0:e.querySelector("sl-popup"))==null?void 0:r.shadowRoot)==null?void 0:i.querySelector(".popup");t==null||t.scrollTo(n)}render(){return z`
      <sl-popup
        active="${this.isActive||ot}"
        shift="${this.shift||ot}"
        shift-padding="${this.shiftPadding||ot}"
        hover-bridge="${this.hoverBridge||ot}"
        flip="${this.flip||ot}"
        placement="${this.placement}"
        distance="${this.distance}"
        sync="${this.sync}"
        autoSize="${this.autoSize}"
        strategy="${this.strategy}"
      >
        <slot slot="anchor"></slot>
        <slot name="popover-content"></slot>
      </sl-popup>
    `}};Lt.styles=Z(jm);ae([b({attribute:"active",reflect:!0,type:Boolean})],Lt.prototype,"isActive",2);ae([b({type:Boolean})],Lt.prototype,"shift",2);ae([b({type:Boolean})],Lt.prototype,"flip",2);ae([b({attribute:"shift-padding",type:Number})],Lt.prototype,"shiftPadding",2);ae([b({attribute:"hover-bridge",type:Boolean})],Lt.prototype,"hoverBridge",2);ae([b({type:String})],Lt.prototype,"placement",2);ae([b({type:Number})],Lt.prototype,"distance",2);ae([b({type:String})],Lt.prototype,"sync",2);ae([b({type:String})],Lt.prototype,"autoSize",2);ae([b({type:String})],Lt.prototype,"strategy",2);Lt=ae([J("drb-popover")],Lt);const Wm=`:host{display:contents}.tooltip{--popover-transition-duration: .3s;--popover-border: var(--tooltip-border, 1px solid #f3f3f4);--popover-padding: var(--tooltip-padding, 16px);--popover-max-width: var(--tooltip-max-width, 310px);--popover-min-width: var(--tooltip-min-width, none)}.tooltip[active]{--popover-transition-delay: var(--tooltip-delay, 0s)}.tooltip__content{display:block;color:#0d0c22;color:var(--tooltip-color, #0d0c22);font-size:14px;font-size:var(--tooltip-font-size, 14px);font-weight:400;font-weight:var(--tooltip-font-weight, normal);line-height:1.2;line-height:var(--tooltip-line-height, 1.2)}
`;var qm=Object.defineProperty,Um=Object.getOwnPropertyDescriptor,le=(n,t,e,r)=>{for(var i=r>1?void 0:r?Um(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&qm(t,e,i),i};let zt=class extends G{constructor(){super(...arguments),this.isTouchDevice=matchMedia("(hover: none)").matches,this.placement="top-center",this.distance=6,this.content="",this.maxWidth="310px",this.minWidth="none",this.mouseOnly=!1,this.flip=!1,this.active=!1,this.strategy="fixed",this.delay=100}handleMouseOut(){if(this.isTouchDevice){this.active=!1;return}setTimeout(()=>{var t,e;((e=(t=this.shadowRoot)==null?void 0:t.querySelector("[data-tooltip"))==null?void 0:e.matches(":hover"))||(this.active=!1)},150)}render(){return z`
      <drb-popover
        data-tooltip
        style=${`
          --tooltip-max-width: ${this.maxWidth};
          --tooltip-min-width: ${this.minWidth};
          --tooltip-delay: ${this.isTouchDevice?0:this.delay}ms;
        `}
        active="${this.active||ot}"
        shift
        flip="${this.flip||ot}"
        shift-padding="10"
        auto-size="horizontal"
        strategy="${this.strategy}"
        hover-bridge
        placement="${this.placement}"
        distance="${this.distance}"
        class="tooltip"
        @mouseout="${this.handleMouseOut}"
        @mouseover="${()=>{this.active=this.mouseOnly?!this.isTouchDevice:!0}}"
      >
        <slot></slot>

        <slot
          name="tooltip-content"
          slot="popover-content"
          class="tooltip__content"
        >
          ${this.content}
        </slot>
      </drb-popover>
    `}};zt.styles=Z(Wm);le([b({type:String})],zt.prototype,"placement",2);le([b({type:Number})],zt.prototype,"distance",2);le([b({type:String})],zt.prototype,"content",2);le([b({attribute:"max-width",type:String})],zt.prototype,"maxWidth",2);le([b({attribute:"min-width",type:String})],zt.prototype,"minWidth",2);le([b({attribute:"mouse-only",type:Boolean})],zt.prototype,"mouseOnly",2);le([b({type:Boolean})],zt.prototype,"flip",2);le([F()],zt.prototype,"active",2);le([b({type:String})],zt.prototype,"strategy",2);le([b({type:Number})],zt.prototype,"delay",2);zt=le([J("drb-tooltip")],zt);const Km=`:host{display:contents}.dropdown-option{display:flex;position:relative;box-sizing:border-box;align-items:center;width:100%;width:var(--dropdown-option-width, 100%);height:38px;height:var(--dropdown-option-height, 38px);margin:0;padding:12px;padding:var(--dropdown-option-padding, 12px);border:1px solid transparent;border:1px solid var(--dropdown-option-border-color, transparent);border-radius:8px;border-radius:var(--dropdown-option-radius, 8px);background-color:#fff;background-color:var(--dropdown-option-bg-color, #fff);color:#3d3d4e;color:var(--dropdown-option-color, rgb(61.4, 60.6, 78.2));font-family:inherit;font-size:14px;font-size:var(--dropdown-option-font-size, 14px);font-weight:500;font-weight:var(--dropdown-option-font-weight, 500);line-height:1.1;text-decoration:none;cursor:pointer}.dropdown-option:hover,.dropdown-option:focus-visible{--dropdown-option-bg-color: rgb(250.16, 250.14, 250.58);--dropdown-option-border-color: rgb(242.9, 242.85, 243.95);outline:0}:host([selected]) .dropdown-option{--dropdown-option-font-weight: 700}.dropdown-option__text{width:100%;overflow:hidden;text-align:left;text-overflow:ellipsis;white-space:nowrap}
`;var Gm=Object.defineProperty,Jm=Object.getOwnPropertyDescriptor,ln=(n,t,e,r)=>{for(var i=r>1?void 0:r?Jm(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&Gm(t,e,i),i};let we=class extends G{constructor(){var n,t;super(...arguments),this.dropdown=this.closest("drb-dropdown"),this.unstyled=!1,this.selected=!1,this.noSelected=!1,this.label=((n=this.textContent)==null?void 0:n.trim())||"",this.value=((t=this.textContent)==null?void 0:t.trim())||"",this.href="",this.download=""}connectedCallback(){super.connectedCallback(),this.dropdown&&(this._syncSelected(),this.addEventListener("click",()=>{this.href||(this.dropdown.value=this.value,this.dropdown.label=this.label,this.dropdown.close())}),this.dropdown.addEventListener("change",this._syncSelected.bind(this)))}focus(){const n=this.renderRoot.querySelector("a, button");n==null||n.focus()}_syncSelected(){this.noSelected||(this.selected=this.dropdown.value===this.value)}render(){const n=this.href?qe`a`:qe`button`;return this.unstyled?Ut`<slot></slot>`:Ut`
        <${n}
          class="dropdown-option"
          href="${this.href||ot}"
          download="${this.download||ot}"
        >
          <span class="dropdown-option__text">
            <slot></slot>
          </span>
        </${n}>
      `}};we.styles=Z(Km);ln([b({reflect:!0,type:Boolean})],we.prototype,"unstyled",2);ln([b({reflect:!0,type:Boolean})],we.prototype,"selected",2);ln([b({attribute:"no-selected",type:Boolean})],we.prototype,"noSelected",2);ln([b()],we.prototype,"label",2);ln([b()],we.prototype,"value",2);ln([b()],we.prototype,"href",2);ln([b()],we.prototype,"download",2);we=ln([J("drb-dropdown-option")],we);const Ym=`:host{--popover-initial-transform: translate(0, -6px);display:contents}
`;var Xm=Object.defineProperty,Zm=Object.getOwnPropertyDescriptor,ce=(n,t,e,r)=>{for(var i=r>1?void 0:r?Zm(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&Xm(t,e,i),i};let St=class extends G{constructor(){super(),this.isDraggingFromWithin=!1,this.isActive=!1,this.name="",this.value="",this.label="",this.flip=!1,this.distance=8,this.fitContent=!1,this.placement="bottom-end",this.noToggleOpen=!1,this.strategy="absolute",this._toggleOpen=()=>{this.noToggleOpen||(this.isActive?this.close():this.open())},this._syncLabel=()=>{const n=Array.from(this.querySelectorAll("drb-dropdown-option")).find(t=>t.value===this.value);n&&(this.label=n.label)},this.attachInternals&&(this.internals=this.attachInternals())}get _slottedChildren(){return this.shadowRoot.querySelector("slot").assignedElements({flatten:!0})}connectedCallback(){super.connectedCallback(),this._syncLabel(),document.addEventListener("click",n=>{const t=n.target;!this.contains(t)&&!this._slottedChildren.includes(t)&&this.isActive&&!this.isDraggingFromWithin&&this.close()}),document.addEventListener("keyup",n=>{n.key==="Escape"&&this.isActive&&(n.stopPropagation(),this.close())}),document.addEventListener("keydown",n=>{this.isActive&&(n.key==="ArrowDown"||n.key==="ArrowUp")&&(n.stopPropagation(),n.preventDefault(),this.handleKeyboardNav(n.key))}),document.addEventListener("mouseup",()=>{sn(()=>{this.isDraggingFromWithin=!1})})}updated(n){var t;if(n.has("label")){const e=this.querySelector("[data-dropdown-label]");e&&this.label&&(e.innerHTML=this.label)}n.has("value")&&(this.close(),this.name&&((t=this.internals)==null||t.setFormValue(this.value)),n.has("label")||this._syncLabel(),!n.get("value")&&!this.value||this.dispatchEvent(new CustomEvent("change",{bubbles:!0,composed:!0})))}handleKeyboardNav(n){var s;const t=Array.from(this.querySelectorAll("drb-dropdown-option"));if(!t.length)return;const e=t.find(a=>a===document.activeElement),r=t.find(a=>a.selected),i=n==="ArrowDown"?1:-1;let o=t.indexOf(e||r)+i;o>=t.length?o=0:o<0&&(o=t.length-1),(s=t[o])==null||s.focus()}close(){this.isActive=!1,setTimeout(()=>{Array.from(this.querySelectorAll("drb-type-ahead")).forEach(t=>t.reset())},300)}open(){this.isActive=!0}render(){return z`
      <drb-popover
        active="${this.isActive||ot}"
        flip="${this.flip||ot}"
        strategy="${this.strategy}"
        distance="${this.distance}"
        placement="${this.placement}"
        sync="${this.fitContent?"":"width"}"
        @mousedown="${()=>{this.isDraggingFromWithin=!0}}"
      >
        <slot @click="${this._toggleOpen}"></slot>
        <slot
          name="dropdown-content"
          slot="popover-content"
        ></slot>
      </drb-popover>
    `}};St.styles=Z(Ym);St.formAssociated=!0;ce([b({attribute:"active",reflect:!0})],St.prototype,"isActive",2);ce([b()],St.prototype,"name",2);ce([b({reflect:!0,type:String})],St.prototype,"value",2);ce([b({reflect:!0,type:String})],St.prototype,"label",2);ce([b({type:Boolean})],St.prototype,"flip",2);ce([b({type:Number})],St.prototype,"distance",2);ce([b({attribute:"fit-content",type:Boolean})],St.prototype,"fitContent",2);ce([b({attribute:"placement",type:String})],St.prototype,"placement",2);ce([b({attribute:"no-toggle-open",type:Boolean})],St.prototype,"noToggleOpen",2);ce([b({type:String})],St.prototype,"strategy",2);St=ce([J("drb-dropdown")],St);const Qm=`:host{display:contents}:host([hidden]){display:none}.option-group{--option-padding-offset: 4px;display:flex;flex-direction:column;grid-gap:8px;gap:8px;grid-gap:var(--select-option-gap, 8px);gap:var(--select-option-gap, 8px)}.option-group__container{display:flex;box-sizing:border-box;align-items:center;width:100%;height:36px;height:var(--option-group-height, 36px);padding:4px;padding:var(--option-group-padding, 4px);overflow:hidden;color:#060318;color:var(--option-group-color, #060318);font-family:inherit;font-size:14px;font-size:var(--option-group-font-size, 14px);font-weight:700;font-weight:var(--option-group-font-weight, 700);line-height:1.1}.option-group__label{width:100%;overflow:hidden;text-align:left;text-overflow:ellipsis;white-space:nowrap}
`;var tg=Object.defineProperty,eg=Object.getOwnPropertyDescriptor,ga=(n,t,e,r)=>{for(var i=r>1?void 0:r?eg(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&tg(t,e,i),i};let Hr=class extends G{constructor(){super(...arguments),this.listOrder=0,this.label=""}render(){return Ut`
      <div
        class="option-group"
        style=${`order: ${this.listOrder}`}
      >
        <div class="option-group__container">
          <div class="option-group__label">
            ${this.label}
          </div>
        </div>

        <slot></slot>
      </div>
    `}};Hr.styles=Z(Qm);ga([F()],Hr.prototype,"listOrder",2);ga([b({type:String})],Hr.prototype,"label",2);Hr=ga([J("drb-option-group")],Hr);const ng=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
  <path d="M20 6L9 17L4 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
</svg>
`,rg=`:host{display:contents}:host([hidden]),:host([user-created]){display:none}.option{display:flex;position:relative;box-sizing:border-box;align-items:center;width:100%;width:var(--option-width, 100%);height:40px;height:var(--option-height, 40px);margin:0;padding:12px;padding:var(--option-padding, 12px);padding-left:12px;padding-left:calc(var(--option-padding, 12px) + var(--option-padding-offset, 0px));border:1px solid transparent;border:1px solid var(--option-border-color, transparent);border-radius:8px;border-radius:var(--option-radius, 8px);background-color:#fff;background-color:var(--option-bg-color, #fff);color:#3d3d4e;color:var(--option-color, rgb(61.4, 60.6, 78.2));font-family:inherit;font-size:14px;font-size:var(--option-font-size, 14px);font-weight:500;font-weight:var(--option-font-weight, 500);line-height:1.1;text-decoration:none;cursor:pointer;grid-gap:8px;gap:8px;grid-gap:var(--option-gap, 8px);gap:var(--option-gap, 8px);scroll-margin:10px}:host([selected]) .option{--option-font-weight: 700}:host([disabled]) .option{opacity:.5}.option--selected{border-color:#f3f3f6;border-color:var(--option-selected-border-color, #f3f3f6);background-color:#f3f3f6;background-color:var(--option-selected-bg-color, #f3f3f6);color:#060318;color:var(--option-selected-color, #060318)}.option--current{border-color:#fcf7fd;border-color:var(--option-current-border-color, #fcf7fd);background-color:#fcf7fd;background-color:var(--option-current-bg-color, #fcf7fd);color:#060318;color:var(--option-current-color, #060318)}.option--current.option--selected{border-color:#faebf9;border-color:var(--option-current-selected-border-color, #faebf9);background-color:#faebf9;background-color:var(--option-current-selected-bg-color, #faebf9);color:#060318;color:var(--option-current-selected-color, #060318)}.option__content{display:flex;flex:1 1;overflow:hidden}.option__text{width:100%;overflow:hidden;text-align:left;text-overflow:ellipsis;white-space:nowrap}.option__check-icon{width:20px;height:20px}.option__check-icon svg{width:100%;height:100%}
`;var ig=Object.defineProperty,og=Object.getOwnPropertyDescriptor,Oe=(n,t,e,r)=>{for(var i=r>1?void 0:r?og(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&ig(t,e,i),i};let Gt=class extends G{constructor(){var n,t,e;super(...arguments),this.current=!1,this.selected=!1,this.listOrder=0,this.selectedOrder=0,this.optionGroup=this.closest("drb-option-group"),this.optionGroupLabel=((n=this.optionGroup)==null?void 0:n.label)||"",this.label=((t=this.textContent)==null?void 0:t.trim())||"",this.value=((e=this.textContent)==null?void 0:e.trim())||"",this.searchWeight=1,this.disabled=!1}connectedCallback(){super.connectedCallback(),this.setAttribute("role","option")}updated(n){n.has("value")&&(typeof this.value!="string"&&(this.value=String(this.value)),this.value.includes("|")&&(console.error("drb-option values cannot include pipes '|'. All pipes have been replaced with underscores.",this),this.value=this.value.replace(/\|/g,"_")))}scrollIntoView(n){var t;(t=this.optionContainer)!=null&&t.scrollIntoView&&this.optionContainer.scrollIntoView(n)}render(){return Ut`
      <div
        data-option
        style=${`order: ${this.listOrder}`}
        class=${kt({option:!0,"option--current":this.current,"option--disabled":this.disabled,"option--selected":this.selected})}
      >
        <span class="option__content">
          <span class="option__text">
            <slot></slot>
          </span>
        </span>

        <span
          class="option__check-icon"
          ?hidden=${!this.selected}
        >
          ${xt(ng)}
        </span>
      </div>
    `}};Gt.styles=Z(rg);Oe([ct("[data-option]")],Gt.prototype,"optionContainer",2);Oe([F()],Gt.prototype,"current",2);Oe([F()],Gt.prototype,"selected",2);Oe([F()],Gt.prototype,"listOrder",2);Oe([F()],Gt.prototype,"selectedOrder",2);Oe([b()],Gt.prototype,"label",2);Oe([b({reflect:!0})],Gt.prototype,"value",2);Oe([b({attribute:"search-weight",type:Number})],Gt.prototype,"searchWeight",2);Oe([b({type:Boolean,reflect:!0})],Gt.prototype,"disabled",2);Gt=Oe([J("drb-option")],Gt);function Pe(n){return Array.isArray?Array.isArray(n):Rd(n)==="[object Array]"}const sg=1/0;function ag(n){if(typeof n=="string")return n;let t=n+"";return t=="0"&&1/n==-sg?"-0":t}function lg(n){return n==null?"":ag(n)}function ge(n){return typeof n=="string"}function Id(n){return typeof n=="number"}function cg(n){return n===!0||n===!1||dg(n)&&Rd(n)=="[object Boolean]"}function Pd(n){return typeof n=="object"}function dg(n){return Pd(n)&&n!==null}function It(n){return n!=null}function Bo(n){return!n.trim().length}function Rd(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}const hg="Incorrect 'index' type",ug=n=>`Invalid value for key ${n}`,pg=n=>`Pattern length exceeds max of ${n}.`,fg=n=>`Missing ${n} property in key`,mg=n=>`Property 'weight' in key '${n}' must be a positive integer`,dl=Object.prototype.hasOwnProperty;class gg{constructor(t){this._keys=[],this._keyMap={};let e=0;t.forEach(r=>{let i=Ld(r);e+=i.weight,this._keys.push(i),this._keyMap[i.id]=i,e+=i.weight}),this._keys.forEach(r=>{r.weight/=e})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function Ld(n){let t=null,e=null,r=null,i=1,o=null;if(ge(n)||Pe(n))r=n,t=hl(n),e=ws(n);else{if(!dl.call(n,"name"))throw new Error(fg("name"));const s=n.name;if(r=s,dl.call(n,"weight")&&(i=n.weight,i<=0))throw new Error(mg(s));t=hl(s),e=ws(s),o=n.getFn}return{path:t,id:e,weight:i,src:r,getFn:o}}function hl(n){return Pe(n)?n:n.split(".")}function ws(n){return Pe(n)?n.join("."):n}function bg(n,t){let e=[],r=!1;const i=(o,s,a)=>{if(It(o))if(!s[a])e.push(o);else{let l=s[a];const c=o[l];if(!It(c))return;if(a===s.length-1&&(ge(c)||Id(c)||cg(c)))e.push(lg(c));else if(Pe(c)){r=!0;for(let d=0,h=c.length;d<h;d+=1)i(c[d],s,a+1)}else s.length&&i(c,s,a+1)}};return i(n,ge(t)?t.split("."):t,0),r?e:e[0]}const yg={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},vg={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(n,t)=>n.score===t.score?n.idx<t.idx?-1:1:n.score<t.score?-1:1},wg={location:0,threshold:.6,distance:100},xg={useExtendedSearch:!1,getFn:bg,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var D={...vg,...yg,...wg,...xg};const kg=/[^ ]+/g;function Sg(n=1,t=3){const e=new Map,r=Math.pow(10,t);return{get(i){const o=i.match(kg).length;if(e.has(o))return e.get(o);const s=1/Math.pow(o,.5*n),a=parseFloat(Math.round(s*r)/r);return e.set(o,a),a},clear(){e.clear()}}}class ba{constructor({getFn:t=D.getFn,fieldNormWeight:e=D.fieldNormWeight}={}){this.norm=Sg(e,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((e,r)=>{this._keysMap[e.id]=r})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,ge(this.docs[0])?this.docs.forEach((t,e)=>{this._addString(t,e)}):this.docs.forEach((t,e)=>{this._addObject(t,e)}),this.norm.clear())}add(t){const e=this.size();ge(t)?this._addString(t,e):this._addObject(t,e)}removeAt(t){this.records.splice(t,1);for(let e=t,r=this.size();e<r;e+=1)this.records[e].i-=1}getValueForItemAtKeyId(t,e){return t[this._keysMap[e]]}size(){return this.records.length}_addString(t,e){if(!It(t)||Bo(t))return;let r={v:t,i:e,n:this.norm.get(t)};this.records.push(r)}_addObject(t,e){let r={i:e,$:{}};this.keys.forEach((i,o)=>{let s=i.getFn?i.getFn(t):this.getFn(t,i.path);if(It(s)){if(Pe(s)){let a=[];const l=[{nestedArrIndex:-1,value:s}];for(;l.length;){const{nestedArrIndex:c,value:d}=l.pop();if(It(d))if(ge(d)&&!Bo(d)){let h={v:d,i:c,n:this.norm.get(d)};a.push(h)}else Pe(d)&&d.forEach((h,u)=>{l.push({nestedArrIndex:u,value:h})})}r.$[o]=a}else if(ge(s)&&!Bo(s)){let a={v:s,n:this.norm.get(s)};r.$[o]=a}}}),this.records.push(r)}toJSON(){return{keys:this.keys,records:this.records}}}function zd(n,t,{getFn:e=D.getFn,fieldNormWeight:r=D.fieldNormWeight}={}){const i=new ba({getFn:e,fieldNormWeight:r});return i.setKeys(n.map(Ld)),i.setSources(t),i.create(),i}function Cg(n,{getFn:t=D.getFn,fieldNormWeight:e=D.fieldNormWeight}={}){const{keys:r,records:i}=n,o=new ba({getFn:t,fieldNormWeight:e});return o.setKeys(r),o.setIndexRecords(i),o}function fi(n,{errors:t=0,currentLocation:e=0,expectedLocation:r=0,distance:i=D.distance,ignoreLocation:o=D.ignoreLocation}={}){const s=t/n.length;if(o)return s;const a=Math.abs(r-e);return i?s+a/i:a?1:s}function Eg(n=[],t=D.minMatchCharLength){let e=[],r=-1,i=-1,o=0;for(let s=n.length;o<s;o+=1){let a=n[o];a&&r===-1?r=o:!a&&r!==-1&&(i=o-1,i-r+1>=t&&e.push([r,i]),r=-1)}return n[o-1]&&o-r>=t&&e.push([r,o-1]),e}const gn=32;function Og(n,t,e,{location:r=D.location,distance:i=D.distance,threshold:o=D.threshold,findAllMatches:s=D.findAllMatches,minMatchCharLength:a=D.minMatchCharLength,includeMatches:l=D.includeMatches,ignoreLocation:c=D.ignoreLocation}={}){if(t.length>gn)throw new Error(pg(gn));const d=t.length,h=n.length,u=Math.max(0,Math.min(r,h));let p=o,f=u;const m=a>1||l,g=m?Array(h):[];let y;for(;(y=n.indexOf(t,f))>-1;){let $=fi(t,{currentLocation:y,expectedLocation:u,distance:i,ignoreLocation:c});if(p=Math.min($,p),f=y+d,m){let H=0;for(;H<d;)g[y+H]=1,H+=1}}f=-1;let w=[],k=1,M=d+h;const T=1<<d-1;for(let $=0;$<d;$+=1){let H=0,A=M;for(;H<A;)fi(t,{errors:$,currentLocation:u+A,expectedLocation:u,distance:i,ignoreLocation:c})<=p?H=A:M=A,A=Math.floor((M-H)/2+H);M=A;let U=Math.max(1,u-A+1),et=s?h:Math.min(u+A,h)+d,X=Array(et+2);X[et+1]=(1<<$)-1;for(let j=et;j>=U;j-=1){let $t=j-1,Mt=e[n.charAt($t)];if(m&&(g[$t]=+!!Mt),X[j]=(X[j+1]<<1|1)&Mt,$&&(X[j]|=(w[j+1]|w[j])<<1|1|w[j+1]),X[j]&T&&(k=fi(t,{errors:$,currentLocation:$t,expectedLocation:u,distance:i,ignoreLocation:c}),k<=p)){if(p=k,f=$t,f<=u)break;U=Math.max(1,2*u-f)}}if(fi(t,{errors:$+1,currentLocation:u,expectedLocation:u,distance:i,ignoreLocation:c})>p)break;w=X}const I={isMatch:f>=0,score:Math.max(.001,k)};if(m){const $=Eg(g,a);$.length?l&&(I.indices=$):I.isMatch=!1}return I}function Mg(n){let t={};for(let e=0,r=n.length;e<r;e+=1){const i=n.charAt(e);t[i]=(t[i]||0)|1<<r-e-1}return t}class Bd{constructor(t,{location:e=D.location,threshold:r=D.threshold,distance:i=D.distance,includeMatches:o=D.includeMatches,findAllMatches:s=D.findAllMatches,minMatchCharLength:a=D.minMatchCharLength,isCaseSensitive:l=D.isCaseSensitive,ignoreLocation:c=D.ignoreLocation}={}){if(this.options={location:e,threshold:r,distance:i,includeMatches:o,findAllMatches:s,minMatchCharLength:a,isCaseSensitive:l,ignoreLocation:c},this.pattern=l?t:t.toLowerCase(),this.chunks=[],!this.pattern.length)return;const d=(u,p)=>{this.chunks.push({pattern:u,alphabet:Mg(u),startIndex:p})},h=this.pattern.length;if(h>gn){let u=0;const p=h%gn,f=h-p;for(;u<f;)d(this.pattern.substr(u,gn),u),u+=gn;if(p){const m=h-gn;d(this.pattern.substr(m),m)}}else d(this.pattern,0)}searchIn(t){const{isCaseSensitive:e,includeMatches:r}=this.options;if(e||(t=t.toLowerCase()),this.pattern===t){let f={isMatch:!0,score:0};return r&&(f.indices=[[0,t.length-1]]),f}const{location:i,distance:o,threshold:s,findAllMatches:a,minMatchCharLength:l,ignoreLocation:c}=this.options;let d=[],h=0,u=!1;this.chunks.forEach(({pattern:f,alphabet:m,startIndex:g})=>{const{isMatch:y,score:w,indices:k}=Og(t,f,m,{location:i+g,distance:o,threshold:s,findAllMatches:a,minMatchCharLength:l,includeMatches:r,ignoreLocation:c});y&&(u=!0),h+=w,y&&k&&(d=[...d,...k])});let p={isMatch:u,score:u?h/this.chunks.length:1};return u&&r&&(p.indices=d),p}}class cn{constructor(t){this.pattern=t}static isMultiMatch(t){return ul(t,this.multiRegex)}static isSingleMatch(t){return ul(t,this.singleRegex)}search(){}}function ul(n,t){const e=n.match(t);return e?e[1]:null}class Tg extends cn{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){const e=t===this.pattern;return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}}class Ag extends cn{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){const r=t.indexOf(this.pattern)===-1;return{isMatch:r,score:r?0:1,indices:[0,t.length-1]}}}class _g extends cn{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){const e=t.startsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}}class Dg extends cn{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){const e=!t.startsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}}class $g extends cn{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){const e=t.endsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[t.length-this.pattern.length,t.length-1]}}}class Ng extends cn{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){const e=!t.endsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}}class Fd extends cn{constructor(t,{location:e=D.location,threshold:r=D.threshold,distance:i=D.distance,includeMatches:o=D.includeMatches,findAllMatches:s=D.findAllMatches,minMatchCharLength:a=D.minMatchCharLength,isCaseSensitive:l=D.isCaseSensitive,ignoreLocation:c=D.ignoreLocation}={}){super(t),this._bitapSearch=new Bd(t,{location:e,threshold:r,distance:i,includeMatches:o,findAllMatches:s,minMatchCharLength:a,isCaseSensitive:l,ignoreLocation:c})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}}class jd extends cn{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let e=0,r;const i=[],o=this.pattern.length;for(;(r=t.indexOf(this.pattern,e))>-1;)e=r+o,i.push([r,e-1]);const s=!!i.length;return{isMatch:s,score:s?0:1,indices:i}}}const xs=[Tg,jd,_g,Dg,Ng,$g,Ag,Fd],pl=xs.length,Ig=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,Pg="|";function Rg(n,t={}){return n.split(Pg).map(e=>{let r=e.trim().split(Ig).filter(o=>o&&!!o.trim()),i=[];for(let o=0,s=r.length;o<s;o+=1){const a=r[o];let l=!1,c=-1;for(;!l&&++c<pl;){const d=xs[c];let h=d.isMultiMatch(a);h&&(i.push(new d(h,t)),l=!0)}if(!l)for(c=-1;++c<pl;){const d=xs[c];let h=d.isSingleMatch(a);if(h){i.push(new d(h,t));break}}}return i})}const Lg=new Set([Fd.type,jd.type]);class zg{constructor(t,{isCaseSensitive:e=D.isCaseSensitive,includeMatches:r=D.includeMatches,minMatchCharLength:i=D.minMatchCharLength,ignoreLocation:o=D.ignoreLocation,findAllMatches:s=D.findAllMatches,location:a=D.location,threshold:l=D.threshold,distance:c=D.distance}={}){this.query=null,this.options={isCaseSensitive:e,includeMatches:r,minMatchCharLength:i,findAllMatches:s,ignoreLocation:o,location:a,threshold:l,distance:c},this.pattern=e?t:t.toLowerCase(),this.query=Rg(this.pattern,this.options)}static condition(t,e){return e.useExtendedSearch}searchIn(t){const e=this.query;if(!e)return{isMatch:!1,score:1};const{includeMatches:r,isCaseSensitive:i}=this.options;t=i?t:t.toLowerCase();let o=0,s=[],a=0;for(let l=0,c=e.length;l<c;l+=1){const d=e[l];s.length=0,o=0;for(let h=0,u=d.length;h<u;h+=1){const p=d[h],{isMatch:f,indices:m,score:g}=p.search(t);if(f){if(o+=1,a+=g,r){const y=p.constructor.type;Lg.has(y)?s=[...s,...m]:s.push(m)}}else{a=0,o=0,s.length=0;break}}if(o){let h={isMatch:!0,score:a/o};return r&&(h.indices=s),h}}return{isMatch:!1,score:1}}}const ks=[];function Bg(...n){ks.push(...n)}function Ss(n,t){for(let e=0,r=ks.length;e<r;e+=1){let i=ks[e];if(i.condition(n,t))return new i(n,t)}return new Bd(n,t)}const $i={AND:"$and",OR:"$or"},Cs={PATH:"$path",PATTERN:"$val"},Es=n=>!!(n[$i.AND]||n[$i.OR]),Fg=n=>!!n[Cs.PATH],jg=n=>!Pe(n)&&Pd(n)&&!Es(n),fl=n=>({[$i.AND]:Object.keys(n).map(t=>({[t]:n[t]}))});function Vd(n,t,{auto:e=!0}={}){const r=i=>{let o=Object.keys(i);const s=Fg(i);if(!s&&o.length>1&&!Es(i))return r(fl(i));if(jg(i)){const l=s?i[Cs.PATH]:o[0],c=s?i[Cs.PATTERN]:i[l];if(!ge(c))throw new Error(ug(l));const d={keyId:ws(l),pattern:c};return e&&(d.searcher=Ss(c,t)),d}let a={children:[],operator:o[0]};return o.forEach(l=>{const c=i[l];Pe(c)&&c.forEach(d=>{a.children.push(r(d))})}),a};return Es(n)||(n=fl(n)),r(n)}function Vg(n,{ignoreFieldNorm:t=D.ignoreFieldNorm}){n.forEach(e=>{let r=1;e.matches.forEach(({key:i,norm:o,score:s})=>{const a=i?i.weight:null;r*=Math.pow(s===0&&a?Number.EPSILON:s,(a||1)*(t?1:o))}),e.score=r})}function Hg(n,t){const e=n.matches;t.matches=[],It(e)&&e.forEach(r=>{if(!It(r.indices)||!r.indices.length)return;const{indices:i,value:o}=r;let s={indices:i,value:o};r.key&&(s.key=r.key.src),r.idx>-1&&(s.refIndex=r.idx),t.matches.push(s)})}function Wg(n,t){t.score=n.score}function qg(n,t,{includeMatches:e=D.includeMatches,includeScore:r=D.includeScore}={}){const i=[];return e&&i.push(Hg),r&&i.push(Wg),n.map(o=>{const{idx:s}=o,a={item:t[s],refIndex:s};return i.length&&i.forEach(l=>{l(o,a)}),a})}class gr{constructor(t,e={},r){this.options={...D,...e},this.options.useExtendedSearch,this._keyStore=new gg(this.options.keys),this.setCollection(t,r)}setCollection(t,e){if(this._docs=t,e&&!(e instanceof ba))throw new Error(hg);this._myIndex=e||zd(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){It(t)&&(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){const e=[];for(let r=0,i=this._docs.length;r<i;r+=1){const o=this._docs[r];t(o,r)&&(this.removeAt(r),r-=1,i-=1,e.push(o))}return e}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:e=-1}={}){const{includeMatches:r,includeScore:i,shouldSort:o,sortFn:s,ignoreFieldNorm:a}=this.options;let l=ge(t)?ge(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return Vg(l,{ignoreFieldNorm:a}),o&&l.sort(s),Id(e)&&e>-1&&(l=l.slice(0,e)),qg(l,this._docs,{includeMatches:r,includeScore:i})}_searchStringList(t){const e=Ss(t,this.options),{records:r}=this._myIndex,i=[];return r.forEach(({v:o,i:s,n:a})=>{if(!It(o))return;const{isMatch:l,score:c,indices:d}=e.searchIn(o);l&&i.push({item:o,idx:s,matches:[{score:c,value:o,norm:a,indices:d}]})}),i}_searchLogical(t){const e=Vd(t,this.options),r=(a,l,c)=>{if(!a.children){const{keyId:h,searcher:u}=a,p=this._findMatches({key:this._keyStore.get(h),value:this._myIndex.getValueForItemAtKeyId(l,h),searcher:u});return p&&p.length?[{idx:c,item:l,matches:p}]:[]}const d=[];for(let h=0,u=a.children.length;h<u;h+=1){const p=a.children[h],f=r(p,l,c);if(f.length)d.push(...f);else if(a.operator===$i.AND)return[]}return d},i=this._myIndex.records,o={},s=[];return i.forEach(({$:a,i:l})=>{if(It(a)){let c=r(e,a,l);c.length&&(o[l]||(o[l]={idx:l,item:a,matches:[]},s.push(o[l])),c.forEach(({matches:d})=>{o[l].matches.push(...d)}))}}),s}_searchObjectList(t){const e=Ss(t,this.options),{keys:r,records:i}=this._myIndex,o=[];return i.forEach(({$:s,i:a})=>{if(!It(s))return;let l=[];r.forEach((c,d)=>{l.push(...this._findMatches({key:c,value:s[d],searcher:e}))}),l.length&&o.push({idx:a,item:s,matches:l})}),o}_findMatches({key:t,value:e,searcher:r}){if(!It(e))return[];let i=[];if(Pe(e))e.forEach(({v:o,i:s,n:a})=>{if(!It(o))return;const{isMatch:l,score:c,indices:d}=r.searchIn(o);l&&i.push({score:c,key:t,value:o,idx:s,norm:a,indices:d})});else{const{v:o,n:s}=e,{isMatch:a,score:l,indices:c}=r.searchIn(o);a&&i.push({score:l,key:t,value:o,norm:s,indices:c})}return i}}gr.version="6.6.2";gr.createIndex=zd;gr.parseIndex=Cg;gr.config=D;gr.parseQuery=Vd;Bg(zg);const Ug=`.select__input::-moz-placeholder{color:#98959f;font-weight:400}.select__input::placeholder{color:#98959f;font-weight:400}:host{--popover-initial-transform: translate(0, -6px);--popover-max-height: 250px}:host([size=large]){--tag-height: 27px;--tag-padding: 11px;--tag-font-size: 13px;--tag-gap: 8px}:host([size=x-large]){--tag-height: 31px;--tag-padding: 14px;--tag-font-size: 14px;--tag-gap: 8px}.option-list{display:flex;flex-direction:column;grid-gap:8px;gap:8px;grid-gap:var(--select-option-gap, 8px);gap:var(--select-option-gap, 8px)}.select{display:flex;box-sizing:border-box;flex:1 1;align-items:center;height:100%;min-height:38px;min-height:calc(var(--input-height, 40px) - 2px);padding:9px 0 9px 12px;padding:9px 0 9px var(--input-padding-left, 12px);padding-right:calc(var(--input-padding-left) + var(--caret-gap) + var(--caret-size) * .75);overflow:hidden;cursor:pointer;grid-gap:10px;gap:10px;grid-gap:var(--select-gap, 10px);gap:var(--select-gap, 10px)}.select:after{content:"";position:absolute;top:50%;right:12px;right:var(--input-padding-left, 12px);width:var(--caret-size);height:var(--caret-size);transform:translateY(-50%);background-image:url(/images/caret-down-small.svg);background-repeat:no-repeat;background-size:var(--caret-size)}.select--hide-arrow{--caret-size: 0px;--caret-gap: 0px}.select--active:after{transform:translateY(-50%) rotate(180deg)}.select__value-container{display:flex;flex:1 1;grid-gap:8px;gap:8px;flex-wrap:wrap}.select__tags{display:contents}.select__tag{display:inline-flex;align-items:center;height:20px;height:var(--tag-height, 20px);padding:0 8px;padding:0 var(--tag-padding, 8px);border-radius:9999999px;background-color:#f3f3f6;background-color:var(--tag-bg-color, #f3f3f6);color:#3a3546;color:var(--tag-color, #3a3546);font-size:12px;font-size:var(--tag-font-size, 12px);font-weight:400;line-height:1;white-space:nowrap;grid-gap:5px;gap:5px;grid-gap:var(--tag-gap, 5px);gap:var(--tag-gap, 5px)}.select__input{flex:1 1;flex-basis:100%;flex-basis:var(--display-input-width, 100%);min-width:0;max-width:100%;padding:0;overflow:hidden;border:none;outline:none!important;background:none;color:inherit;font:inherit;font-size:14px;font-size:var(--input-font-size, 14px);line-height:inherit;text-overflow:ellipsis;white-space:nowrap;cursor:inherit;-webkit-appearance:none;-moz-appearance:none;appearance:none}.select--searchable .select__input{cursor:text}.select__input:focus{outline:none}.select__clear-btn{display:grid;flex-shrink:0;width:16px;height:16px;margin:0;padding:0;border:none;border-radius:50%;background-color:#3a3546;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;place-items:center}.select__clear-btn:hover{background-color:#7b7194}@media (hover: hover){:host([clear-hover-only]:not(:focus-within):not(:hover)) .select__clear-btn{display:none}}.select__clear-btn svg{width:10px;height:10px;color:#fff}
`;function Kg(){this.__data__=[],this.size=0}var Gg=Kg;function Jg(n,t){return n===t||n!==n&&t!==t}var Hd=Jg,Yg=Hd;function Xg(n,t){for(var e=n.length;e--;)if(Yg(n[e][0],t))return e;return-1}var co=Xg,Zg=co,Qg=Array.prototype,tb=Qg.splice;function eb(n){var t=this.__data__,e=Zg(t,n);if(e<0)return!1;var r=t.length-1;return e==r?t.pop():tb.call(t,e,1),--this.size,!0}var nb=eb,rb=co;function ib(n){var t=this.__data__,e=rb(t,n);return e<0?void 0:t[e][1]}var ob=ib,sb=co;function ab(n){return sb(this.__data__,n)>-1}var lb=ab,cb=co;function db(n,t){var e=this.__data__,r=cb(e,n);return r<0?(++this.size,e.push([n,t])):e[r][1]=t,this}var hb=db,ub=Gg,pb=nb,fb=ob,mb=lb,gb=hb;function br(n){var t=-1,e=n==null?0:n.length;for(this.clear();++t<e;){var r=n[t];this.set(r[0],r[1])}}br.prototype.clear=ub;br.prototype.delete=pb;br.prototype.get=fb;br.prototype.has=mb;br.prototype.set=gb;var ho=br,bb=ho;function yb(){this.__data__=new bb,this.size=0}var vb=yb;function wb(n){var t=this.__data__,e=t.delete(n);return this.size=t.size,e}var xb=wb;function kb(n){return this.__data__.get(n)}var Sb=kb;function Cb(n){return this.__data__.has(n)}var Eb=Cb,Ob=ro,Mb=Qc,Tb="[object AsyncFunction]",Ab="[object Function]",_b="[object GeneratorFunction]",Db="[object Proxy]";function $b(n){if(!Mb(n))return!1;var t=Ob(n);return t==Ab||t==_b||t==Tb||t==Db}var Wd=$b,Nb=an,Ib=Nb["__core-js_shared__"],Pb=Ib,Fo=Pb,ml=function(){var n=/[^.]+$/.exec(Fo&&Fo.keys&&Fo.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function Rb(n){return!!ml&&ml in n}var Lb=Rb,zb=Function.prototype,Bb=zb.toString;function Fb(n){if(n!=null){try{return Bb.call(n)}catch{}try{return n+""}catch{}}return""}var qd=Fb,jb=Wd,Vb=Lb,Hb=Qc,Wb=qd,qb=/[\\^$.*+?()[\]{}|]/g,Ub=/^\[object .+?Constructor\]$/,Kb=Function.prototype,Gb=Object.prototype,Jb=Kb.toString,Yb=Gb.hasOwnProperty,Xb=RegExp("^"+Jb.call(Yb).replace(qb,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Zb(n){if(!Hb(n)||Vb(n))return!1;var t=jb(n)?Xb:Ub;return t.test(Wb(n))}var Qb=Zb;function ty(n,t){return n==null?void 0:n[t]}var ey=ty,ny=Qb,ry=ey;function iy(n,t){var e=ry(n,t);return ny(e)?e:void 0}var yr=iy,oy=yr,sy=an,ay=oy(sy,"Map"),ya=ay,ly=yr,cy=ly(Object,"create"),uo=cy,gl=uo;function dy(){this.__data__=gl?gl(null):{},this.size=0}var hy=dy;function uy(n){var t=this.has(n)&&delete this.__data__[n];return this.size-=t?1:0,t}var py=uy,fy=uo,my="__lodash_hash_undefined__",gy=Object.prototype,by=gy.hasOwnProperty;function yy(n){var t=this.__data__;if(fy){var e=t[n];return e===my?void 0:e}return by.call(t,n)?t[n]:void 0}var vy=yy,wy=uo,xy=Object.prototype,ky=xy.hasOwnProperty;function Sy(n){var t=this.__data__;return wy?t[n]!==void 0:ky.call(t,n)}var Cy=Sy,Ey=uo,Oy="__lodash_hash_undefined__";function My(n,t){var e=this.__data__;return this.size+=this.has(n)?0:1,e[n]=Ey&&t===void 0?Oy:t,this}var Ty=My,Ay=hy,_y=py,Dy=vy,$y=Cy,Ny=Ty;function vr(n){var t=-1,e=n==null?0:n.length;for(this.clear();++t<e;){var r=n[t];this.set(r[0],r[1])}}vr.prototype.clear=Ay;vr.prototype.delete=_y;vr.prototype.get=Dy;vr.prototype.has=$y;vr.prototype.set=Ny;var Iy=vr,bl=Iy,Py=ho,Ry=ya;function Ly(){this.size=0,this.__data__={hash:new bl,map:new(Ry||Py),string:new bl}}var zy=Ly;function By(n){var t=typeof n;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?n!=="__proto__":n===null}var Fy=By,jy=Fy;function Vy(n,t){var e=n.__data__;return jy(t)?e[typeof t=="string"?"string":"hash"]:e.map}var po=Vy,Hy=po;function Wy(n){var t=Hy(this,n).delete(n);return this.size-=t?1:0,t}var qy=Wy,Uy=po;function Ky(n){return Uy(this,n).get(n)}var Gy=Ky,Jy=po;function Yy(n){return Jy(this,n).has(n)}var Xy=Yy,Zy=po;function Qy(n,t){var e=Zy(this,n),r=e.size;return e.set(n,t),this.size+=e.size==r?0:1,this}var tv=Qy,ev=zy,nv=qy,rv=Gy,iv=Xy,ov=tv;function wr(n){var t=-1,e=n==null?0:n.length;for(this.clear();++t<e;){var r=n[t];this.set(r[0],r[1])}}wr.prototype.clear=ev;wr.prototype.delete=nv;wr.prototype.get=rv;wr.prototype.has=iv;wr.prototype.set=ov;var Ud=wr,sv=ho,av=ya,lv=Ud,cv=200;function dv(n,t){var e=this.__data__;if(e instanceof sv){var r=e.__data__;if(!av||r.length<cv-1)return r.push([n,t]),this.size=++e.size,this;e=this.__data__=new lv(r)}return e.set(n,t),this.size=e.size,this}var hv=dv,uv=ho,pv=vb,fv=xb,mv=Sb,gv=Eb,bv=hv;function xr(n){var t=this.__data__=new uv(n);this.size=t.size}xr.prototype.clear=pv;xr.prototype.delete=fv;xr.prototype.get=mv;xr.prototype.has=gv;xr.prototype.set=bv;var yv=xr,vv="__lodash_hash_undefined__";function wv(n){return this.__data__.set(n,vv),this}var xv=wv;function kv(n){return this.__data__.has(n)}var Sv=kv,Cv=Ud,Ev=xv,Ov=Sv;function Ni(n){var t=-1,e=n==null?0:n.length;for(this.__data__=new Cv;++t<e;)this.add(n[t])}Ni.prototype.add=Ni.prototype.push=Ev;Ni.prototype.has=Ov;var Mv=Ni;function Tv(n,t){for(var e=-1,r=n==null?0:n.length;++e<r;)if(t(n[e],e,n))return!0;return!1}var Av=Tv;function _v(n,t){return n.has(t)}var Dv=_v,$v=Mv,Nv=Av,Iv=Dv,Pv=1,Rv=2;function Lv(n,t,e,r,i,o){var s=e&Pv,a=n.length,l=t.length;if(a!=l&&!(s&&l>a))return!1;var c=o.get(n),d=o.get(t);if(c&&d)return c==t&&d==n;var h=-1,u=!0,p=e&Rv?new $v:void 0;for(o.set(n,t),o.set(t,n);++h<a;){var f=n[h],m=t[h];if(r)var g=s?r(m,f,h,t,n,o):r(f,m,h,n,t,o);if(g!==void 0){if(g)continue;u=!1;break}if(p){if(!Nv(t,function(y,w){if(!Iv(p,w)&&(f===y||i(f,y,e,r,o)))return p.push(w)})){u=!1;break}}else if(!(f===m||i(f,m,e,r,o))){u=!1;break}}return o.delete(n),o.delete(t),u}var Kd=Lv,zv=an,Bv=zv.Uint8Array,Fv=Bv;function jv(n){var t=-1,e=Array(n.size);return n.forEach(function(r,i){e[++t]=[i,r]}),e}var Vv=jv;function Hv(n){var t=-1,e=Array(n.size);return n.forEach(function(r){e[++t]=r}),e}var Wv=Hv,yl=np,vl=Fv,qv=Hd,Uv=Kd,Kv=Vv,Gv=Wv,Jv=1,Yv=2,Xv="[object Boolean]",Zv="[object Date]",Qv="[object Error]",t0="[object Map]",e0="[object Number]",n0="[object RegExp]",r0="[object Set]",i0="[object String]",o0="[object Symbol]",s0="[object ArrayBuffer]",a0="[object DataView]",wl=yl?yl.prototype:void 0,jo=wl?wl.valueOf:void 0;function l0(n,t,e,r,i,o,s){switch(e){case a0:if(n.byteLength!=t.byteLength||n.byteOffset!=t.byteOffset)return!1;n=n.buffer,t=t.buffer;case s0:return!(n.byteLength!=t.byteLength||!o(new vl(n),new vl(t)));case Xv:case Zv:case e0:return qv(+n,+t);case Qv:return n.name==t.name&&n.message==t.message;case n0:case i0:return n==t+"";case t0:var a=Kv;case r0:var l=r&Jv;if(a||(a=Gv),n.size!=t.size&&!l)return!1;var c=s.get(n);if(c)return c==t;r|=Yv,s.set(n,t);var d=Uv(a(n),a(t),r,i,o,s);return s.delete(n),d;case o0:if(jo)return jo.call(n)==jo.call(t)}return!1}var c0=l0;function d0(n,t){for(var e=-1,r=t.length,i=n.length;++e<r;)n[i+e]=t[e];return n}var h0=d0,u0=Array.isArray,va=u0,p0=h0,f0=va;function m0(n,t,e){var r=t(n);return f0(n)?r:p0(r,e(n))}var g0=m0;function b0(n,t){for(var e=-1,r=n==null?0:n.length,i=0,o=[];++e<r;){var s=n[e];t(s,e,n)&&(o[i++]=s)}return o}var y0=b0;function v0(){return[]}var w0=v0,x0=y0,k0=w0,S0=Object.prototype,C0=S0.propertyIsEnumerable,xl=Object.getOwnPropertySymbols,E0=xl?function(n){return n==null?[]:(n=Object(n),x0(xl(n),function(t){return C0.call(n,t)}))}:k0,O0=E0;function M0(n,t){for(var e=-1,r=Array(n);++e<n;)r[e]=t(e);return r}var T0=M0,A0=ro,_0=io,D0="[object Arguments]";function $0(n){return _0(n)&&A0(n)==D0}var N0=$0,kl=N0,I0=io,Gd=Object.prototype,P0=Gd.hasOwnProperty,R0=Gd.propertyIsEnumerable,L0=kl(function(){return arguments}())?kl:function(n){return I0(n)&&P0.call(n,"callee")&&!R0.call(n,"callee")},z0=L0,Ii={exports:{}};function B0(){return!1}var F0=B0;Ii.exports;(function(n,t){var e=an,r=F0,i=t&&!t.nodeType&&t,o=i&&!0&&n&&!n.nodeType&&n,s=o&&o.exports===i,a=s?e.Buffer:void 0,l=a?a.isBuffer:void 0,c=l||r;n.exports=c})(Ii,Ii.exports);var Jd=Ii.exports,j0=9007199254740991,V0=/^(?:0|[1-9]\d*)$/;function H0(n,t){var e=typeof n;return t=t??j0,!!t&&(e=="number"||e!="symbol"&&V0.test(n))&&n>-1&&n%1==0&&n<t}var W0=H0,q0=9007199254740991;function U0(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=q0}var Yd=U0,K0=ro,G0=Yd,J0=io,Y0="[object Arguments]",X0="[object Array]",Z0="[object Boolean]",Q0="[object Date]",t1="[object Error]",e1="[object Function]",n1="[object Map]",r1="[object Number]",i1="[object Object]",o1="[object RegExp]",s1="[object Set]",a1="[object String]",l1="[object WeakMap]",c1="[object ArrayBuffer]",d1="[object DataView]",h1="[object Float32Array]",u1="[object Float64Array]",p1="[object Int8Array]",f1="[object Int16Array]",m1="[object Int32Array]",g1="[object Uint8Array]",b1="[object Uint8ClampedArray]",y1="[object Uint16Array]",v1="[object Uint32Array]",K={};K[h1]=K[u1]=K[p1]=K[f1]=K[m1]=K[g1]=K[b1]=K[y1]=K[v1]=!0;K[Y0]=K[X0]=K[c1]=K[Z0]=K[d1]=K[Q0]=K[t1]=K[e1]=K[n1]=K[r1]=K[i1]=K[o1]=K[s1]=K[a1]=K[l1]=!1;function w1(n){return J0(n)&&G0(n.length)&&!!K[K0(n)]}var x1=w1;function k1(n){return function(t){return n(t)}}var S1=k1,Pi={exports:{}};Pi.exports;(function(n,t){var e=rp,r=t&&!t.nodeType&&t,i=r&&!0&&n&&!n.nodeType&&n,o=i&&i.exports===r,s=o&&e.process,a=function(){try{var l=i&&i.require&&i.require("util").types;return l||s&&s.binding&&s.binding("util")}catch{}}();n.exports=a})(Pi,Pi.exports);var C1=Pi.exports,E1=x1,O1=S1,Sl=C1,Cl=Sl&&Sl.isTypedArray,M1=Cl?O1(Cl):E1,Xd=M1,T1=T0,A1=z0,_1=va,D1=Jd,$1=W0,N1=Xd,I1=Object.prototype,P1=I1.hasOwnProperty;function R1(n,t){var e=_1(n),r=!e&&A1(n),i=!e&&!r&&D1(n),o=!e&&!r&&!i&&N1(n),s=e||r||i||o,a=s?T1(n.length,String):[],l=a.length;for(var c in n)(t||P1.call(n,c))&&!(s&&(c=="length"||i&&(c=="offset"||c=="parent")||o&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||$1(c,l)))&&a.push(c);return a}var L1=R1,z1=Object.prototype;function B1(n){var t=n&&n.constructor,e=typeof t=="function"&&t.prototype||z1;return n===e}var F1=B1;function j1(n,t){return function(e){return n(t(e))}}var V1=j1,H1=V1,W1=H1(Object.keys,Object),q1=W1,U1=F1,K1=q1,G1=Object.prototype,J1=G1.hasOwnProperty;function Y1(n){if(!U1(n))return K1(n);var t=[];for(var e in Object(n))J1.call(n,e)&&e!="constructor"&&t.push(e);return t}var X1=Y1,Z1=Wd,Q1=Yd;function tw(n){return n!=null&&Q1(n.length)&&!Z1(n)}var ew=tw,nw=L1,rw=X1,iw=ew;function ow(n){return iw(n)?nw(n):rw(n)}var sw=ow,aw=g0,lw=O0,cw=sw;function dw(n){return aw(n,cw,lw)}var hw=dw,El=hw,uw=1,pw=Object.prototype,fw=pw.hasOwnProperty;function mw(n,t,e,r,i,o){var s=e&uw,a=El(n),l=a.length,c=El(t),d=c.length;if(l!=d&&!s)return!1;for(var h=l;h--;){var u=a[h];if(!(s?u in t:fw.call(t,u)))return!1}var p=o.get(n),f=o.get(t);if(p&&f)return p==t&&f==n;var m=!0;o.set(n,t),o.set(t,n);for(var g=s;++h<l;){u=a[h];var y=n[u],w=t[u];if(r)var k=s?r(w,y,u,t,n,o):r(y,w,u,n,t,o);if(!(k===void 0?y===w||i(y,w,e,r,o):k)){m=!1;break}g||(g=u=="constructor")}if(m&&!g){var M=n.constructor,T=t.constructor;M!=T&&"constructor"in n&&"constructor"in t&&!(typeof M=="function"&&M instanceof M&&typeof T=="function"&&T instanceof T)&&(m=!1)}return o.delete(n),o.delete(t),m}var gw=mw,bw=yr,yw=an,vw=bw(yw,"DataView"),ww=vw,xw=yr,kw=an,Sw=xw(kw,"Promise"),Cw=Sw,Ew=yr,Ow=an,Mw=Ew(Ow,"Set"),Tw=Mw,Aw=yr,_w=an,Dw=Aw(_w,"WeakMap"),$w=Dw,Os=ww,Ms=ya,Ts=Cw,As=Tw,_s=$w,Zd=ro,kr=qd,Ol="[object Map]",Nw="[object Object]",Ml="[object Promise]",Tl="[object Set]",Al="[object WeakMap]",_l="[object DataView]",Iw=kr(Os),Pw=kr(Ms),Rw=kr(Ts),Lw=kr(As),zw=kr(_s),mn=Zd;(Os&&mn(new Os(new ArrayBuffer(1)))!=_l||Ms&&mn(new Ms)!=Ol||Ts&&mn(Ts.resolve())!=Ml||As&&mn(new As)!=Tl||_s&&mn(new _s)!=Al)&&(mn=function(n){var t=Zd(n),e=t==Nw?n.constructor:void 0,r=e?kr(e):"";if(r)switch(r){case Iw:return _l;case Pw:return Ol;case Rw:return Ml;case Lw:return Tl;case zw:return Al}return t});var Bw=mn,Vo=yv,Fw=Kd,jw=c0,Vw=gw,Dl=Bw,$l=va,Nl=Jd,Hw=Xd,Ww=1,Il="[object Arguments]",Pl="[object Array]",mi="[object Object]",qw=Object.prototype,Rl=qw.hasOwnProperty;function Uw(n,t,e,r,i,o){var s=$l(n),a=$l(t),l=s?Pl:Dl(n),c=a?Pl:Dl(t);l=l==Il?mi:l,c=c==Il?mi:c;var d=l==mi,h=c==mi,u=l==c;if(u&&Nl(n)){if(!Nl(t))return!1;s=!0,d=!1}if(u&&!d)return o||(o=new Vo),s||Hw(n)?Fw(n,t,e,r,i,o):jw(n,t,l,e,r,i,o);if(!(e&Ww)){var p=d&&Rl.call(n,"__wrapped__"),f=h&&Rl.call(t,"__wrapped__");if(p||f){var m=p?n.value():n,g=f?t.value():t;return o||(o=new Vo),i(m,g,e,r,o)}}return u?(o||(o=new Vo),Vw(n,t,e,r,i,o)):!1}var Kw=Uw,Gw=Kw,Ll=io;function Qd(n,t,e,r,i){return n===t?!0:n==null||t==null||!Ll(n)&&!Ll(t)?n!==n&&t!==t:Gw(n,t,e,r,Qd,i)}var Jw=Qd,Yw=Jw;function Xw(n,t){return Yw(n,t)}var Zw=Xw;const Qw=ep(Zw);var tx=Object.defineProperty,ex=Object.getOwnPropertyDescriptor,tt=(n,t,e,r)=>{for(var i=r>1?void 0:r?ex(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&tx(t,e,i),i};let Y=class extends G{constructor(){super(...arguments),this.form=this.closest("form"),this.fuse=null,this.isMounted=!1,this.selectedCount=0,this.maxSearchWeight=1,this.isActive=!1,this.name="",this.value="",this.placeholder="",this.multiple=!1,this.clearable=!1,this.clearHoverOnly=!1,this.searchable=!1,this.openOnSearchOnly=!1,this.creatable=!1,this.disabled=!1,this.size="small",this.placement="bottom-end",this.strategy="absolute",this.displayLabel="",this.selectedOptions=[]}connectedCallback(){super.connectedCallback(),this.form&&this.name&&this.form.addEventListener("formdata",({formData:n})=>{Array.isArray(this.value)?this.value.forEach(t=>{n.append(this.name,t.toString())}):n.append(this.name,this.value.toString())}),document.addEventListener("click",n=>{const t=n.composedPath();this&&!t.includes(this)&&this.close()}),document.addEventListener("focusin",n=>{const t=n.composedPath();this&&!t.includes(this)&&this.close()}),document.addEventListener("keyup",n=>{n.key==="Escape"&&this.isActive&&(n.preventDefault(),n.stopPropagation(),this.close())}),document.addEventListener("keydown",n=>{var e,r;const t=n.composedPath();if(!(this&&!t.includes(this))){if(n.key==="ArrowDown"||n.key==="ArrowUp"){if(!this.isActive)return;n.stopPropagation(),n.preventDefault();const i=this.getAllSelectableOptions(),o=i.indexOf(this.currentOption),s=n.key==="ArrowDown"?1:-1;let a=o+s;a>=i.length?a=0:a<0&&(a=i.length-1),this.setCurrentOption(i[a]),(e=this.currentOption)==null||e.scrollIntoView({block:"nearest"})}if(n.key==="Enter"||n.key===" "&&(!this.searchable||this.searchable&&!this.displayInput.value)){if(n.preventDefault(),n.stopImmediatePropagation(),!this.isActive){this.open();return}if(!this.currentOption||this.currentOption.disabled)return;this.multiple?this.toggleOptionSelection(this.currentOption):this.setSelectedOptions(this.currentOption)}if(n.key==="Backspace"){if(!this.multiple||!this.selectedOptions.length||this.displayInput.value||((r=this.shadowRoot)==null?void 0:r.activeElement)!==this.displayInput)return;n.preventDefault(),n.stopImmediatePropagation(),this.toggleOptionSelection(this.selectedOptions[this.selectedOptions.length-1],!1)}}})}handleSelectMouseDown(n){const t=n.composedPath(),e=t.some(i=>i instanceof Element&&i.tagName.toLowerCase()==="button"),r=this.searchable&&t.some(i=>i===this.displayInput);if(!(this.disabled||e)){if(r){this.isActive||this.open();return}this.isActive?this.close():(n.preventDefault(),this.open())}}getAllOptions(){return Array.from(this.querySelectorAll("drb-option"))}getAllSearchableOptions(){return Array.from(this.querySelectorAll("drb-option:not([user-created]):not([creatable-placeholder])"))}getAllSelectableOptions(n=!0){const t=Array.from(this.querySelectorAll("drb-option:not([hidden]):not([disabled]):not([user-created])"));return n?t.sort((e,r)=>e.listOrder-r.listOrder):t}setCurrentOption(n){this.getAllOptions().forEach(e=>{e.current=!1}),n&&(n.current=!0),this.currentOption=n}getNextSelectedOrder(){return this.selectedCount++}setSelectedOptions(n){const t=this.getAllOptions(),e=Array.isArray(n)?n:[n];t.forEach(r=>r.selected=!1),e.length&&e.forEach(r=>{r.selected=!0,r.selectedOrder=this.getNextSelectedOrder()}),this.selectionChanged()}toggleOptionSelection(n,t){t===!0||t===!1?n.selected=t:n.selected=!n.selected,n.selectedOrder=this.getNextSelectedOrder(),this.selectionChanged()}selectionChanged(){const n=this.getAllOptions();if(this.selectedOptions=n.filter(t=>t.selected).sort((t,e)=>t.selectedOrder-e.selectedOrder),this.multiple)this.value=this.selectedOptions.map(t=>t.value),this.searchable&&(this.displayInput.value&&this.filterOptions(""),this.displayInput.value="",this.isActive&&this.displayInput.focus({preventScroll:!0}),this.openOnSearchOnly&&this.close());else{const t=this.selectedOptions[0];this.value=(t==null?void 0:t.value)??"",this.displayLabel=(t==null?void 0:t.label)??"",this.displayInput.value=this.displayLabel,this.close()}this.updateDisplayInputSize()}handleOptionClick(n){const e=n.target.closest("drb-option");n.preventDefault(),!(!e||e.disabled)&&(this.multiple?this.toggleOptionSelection(e):this.setSelectedOptions(e))}handleOptionMouseOver(n){const e=n.target.closest("drb-option");!e||e.disabled||this.setCurrentOption(e)}handleDisplayInput(n){if(this.searchable){if(n.preventDefault(),n.stopPropagation(),this.updateDisplayInputSize(),this.openOnSearchOnly&&!this.displayInput.value){this.close();return}this.open(),this.filterOptions(this.displayInput.value)}}handleDefaultSlotChange(){this.updateSelectedOptions(),this.updateFuzzySearchIndex()}buildOption(n,t){const e=document.createElement("drb-option");return e.value=n,e.label=t,e.innerHTML=t,e}initUserCreatedOptions(){const n=this.getAllOptions();if((Array.isArray(this.value)?this.value:[this.value]).forEach(e=>{if(e&&!n.some(r=>r.value===e)){const r=this.buildOption(e,e);r.selected=!0,r.setAttribute("user-created",""),this.appendChild(r)}}),this.creatable){const e=this.buildOption("","");e.setAttribute("creatable-placeholder",""),e.setAttribute("hidden",""),this.appendChild(e)}}updateSelectedOptions(){const n=this.querySelector("drb-option[creatable-placeholder]");if(n!=null&&n.selected){const i=this.buildOption(n.value,n.value);i.selected=!0,i.selectedOrder=this.getNextSelectedOrder(),i.setAttribute("user-created",""),this.appendChild(i),n.selected=!1,n.value=""}const t=[],e=this.getAllOptions(),r=Array.isArray(this.value)?this.value:[this.value];e.forEach(i=>{i.hasAttribute("user-created")&&!r.includes(i.value)?i.remove():i.value&&r.includes(i.value)&&t.push(i)}),this.setSelectedOptions(t.sort((i,o)=>i.selectedOrder-o.selectedOrder))}updateFuzzySearchIndex(){const n=this.getAllSearchableOptions();this.maxSearchWeight=Math.max(...n.map(t=>t.searchWeight)),this.fuse=new gr(n,{keys:["label",{name:"optionGroupLabel",weight:.4}],threshold:.2,includeScore:!0})}filterOptions(n){this.fuse||this.updateFuzzySearchIndex();const t=this.getAllOptions(),e=this.querySelector("drb-option[creatable-placeholder]");if(n){const r=this.fuse.search(n);r.sort((s,a)=>(s.score-=s.item.searchWeight/this.maxSearchWeight*.15,a.score-=a.item.searchWeight/this.maxSearchWeight*.15,s.score-a.score));const i=r.map(s=>s.item);e&&!t.some(s=>s!==e&&s.value===n)&&(e.label=n,e.value=n,e.innerHTML=`<span class="font-weight-600">Create "${n}"</span>`,e.removeAttribute("hidden"),i.push(e)),Array.from(this.querySelectorAll("drb-option-group")).forEach(s=>{s.listOrder=1/0,s.setAttribute("hidden","")}),t.forEach(s=>{const a=i.indexOf(s),l=a!==-1;s.toggleAttribute("hidden",!l),s.listOrder=l?a+1:0,s.optionGroup&&l&&(s.optionGroup.listOrder=Math.min(s.listOrder,s.optionGroup.listOrder),s.optionGroup.removeAttribute("hidden"))}),this.setCurrentOption(i[0])}else t.forEach(r=>{r.removeAttribute("hidden"),r.listOrder=0,r.optionGroup&&(r.optionGroup.listOrder=0,r.optionGroup.removeAttribute("hidden"))}),e==null||e.toggleAttribute("hidden",!0),this.setCurrentOption(t[0]);setTimeout(()=>{var r;(r=this.drbPopover)==null||r.scrollContainerTo({top:0})},0)}updateDisplayInputSize(){if(!this.displayInput)return;const n=this.value.length?`${this.displayInput.value.length}ch`:"100%";this.displayInput.style.setProperty("--display-input-width",n)}async firstUpdated(){this.updateDisplayInputSize(),this.initUserCreatedOptions(),this.updateSelectedOptions(),await this.updateComplete,this.isMounted=!0}updated(n){if(this.isMounted&&n.has("value")){if(!!Qw(n.get("value"),this.value))return;this.updateSelectedOptions(),this.dispatchEvent(new CustomEvent("change",{bubbles:!0,composed:!0})),this.dispatchEvent(new CustomEvent("input",{bubbles:!0,composed:!0}))}}close(){this.isActive=!1,this.displayInput.value=this.displayLabel}open(){this.isActive||this.disabled||(this.displayInput.focus({preventScroll:!0}),!(this.openOnSearchOnly&&!this.displayInput.value)&&(this.filterOptions(""),this.setCurrentOption(this.selectedOptions.find(n=>!n.hasAttribute("user-created"))||this.getAllSelectableOptions()[0]),this.isActive=!0,setTimeout(()=>{var n;(n=this.currentOption)==null||n.scrollIntoView({block:"nearest"})},0)))}get tags(){return this.selectedOptions.map((n,t)=>z`
        <div class="select__tag">
          ${n.label}

          <button
            class="select__clear-btn"
            type="button"
            tabindex="-1"
            @click=${()=>this.toggleOptionSelection(n,!1)}
          >
            ${xt(hs)}
          </button>
        </div>
      `)}render(){const n=this.clearable&&!this.disabled&&this.value.length>0;return z`
      <drb-popover
        active="${this.isActive||ot}"
        strategy="${this.strategy}"
        distance="8"
        placement="${this.placement}"
        sync="width"
        @mouseover="${this.handleOptionMouseOver}"
      >
        <div
          class=${kt({select:!0,"select--active":this.isActive,"select--disabled":this.disabled,"select--multiple":this.multiple,"select--searchable":this.searchable,"select--hide-arrow":this.openOnSearchOnly})}
          @mousedown=${this.handleSelectMouseDown}
        >
          <slot part="prefix" name="prefix" class="select__prefix"></slot>

          <div class="select__value-container">
            ${this.multiple&&this.selectedOptions.length?z`<div class="select__tags">${this.tags}</div>`:""}

            <input
              class="select__input"
              data-display-input
              type="text"
              autocomplete="off"
              placeholder=${this.value.length?"":this.placeholder}
              autocorrect="off"
              spellcheck="false"
              ?readonly=${!this.searchable||this.disabled}
              .value=${this.displayLabel}
              tabindex="${this.disabled?"-1":"0"}"
              size="1"
              @focus="${()=>{this.searchable&&this.open(),this.displayInput.setSelectionRange(this.displayInput.value.length,this.displayInput.value.length)}}"
              @input="${this.handleDisplayInput}"
            />
          </div>

          ${n?z`
                <button
                  class="select__clear-btn"
                  type="button"
                  aria-label="Clear"
                  tabindex="-1"
                  @click=${()=>this.setSelectedOptions([])}
                >
                  ${xt(hs)}
                </button>
              `:""}
        </div>

        <div
          class="option-list"
          slot="popover-content"
          @mousedown="${this.handleOptionClick}"
          @slotchange=${this.handleDefaultSlotChange}
        >
          <slot></slot>
        </div>
      </drb-popover>
    `}};Y.styles=Z(Ug);tt([ct("[data-display-input]")],Y.prototype,"displayInput",2);tt([ct("drb-popover")],Y.prototype,"drbPopover",2);tt([b({attribute:"active",reflect:!0})],Y.prototype,"isActive",2);tt([b()],Y.prototype,"name",2);tt([b({converter:{fromAttribute:n=>n.split("|"),toAttribute:n=>n.join("|")}})],Y.prototype,"value",2);tt([b({type:String})],Y.prototype,"placeholder",2);tt([b({type:Boolean})],Y.prototype,"multiple",2);tt([b({type:Boolean})],Y.prototype,"clearable",2);tt([b({attribute:"clear-hover-only",type:Boolean})],Y.prototype,"clearHoverOnly",2);tt([b({type:Boolean})],Y.prototype,"searchable",2);tt([b({attribute:"open-on-search-only",type:Boolean})],Y.prototype,"openOnSearchOnly",2);tt([b({type:Boolean})],Y.prototype,"creatable",2);tt([b({type:Boolean})],Y.prototype,"disabled",2);tt([b({reflect:!0})],Y.prototype,"size",2);tt([b({attribute:"placement",type:String})],Y.prototype,"placement",2);tt([b({type:String})],Y.prototype,"strategy",2);tt([F()],Y.prototype,"displayLabel",2);tt([F()],Y.prototype,"currentOption",2);tt([F()],Y.prototype,"selectedOptions",2);Y=tt([J("drb-select")],Y);const nx=`:host{display:contents}
`;var rx=Object.defineProperty,ix=Object.getOwnPropertyDescriptor,dn=(n,t,e,r)=>{for(var i=r>1?void 0:r?ix(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&rx(t,e,i),i};let xe=class extends G{constructor(){super(...arguments),this.cookieName="drb-toast-dismissed",this.title="",this.variant="primary",this.onlyOnce=!1,this.hideClose=!1}firstUpdated(){if(this.onlyOnce&&this._getDismissedToastIds().includes(this.id))return;const n=this._getNodesHtml(this._messageHtmlNodes),t=this._getNodesHtml(this._iconHtmlNodes);this._createAlert(n,t)}_getNodesHtml(n){return n.map(t=>t.innerHTML).join("")||""}_createAlert(n,t){const e=this.title?`<div class="drb-toast__title">${this.title}</div>`:"",r=Object.assign(document.createElement("sl-alert"),{id:this.id,closable:!this.hideClose,duration:this.duration,variant:this.variant,innerHTML:`
        <div slot="icon">${t}</div>

        <div class="drb-toast drb-toast--${this.variant}">
          ${e}
          ${n}
        </div>
      `});return document.body.append(r),r.addEventListener("sl-after-hide",()=>{this.remove()}),r.addEventListener("sl-hide",()=>{this.onlyOnce&&this._setCookieOnDismiss()}),r.addEventListener("click",i=>{i.target.closest("[data-toast-close]")&&r.hide()}),r.toast()}_getDismissedToastIds(){return JSON.parse(Wa.get(this.cookieName)||"[]")}_setCookieOnDismiss(){const n=this._getDismissedToastIds();n.push(this.id),Wa.set(this.cookieName,JSON.stringify(n),{expires:180})}render(){return z`
      <slot name="icon"></slot>
      <slot name="message"></slot>
    `}};xe.styles=Z(nx);dn([td({slot:"icon",flatten:!0})],xe.prototype,"_iconHtmlNodes",2);dn([td({slot:"message",flatten:!0})],xe.prototype,"_messageHtmlNodes",2);dn([b({type:String})],xe.prototype,"title",2);dn([b({type:String})],xe.prototype,"variant",2);dn([b({attribute:"only-once",type:Boolean})],xe.prototype,"onlyOnce",2);dn([b({attribute:"hide-close",type:Boolean,reflect:!0})],xe.prototype,"hideClose",2);dn([b({type:Number})],xe.prototype,"duration",2);xe=dn([J("drb-toast")],xe);const ox=`.drb-emoji-picker{display:contents}.drb-emoji-picker__dialog{position:fixed;z-index:10;bottom:100px;left:50%;transform:translate(-50%);width:calc(100% - 40px)}@media (min-width: 450px){.drb-emoji-picker__dialog{transform:unset;width:unset;position:absolute;bottom:65px;left:-2px}}.drb-emoji-picker .hide{display:none}.drb-emoji-picker .show{display:flex}.drb-emoji-picker emoji-picker{width:100%;--border-size: 2px;--border-radius: 1rem;--border-color: #9890ac;--input-border-size: 2px;--input-border-color: #9890ac}
`;var sx=Object.defineProperty,ax=Object.getOwnPropertyDescriptor,wa=(n,t,e,r)=>{for(var i=r>1?void 0:r?ax(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&sx(t,e,i),i};let Wr=class extends G{constructor(){super(...arguments),this.isVisible=!1,this.handleOutsideClick=n=>{var i,o,s;const t=(o=(i=this.shadowRoot)==null?void 0:i.querySelector("slot"))==null?void 0:o.assignedElements({flatten:!0}),e=n.composedPath()[0];this.isVisible&&!((s=this.emojiPicker.shadowRoot)!=null&&s.contains(e))&&!t[0].contains(e)&&(this.isVisible=!1)},this.handleEscapeKey=n=>{n.key==="Escape"&&this.isVisible&&(this.isVisible=!1)}}toggleEmojiPicker(){this.isVisible=!this.isVisible}bindEmojiClick(){this.emojiPicker.addEventListener("emoji-click",n=>{this.dispatchEvent(new CustomEvent("drb-emoji-picker:selected",{bubbles:!0,composed:!0,detail:{emoji:n.detail.unicode}}))})}firstUpdated(){this.emojiPicker&&(this.bindEmojiClick(),document.addEventListener("mousedown",this.handleOutsideClick),document.addEventListener("keydown",this.handleEscapeKey))}render(){return z`
      <div class="drb-emoji-picker">
        <slot @click="${this.toggleEmojiPicker}"></slot>
        <div class="drb-emoji-picker__dialog ${this.isVisible?"show":"hide"}">
          <emoji-picker class="light"></emoji-picker>
        </div>
      </div>
    `}};Wr.styles=Z(ox);wa([b({type:Boolean})],Wr.prototype,"isVisible",2);wa([ct("emoji-picker")],Wr.prototype,"emojiPicker",2);Wr=wa([J("drb-emoji-picker")],Wr);const lx=`.green-dot{position:absolute;top:50%;left:50%;width:50%;transform:translateY(-50%) rotate(40deg);transform-origin:left;transition:.3s ease-in}@container (max-width: 32px){.green-dot{--avatar-dot-size: 6px}}.green-dot[hidden]{display:block!important;visibility:hidden;opacity:0}.green-dot[hidden]:after{transform:translate(50%,-50%) scale(.5)}.green-dot:after{content:"";display:block;position:absolute;top:50%;right:0;width:8px;width:var(--avatar-dot-size, 8px);height:8px;height:var(--avatar-dot-size, 8px);transform:translate(50%,-50%);transition:.3s cubic-bezier(.87,0,.13,1);border:2px solid #fff;border:var(--avatar-dot-border-size, 2px) solid #fff;border-radius:50%;background-color:#4cea95}
`;var cx=Object.defineProperty,dx=Object.getOwnPropertyDescriptor,fo=(n,t,e,r)=>{for(var i=r>1?void 0:r?dx(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&cx(t,e,i),i};let nt=class extends G{constructor(){super(...arguments),this.online=!1,this.initialized=!1}connectedCallback(){super.connectedCallback(),!(!this.userId||this.online)&&(nt.onlineUsers.has(this.userId)?this.online=!0:nt.pendingUserIds.add(this.userId),nt.intervalId||(nt.intervalId=setInterval(()=>{nt.fetchOnlineStatus()},1e3)))}firstUpdated(){sn(()=>{this.initialized=!0})}static async fetchOnlineStatus(){if(nt.pendingUserIds.size===0)return;const n=Array.from(nt.pendingUserIds);nt.pendingUserIds.clear();try{(await(await fetch("/users/active_sessions",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-Token":ip()},body:JSON.stringify({user_ids:n})})).json()).forEach(r=>nt.onlineUsers.add(r)),document.querySelectorAll("drb-avatar").forEach(r=>{nt.onlineUsers.has(r.userId)&&(r.online=!0)})}catch(t){console.error("Failed to fetch online status:",t)}}render(){return z`
      <slot></slot>
      <drb-tooltip
        ?hidden="${!this.online||!this.initialized}"
        content="Online"
        mouse-only
        flip
        placement="right"
        strategy="absolute"
      >
        <div class="green-dot" ?hidden="${!this.online||!this.initialized}"></div>
      </drb-tooltip>
    `}};nt.styles=Z(lx);nt.onlineUsers=new Set;nt.pendingUserIds=new Set;nt.intervalId=null;fo([b({attribute:"user-id",type:Number})],nt.prototype,"userId",2);fo([b({type:Boolean})],nt.prototype,"online",2);fo([F()],nt.prototype,"initialized",2);nt=fo([J("drb-avatar")],nt);let xa=!1;if(typeof window<"u"){const n={get passive(){xa=!0}};window.addEventListener("testPassive",null,n),window.removeEventListener("testPassive",null,n)}const Ri=typeof window<"u"&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||window.navigator.platform==="MacIntel"&&window.navigator.maxTouchPoints>1);let Ke=[],Tt=new Map,Li=!1,th=-1,Pr,_r,fe,Rr;const eh=n=>Ke.some(t=>!!(t.options.allowTouchMove&&t.options.allowTouchMove(n))),zi=n=>{const t=n||window.event;return eh(t.target)||t.touches.length>1?!0:(t.preventDefault&&t.preventDefault(),!1)},hx=n=>{if(Rr===void 0){const t=!!n&&n.reserveScrollBarGap===!0,e=window.innerWidth-document.documentElement.getBoundingClientRect().width;if(t&&e>0){const r=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right"),10);Rr=document.body.style.paddingRight,document.body.style.paddingRight=`${r+e}px`}}Pr===void 0&&(Pr=document.body.style.overflow,document.body.style.overflow="hidden")},ux=()=>{Rr!==void 0&&(document.body.style.paddingRight=Rr,Rr=void 0),Pr!==void 0&&(document.body.style.overflow=Pr,Pr=void 0)},px=()=>window.requestAnimationFrame(()=>{const n=document.documentElement,t=document.body;if(fe===void 0){_r={...n.style},fe={...t.style};const{scrollY:e,scrollX:r,innerHeight:i}=window;n.style.height="100%",n.style.overflow="hidden",t.style.position="fixed",t.style.top=`${-e}px`,t.style.left=`${-r}px`,t.style.width="100%",t.style.height="auto",t.style.overflow="hidden",setTimeout(()=>window.requestAnimationFrame(()=>{const o=i-window.innerHeight;o&&e>=i&&(t.style.top=-(e+o)+"px")}),300)}}),fx=()=>{if(fe!==void 0){const n=-parseInt(document.body.style.top,10),t=-parseInt(document.body.style.left,10),e=document.documentElement,r=document.body;e.style.height=(_r==null?void 0:_r.height)||"",e.style.overflow=(_r==null?void 0:_r.overflow)||"",r.style.position=fe.position||"",r.style.top=fe.top||"",r.style.left=fe.left||"",r.style.width=fe.width||"",r.style.height=fe.height||"",r.style.overflow=fe.overflow||"",window.scrollTo(t,n),fe=void 0}},mx=n=>n?n.scrollHeight-n.scrollTop<=n.clientHeight:!1,gx=(n,t)=>{const e=n.targetTouches[0].clientY-th;return eh(n.target)?!1:t&&t.scrollTop===0&&e>0||mx(t)&&e<0?zi(n):(n.stopPropagation(),!0)},bx=(n,t)=>{if(!n){console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.");return}if(Tt.set(n,Tt!=null&&Tt.get(n)?(Tt==null?void 0:Tt.get(n))+1:1),Ke.some(r=>r.targetElement===n))return;const e={targetElement:n,options:t||{}};Ke=[...Ke,e],Ri?px():hx(t),Ri&&(n.ontouchstart=r=>{r.targetTouches.length===1&&(th=r.targetTouches[0].clientY)},n.ontouchmove=r=>{r.targetTouches.length===1&&gx(r,n)},Li||(document.addEventListener("touchmove",zi,xa?{passive:!1}:void 0),Li=!0))},yx=n=>{if(!n){console.error("enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.");return}Tt.set(n,Tt!=null&&Tt.get(n)?(Tt==null?void 0:Tt.get(n))-1:0),(Tt==null?void 0:Tt.get(n))===0&&(Ke=Ke.filter(t=>t.targetElement!==n),Tt==null||Tt.delete(n)),Ri&&(n.ontouchstart=null,n.ontouchmove=null,Li&&Ke.length===0&&(document.removeEventListener("touchmove",zi,xa?{passive:!1}:void 0),Li=!1)),Ke.length===0&&(Ri?fx():ux())};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Lr=(n,t)=>{var r;const e=n._$AN;if(e===void 0)return!1;for(const i of e)(r=i._$AO)==null||r.call(i,t,!1),Lr(i,t);return!0},Bi=n=>{let t,e;do{if((t=n._$AM)===void 0)break;e=t._$AN,e.delete(n),n=t}while((e==null?void 0:e.size)===0)},nh=n=>{for(let t;t=n._$AM;n=t){let e=t._$AN;if(e===void 0)t._$AN=e=new Set;else if(e.has(n))break;e.add(n),xx(t)}};function vx(n){this._$AN!==void 0?(Bi(this),this._$AM=n,nh(this)):this._$AM=n}function wx(n,t=!1,e=0){const r=this._$AH,i=this._$AN;if(i!==void 0&&i.size!==0)if(t)if(Array.isArray(r))for(let o=e;o<r.length;o++)Lr(r[o],!1),Bi(r[o]);else r!=null&&(Lr(r,!1),Bi(r));else Lr(this,n)}const xx=n=>{n.type==Wu.CHILD&&(n._$AP??(n._$AP=wx),n._$AQ??(n._$AQ=vx))};class kx extends Hu{constructor(){super(...arguments),this._$AN=void 0}_$AT(t,e,r){super._$AT(t,e,r),nh(this),this.isConnected=t._$AU}_$AO(t,e=!0){var r,i;t!==this.isConnected&&(this.isConnected=t,t?(r=this.reconnected)==null||r.call(this):(i=this.disconnected)==null||i.call(this)),e&&(Lr(this,t),Bi(this))}setValue(t){if(Ju(this._$Ct))this._$Ct._$AI(t,this);else{const e=[...this._$Ct._$AH];e[this._$Ci]=t,this._$Ct._$AI(e,this,0)}}disconnected(){}reconnected(){}}/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Re=()=>new Sx;class Sx{}const Ho=new WeakMap,Le=qu(class extends kx{render(n){return ot}update(n,[t]){var r;const e=t!==this.Y;return e&&this.Y!==void 0&&this.rt(void 0),(e||this.lt!==this.ct)&&(this.Y=t,this.ht=(r=n.options)==null?void 0:r.host,this.rt(this.ct=n.element)),ot}rt(n){if(this.isConnected||(n=void 0),typeof this.Y=="function"){const t=this.ht??globalThis;let e=Ho.get(t);e===void 0&&(e=new WeakMap,Ho.set(t,e)),e.get(this.Y)!==void 0&&this.Y.call(this.ht,void 0),e.set(this.Y,n),n!==void 0&&this.Y.call(this.ht,n)}else this.Y.value=n}get lt(){var n,t;return typeof this.Y=="function"?(n=Ho.get(this.ht??globalThis))==null?void 0:n.get(this.Y):(t=this.Y)==null?void 0:t.value}disconnected(){this.lt===this.ct&&this.rt(void 0)}reconnected(){this.rt(this.ct)}}),Cx=`<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M17 7L7 17M7 7L17 17" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`,Ex=`:host{--dialog-exit-duration: .2s;display:contents;visibility:hidden;transition:visibility var(--dialog-exit-duration)}:host([open]){visibility:visible}:host([mounting]){visibility:hidden;transition:none}.dialog{display:grid;position:fixed;z-index:10005;z-index:var(--zi-dialog, 10005);top:0;right:0;bottom:0;left:0;width:100%;max-width:none;height:100%;max-height:none;margin:0;padding:0;overflow-y:scroll;transition:opacity var(--dialog-exit-duration) ease-in;border:none;opacity:0;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkqAcAAIUAgUW0RjgAAAAASUVORK5CYII=);font-family:Mona Sans,Helvetica Neue,Helvetica,Arial,sans-serif;white-space:normal;pointer-events:none;place-items:end center;overscroll-behavior:contain}@media (min-width: 500px){.dialog{place-items:center}.dialog--drawer{place-items:start end}}.dialog[open]{transition-duration:.3s;transition-timing-function:ease-out;opacity:1;pointer-events:all}.dialog::backdrop{opacity:0}.dialog__close{--close-padding: 8px;--close-offset-x: 11px;--close-offset-y: 12px;position:absolute;z-index:3;top:calc(var(--close-offset-y) - var(--close-padding));right:calc(var(--close-offset-x) - var(--close-padding));box-sizing:content-box;width:22px;height:22px;padding:var(--close-padding);transition:color .2s ease;border:none;background:none;color:#0d0c22;cursor:pointer}@media (min-width: 500px){.dialog__close{--close-offset-x: 22px;--close-offset-y: 22px}}.dialog__close:hover{color:#565564}.dialog__close svg{width:100%;height:100%}.dialog__wrapper{position:relative;box-sizing:border-box;width:100%;margin:24px 0 0;padding:32px 16px;padding:var(--dialog-padding, 32px 16px);transform:translateY(16px);transition:transform var(--dialog-exit-duration) cubic-bezier(.32,0,.59,.03);border-radius:16px 16px 0 0;border-radius:var(--dialog-radius, 16px 16px 0 0);background-color:#fff;background-color:var(--dialog-bg-color, #fff)}.dialog--fetching-remote .dialog__wrapper{height:600px;height:var(--dialog-remote-initial-height, 600px)}@media (min-width: 500px){.dialog__wrapper{max-width:min(100%,484px);max-width:min(100%,var(--dialog-max-width, 484px));margin:24px 0;padding:32px;padding:var(--dialog-padding, 32px);border-radius:16px;border-radius:var(--dialog-radius, 16px)}.dialog--drawer .dialog__wrapper{max-width:400px;max-width:var(--dialog-max-width, 400px);height:100%;margin:0;padding:48px 32px;padding:var(--dialog-padding, 48px 32px);transform:translate(16px);border-radius:0}}.dialog[open] .dialog__wrapper{transform:translate(0);transition-duration:.4s;transition-timing-function:cubic-bezier(.34,1.56,.64,1)}.dialog__loading{position:absolute;top:50%;left:50%;width:32px;height:32px;margin:auto;transform:translate(-50%,-50%);background-image:url(/images/processing.gif);background-size:contain}
`;var Ox=Object.defineProperty,Mx=Object.getOwnPropertyDescriptor,Yt=(n,t,e,r)=>{for(var i=r>1?void 0:r?Mx(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&Ox(t,e,i),i};let _t=class extends G{constructor(){super(...arguments),this._fetchAbortController=new AbortController,this.dialogRef=Re(),this.isMounting=!0,this.isOpen=!1,this.preventLightDismiss=!1,this.remoteUrl="",this.remoteShouldReload=!0,this.drawer=!1,this.returnValue="",this.isDraggingFromDialog=!1,this.isFetchingRemote=!1,this.hasRemoteError=!1}async firstUpdated(){await tp(this.dialogRef.value),this.isMounting=!1,this.isOpen&&this.open()}connectedCallback(){super.connectedCallback(),document.addEventListener("click",n=>{const t=n.target.closest("[data-dialog-open]");(t==null?void 0:t.getAttribute("data-dialog-open"))===this.id&&this.open()})}createRenderRoot(){const n=super.createRenderRoot();return n.addEventListener("click",t=>{const e=t.target.closest("[data-dialog-close]");e&&this.close(e.getAttribute("data-dialog-close"))}),n}open(){var t,e,r;this.remoteUrl&&(this.remoteShouldReload||!this.hasContent())&&this.fetchRemoteUrl(),(t=this.dialogRef.value)==null||t.showModal(),this.isOpen=!0,(r=(e=document.activeElement)==null?void 0:e.blur)==null||r.call(e),bx(this.dialogRef.value,{reserveScrollBarGap:!0}),this.dispatchEvent(new CustomEvent("drb-dialog-opened",{bubbles:!0,composed:!0}))}async fetchRemoteUrl(){this.isFetchingRemote&&(this._fetchAbortController.abort("fetch cancelled"),this._fetchAbortController=new AbortController),this.isFetchingRemote=!0,this.hasRemoteError=!1,this.clearContent();try{const n=await fetch(this.remoteUrl,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest"},signal:this._fetchAbortController.signal});if(!n.ok)throw new Error("Error fetching remote content");if(!this.isOpen)return;const t=await n.text();this.setContent(t)}catch(n){this.hasRemoteError=!0,console.error(n)}finally{this.isFetchingRemote=!1}}clearContent(){Array.from(this.children).forEach(n=>{n.hasAttribute("slot")||n.remove()})}hasContent(){return Array.from(this.children).some(n=>!n.hasAttribute("slot"))}setContent(n){this.clearContent(),this.insertAdjacentHTML("beforeend",n),this.dispatchEvent(new CustomEvent("drb-dialog-content-updated",{bubbles:!0,composed:!0}))}close(n){var t;(t=this.dialogRef.value)==null||t.close(n)}lightDismiss(n){var o;const t=n.composedPath(),e=n.detail===0,r=t.includes(this.dialogWrapper),i=t.some(s=>{var a;return(a=s.classList)==null?void 0:a.contains("pswp")});this.preventLightDismiss||this.isDraggingFromDialog||e||r||i||(o=this.dialogRef.value)==null||o.close("dismiss")}_onNativeDialogClose(){var n;this.returnValue=(n=this.dialogRef.value)==null?void 0:n.returnValue,this.isOpen=!1,yx(this.dialogRef.value),this.dispatchEvent(new CustomEvent("drb-dialog-closed",{bubbles:!0,composed:!0}))}render(){return z`
      <dialog
        ${Le(this.dialogRef)}
        class="dialog ${kt({"dialog--drawer":this.drawer,"dialog--fetching-remote":this.isFetchingRemote})}"
        @click="${this.lightDismiss}"
        @mouseup="${()=>{sn(()=>{this.isDraggingFromDialog=!1})}}"
        @close="${this._onNativeDialogClose}"
      >
        <div data-dialog-wrapper class="dialog__wrapper" @mousedown="${()=>{this.isDraggingFromDialog=!0}}">
          <button class="dialog__close" @click="${this.close}">
            ${xt(Cx)}
          </button>

          <slot name="remote-error" ?hidden=${!this.hasRemoteError}>
            Sorry, something went wrong.
          </slot>

          <slot name="remote-loading" ?hidden=${!this.isFetchingRemote}>
            <div class="dialog__loading"></div>
          </slot>

          <slot></slot>
        </div>

        <slot name="dialog-outer"></slot>
      </dialog>
    `}};_t.styles=Z(Ex);Yt([ct("[data-dialog-wrapper]")],_t.prototype,"dialogWrapper",2);Yt([b({attribute:"mounting",reflect:!0,type:Boolean})],_t.prototype,"isMounting",2);Yt([b({attribute:"open",reflect:!0,type:Boolean})],_t.prototype,"isOpen",2);Yt([b({attribute:"prevent-light-dismiss",type:Boolean})],_t.prototype,"preventLightDismiss",2);Yt([b({attribute:"remote-url",type:String})],_t.prototype,"remoteUrl",2);Yt([b({attribute:"remote-should-reload",type:Boolean})],_t.prototype,"remoteShouldReload",2);Yt([b({type:Boolean})],_t.prototype,"drawer",2);Yt([b({attribute:!1,type:String})],_t.prototype,"returnValue",2);Yt([F()],_t.prototype,"isDraggingFromDialog",2);Yt([F()],_t.prototype,"isFetchingRemote",2);Yt([F()],_t.prototype,"hasRemoteError",2);_t=Yt([J("drb-dialog")],_t);var Tx=Object.defineProperty,Ax=Object.getOwnPropertyDescriptor,rh=(n,t,e,r)=>{for(var i=r>1?void 0:r?Ax(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&Tx(t,e,i),i};let Ds=class extends G{constructor(){super(...arguments),this.expandableContentEl=this.querySelector('[slot="expandable-content"]'),this.initialized=!1,this.expanded=!1}connectedCallback(){super.connectedCallback(),this.expandableContentEl&&this.addEventListener("click",n=>{const t=n.target.closest("[data-toggle-expandable]");if(!t)return;const e=t==null?void 0:t.getAttribute("data-toggle-expandable"),r=e==="true"?!0:e==="false"?!1:void 0;this.toggle(r)})}toggle(n){this.expanded=n!==void 0?n:!this.expanded}updated(n){var t;if(n.has("expanded")){if(!this.initialized)return;this.expanded?Zu(this.expandableContentEl):Qu(this.expandableContentEl),(t=this.querySelector("[data-toggle-expandable]"))==null||t.setAttribute("aria-expanded",this.expanded.toString())}this.expandableContentEl.toggleAttribute("inert",!this.expanded)}firstUpdated(){sn(()=>{this.expanded?(this.expandableContentEl.style.height="auto",this.expandableContentEl.style.overflow="visible"):(this.expandableContentEl.style.height="0px",this.expandableContentEl.style.overflow="hidden"),this.initialized=!0})}render(){return Ut`
      <slot></slot>
      <slot name="expandable-content"></slot>
    `}};rh([b({type:Boolean,reflect:!0})],Ds.prototype,"expanded",2);Ds=rh([J("drb-expandable")],Ds);const ih=`:root{--btn-bg-color: #0d0c22;--btn-bg-color-hover: rgb(85.6, 84.9, 100.3);--btn-text-color: #fff;--btn-text-color-hover: #fff;--btn-border-color: var(--btn-bg-color);--btn-border-color-hover: var(--btn-bg-color-hover);--btn-height: 40px;--btn-padding: 20px;--btn-font-size: 13px;--btn-icon-size: 16px}.btn2{display:inline-flex;position:relative;box-sizing:border-box;flex-shrink:0;align-items:center;justify-content:center;overflow:hidden}.btn2,a.btn2{width:-moz-min-content;width:min-content;width:var(--btn-width, -moz-min-content);width:var(--btn-width, min-content);height:40px;height:var(--btn-height);padding:0 20px;padding:0 var(--btn-padding);transition:.15s cubic-bezier(.32,0,.59,.03);transition-property:color,background-color,border,border-radius;border:1.5px solid #0d0c22;border:var(--btn-border-width, 1.5px) solid var(--btn-border-color, var(--btn-bg-color));border-radius:9999999px;border-radius:var(--btn-border-radius, 9999999px);background-color:#0d0c22;background-color:var(--btn-bg-color);color:#fff;color:var(--btn-text-color);font-family:inherit;font-size:13px;font-size:var(--btn-font-size);font-weight:600;font-weight:var(--btn-font-weight, 600);font-feature-settings:"ss01";line-height:1;text-decoration:none;white-space:nowrap;cursor:pointer;grid-gap:8px;gap:8px;grid-gap:var(--btn-gap, 8px);gap:var(--btn-gap, 8px)}.btn2:before{content:"";visibility:hidden;visibility:var(--btn-loading-visibility, hidden);position:absolute;z-index:2;top:0;left:0;width:100%;height:100%;opacity:0;opacity:var(--btn-loading-opacity, 0);background-color:#0d0c22;background-color:var(--btn-bg-color);pointer-events:none}.btn2:after{content:"";display:flex;visibility:hidden;visibility:var(--btn-loading-visibility, hidden);position:absolute;z-index:2;top:calc(50% - 8px);top:calc(50% - var(--btn-icon-size) / 2);left:calc(50% - 8px);left:calc(50% - var(--btn-icon-size) / 2);box-sizing:border-box;width:16px;width:var(--btn-icon-size);height:16px;height:var(--btn-icon-size);animation:loading-spin-animation .35s infinite linear;border:1px solid #fff;border:1px solid var(--btn-text-color);border-radius:50%;border-top-color:transparent;border-right-color:transparent;opacity:0;opacity:var(--btn-loading-opacity, 0);pointer-events:none}.btn2 svg{width:var(--btn-icon-size);width:var(--btn-icon-width, var(--btn-icon-size));height:var(--btn-icon-size);height:var(--btn-icon-height, var(--btn-icon-size));transition:inherit;color:var(--btn-text-color);color:var(--btn-icon-color, var(--btn-text-color))}.btn2[disabled]{opacity:.6;cursor:not-allowed}@media (hover: hover){.btn2:hover:not([disabled]),.btn2:focus-visible:not([disabled]){border-color:#565564;border-color:var(--btn-border-color-hover, var(--btn-bg-color-hover));background-color:#565564;background-color:var(--btn-bg-color-hover, var(--btn-bg-color));color:#fff;color:var(--btn-text-color-hover, var(--btn-text-color))}.btn2:hover:not([disabled]) svg,.btn2:focus-visible:not([disabled]) svg{color:var(--btn-text-color-hover, var(--btn-text-color));color:var(--btn-icon-color-hover, var(--btn-text-color-hover, var(--btn-text-color)))}}.btn2--gray{--btn-bg-color: #f8f7f4;--btn-bg-color-hover: #f5f3f0;--btn-text-color: #0d0c22;--btn-text-color-hover: #0d0c22}.btn2--white{--btn-bg-color: #fff;--btn-bg-color-hover: #fff;--btn-text-color: #0d0c22;--btn-text-color-hover: rgb(109.8, 109.2, 122.4)}.btn2--pink{--btn-bg-color: #ea4c89;--btn-bg-color-hover: rgb(236.1, 93.9, 148.8);--btn-text-color: #fff;--btn-text-color-hover: #fff}.btn2--light-pink{--btn-bg-color: #fdf0fb;--btn-bg-color-hover: rgb(252.48, 236.4, 250.44);--btn-text-color: #ea64d9;--btn-text-color-hover: #ea64d9}.btn2--large{--btn-height: 56px;--btn-padding: 24px;--btn-font-size: 14px}.btn2--medium{--btn-height: 48px;--btn-padding: 24px;--btn-font-size: 14px}.btn2--x-small{--btn-height: 32px;--btn-padding: 16px;--btn-font-size: 12px;--btn-font-weight: 500}.btn2--full-width{--btn-width: 100%}.btn2--circle{--btn-width: var(--btn-height);--btn-padding: 0;--btn-border-radius: 50%}.btn2--hover-bordered{--btn-border-color: var(--btn-bg-color);--btn-border-color-hover: var(--btn-text-color);--btn-bg-color-hover: var(--btn-bg-color);--btn-text-color-hover: var(--btn-text-color)}.btn2--loading{--btn-loading-opacity: 1;--btn-loading-visibility: visible}.btn2--icon-expand-animation svg{transition:none;animation:icon-expand-animation 1.2s both cubic-bezier(.45,.05,.55,.95)}.btn2--primary-alt{--btn-bg-color: #ea4c89;--btn-bg-color-hover: rgb(236.1, 93.9, 148.8);--btn-text-color: #fff;--btn-text-color-hover: #fff;--btn-border-color: var(--btn-bg-color);--btn-border-color-hover: var(--btn-bg-color-hover)}.btn2--secondary{--btn-bg-color: #fff;--btn-bg-color-hover: #fff;--btn-text-color: #0d0c22;--btn-text-color-hover: rgb(109.8, 109.2, 122.4);--btn-border-color: var(--btn-text-color);--btn-border-color-hover: var(--btn-text-color-hover)}.btn2--secondary-alt{--btn-bg-color: #fff;--btn-bg-color-hover: #fff;--btn-text-color: #0d0c22;--btn-text-color-hover: rgb(109.8, 109.2, 122.4);--btn-border-color: var(--btn-bg-color);--btn-border-color-hover: var(--btn-bg-color-hover)}.btn2--tertiary{--btn-bg-color: #fff;--btn-bg-color-hover: #fff;--btn-text-color: #0d0c22;--btn-text-color-hover: rgb(109.8, 109.2, 122.4);--btn-border-color: rgb(230.8, 230.7, 232.9);--btn-border-color-hover: rgb(218.7, 218.55, 221.85);--btn-text-color-hover: var(--btn-text-color)}.btn2--tertiary-alt{--btn-bg-color: #f8f7f4;--btn-bg-color-hover: #f5f3f0;--btn-text-color: #0d0c22;--btn-text-color-hover: #0d0c22;--btn-border-color: var(--btn-bg-color);--btn-border-color-hover: var(--btn-bg-color-hover)}.btn2--danger{--btn-bg-color: #d32318;--btn-bg-color-hover: #ea554c;--btn-text-color: #fff;--btn-text-color-hover: #fff;--btn-border-color: var(--btn-bg-color);--btn-border-color-hover: var(--btn-bg-color-hover)}.btn2--highlighted{--btn-bg-color: #fdf0fb;--btn-bg-color-hover: rgb(252.48, 236.4, 250.44);--btn-text-color: #ea64d9;--btn-text-color-hover: #ea64d9;--btn-border-color: var(--btn-bg-color);--btn-border-color-hover: var(--btn-bg-color-hover)}.btn2--transparent{--btn-border-color: var(--btn-bg-color);--btn-border-color-hover: var(--btn-bg-color-hover);--btn-bg-color: transparent;--btn-bg-color-hover: transparent;--btn-text-color: var(--btn-text-color, #0d0c22);--btn-text-color-hover: var(--btn-text-color-hover, rgb(109.8, 109.2, 122.4))}@keyframes loading-spin-animation{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes icon-expand-animation{0%{transform:scale(0)}15%{transform:scale(1.6)}32%{transform:scale(.8)}50%{transform:scale(1);opacity:1}to{transform:scale(1);opacity:1}}
`,_x=`:host{--dialog-padding: 32px}.confirm{display:flex;grid-gap:10px;gap:10px;flex-direction:column}.confirm--centered{align-items:center;text-align:center}.confirm [hidden]{display:none!important}.confirm__header{display:flex;grid-gap:10px;gap:10px;flex-direction:column}.confirm__header--centered{align-items:center;text-align:center}.confirm__header--inline{flex-direction:row;align-items:center}.confirm__icon{width:72px;width:var(--confirm-icon-size, 72px);height:72px;height:var(--confirm-icon-size, 72px)}.confirm__icon path[data-rotate]{transform-origin:center;animation:rotate 18s linear infinite}.confirm__icon svg{width:100%;height:100%}.confirm__title{font-family:Mona Sans,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:20px;font-weight:700;line-height:normal}.confirm__message{font-family:Mona Sans,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:16px;font-weight:400;line-height:21px}.confirm__message a{color:#ea4c89;text-decoration:none}.confirm__underline{text-decoration:underline}.confirm__button-group{display:flex;align-items:center;justify-content:center;grid-gap:24px;gap:24px;width:100%;margin-top:18px}.confirm__button-group>*{flex:1 1}.confirm__button-group:has([hidden])>*{flex:initial;min-width:140px}.confirm__footer-html{color:#98959f;font-size:11px;text-align:center}.confirm__footer-html a{color:inherit;text-decoration:underline}@keyframes rotate{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`;var Dx=Object.defineProperty,$x=Object.getOwnPropertyDescriptor,gt=(n,t,e,r)=>{for(var i=r>1?void 0:r?$x(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&Dx(t,e,i),i};let it=class extends G{constructor(){super(...arguments),this.dialogRef=Re(),this.centered=!1,this.iconInline=!1,this.title="Are you sure?",this.confirmText="Confirm",this.confirmClass="btn2--primary",this.confirmHref="",this.confirmDownload="",this.onConfirm=n=>{},this.cancelText="Cancel",this.cancelClass="btn2--tertiary",this.cancelHref="",this.onCancel=n=>{},this.footerHtml="",this.actionCompleted=!1}connectedCallback(){super.connectedCallback(),this.addEventListener("drb-dialog-closed",()=>{this.actionCompleted||this._handleCancel(),setTimeout(()=>{this.remove()},500)})}firstUpdated(){sn(()=>{var n;(n=this.dialogRef.value)==null||n.open()})}close(){var n;(n=this.dialogRef.value)==null||n.close()}_handleCancel(){this.actionCompleted=!0,this.onCancel(this),this.close()}async _handleConfirm(){var r,i;const n=(r=this.dialogRef.value)==null?void 0:r.querySelector('[data-action="confirm"]'),t=(i=this.dialogRef.value)==null?void 0:i.querySelector('[data-action="cancel"]');n==null||n.classList.add("btn2--loading"),n==null||n.toggleAttribute("disabled",!0),t==null||t.toggleAttribute("disabled",!0);const e=await this.onConfirm(this);n==null||n.classList.remove("btn2--loading"),n==null||n.removeAttribute("disabled"),t==null||t.removeAttribute("disabled"),e!==!1&&(this.actionCompleted=!0,this.close())}setIconHtml(n){var e;const t=n.target.assignedNodes({flatten:!0});this.iconHtml=(e=t==null?void 0:t[0])==null?void 0:e.innerHTML}render(){const n=this.confirmHref?qe`a`:qe`button`,t=this.cancelHref?qe`a`:qe`button`;return Ut`
      <drb-dialog
        ${Le(this.dialogRef)}
        prevent-light-dismiss
      >
        <slot name="icon-html" @slotchange=${this.setIconHtml} hidden></slot>

        <div
          class="${kt({confirm:!0,"confirm--centered":this.centered})}"
        >
          <div
            class="${kt({confirm__header:!0,"confirm__header--centered":this.centered,"confirm__header--inline":this.iconInline})}"
          >
            <div class="confirm__icon" ?hidden=${!this.iconHtml}>
              ${xt(this.iconHtml)}
            </div>

            <div class="confirm__title">${this.title}</div>
          </div>

          <div class="confirm__message" ?hidden=${!this.message}>
            ${xt(this.message)}
          </div>

          <slot></slot>

          <div class="confirm__button-group">
            <${t}
              ?hidden=${!this.cancelText}
              href="${this.cancelHref||ot}"
              class="btn2 btn2--medium ${this.cancelClass}"
              @click="${this._handleCancel}"
              data-action="cancel"
            >
              ${this.cancelText}
            </${t}>

            <${n}
              ?hidden=${!this.confirmText}
              href="${this.confirmHref||ot}"
              download="${this.confirmDownload||ot}"
              class="btn2 btn2--medium ${this.confirmClass}"
              @click="${this._handleConfirm}"
              data-action="confirm"
            >
              ${this.confirmText}
            </${n}>
          </div>

          <div class="confirm__footer-html" ?hidden=${!this.footerHtml}>
            ${xt(this.footerHtml)}
          </div>
        </div>
      </drb-dialog>
    `}};it.styles=Z([_x,ih]);gt([b({type:Boolean})],it.prototype,"centered",2);gt([b({attribute:"icon-inline",type:Boolean})],it.prototype,"iconInline",2);gt([b({type:String})],it.prototype,"iconHtml",2);gt([b({type:String})],it.prototype,"title",2);gt([b({type:String})],it.prototype,"message",2);gt([b({attribute:"confirm-text",type:String})],it.prototype,"confirmText",2);gt([b({attribute:"confirm-class",type:String})],it.prototype,"confirmClass",2);gt([b({attribute:"confirm-href",type:String})],it.prototype,"confirmHref",2);gt([b({attribute:"confirm-download",type:String})],it.prototype,"confirmDownload",2);gt([b({type:Function})],it.prototype,"onConfirm",2);gt([b({attribute:"cancel-text",type:String})],it.prototype,"cancelText",2);gt([b({attribute:"cancel-class",type:String})],it.prototype,"cancelClass",2);gt([b({attribute:"cancel-href",type:String})],it.prototype,"cancelHref",2);gt([b({type:Function})],it.prototype,"onCancel",2);gt([b({type:String})],it.prototype,"footerHtml",2);gt([F()],it.prototype,"actionCompleted",2);it=gt([J("drb-confirm")],it);const zl=`<svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
<path d="M4.46923 1.15351C4.15219 0.837825 3.63818 0.837824 3.32115 1.15351C3.00412 1.4692 3.00412 1.98104 3.32115 2.29673L6.95661 5.91679L3.32124 9.53677C3.0042 9.85246 3.0042 10.3643 3.32124 10.68C3.63827 10.9957 4.15228 10.9957 4.46932 10.68L8.66691 6.50017C8.67092 6.49634 8.6749 6.49245 8.67885 6.48852C8.78288 6.38493 8.85277 6.26023 8.88853 6.12826C8.88941 6.12502 8.89026 6.12178 8.8911 6.11853C8.96019 5.85077 8.88947 5.55462 8.67894 5.34498C8.67373 5.33979 8.66846 5.33469 8.66315 5.32967L4.46923 1.15351Z"/>
</svg>
`,Nx=`.arrow-left,.arrow-right{display:grid;display:none;position:absolute;top:0;height:100%;margin:0;border:0;text-decoration:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;place-items:center}.arrow-left svg,.arrow-right svg{width:19px;width:var(--arrow-size, 19px);height:19px;height:var(--arrow-size, 19px)}.arrow-left{left:0;padding:0 20px 0 0;padding:0 var(--arrow-padding, 20px) 0 0;background:linear-gradient(to right,#fff 40%,rgba(255,255,255,0))}.arrow-left svg{transform:rotate(180deg)}.arrow-right{right:0;padding:0 0 0 20px;padding:0 0 0 var(--arrow-padding, 20px);background:linear-gradient(to left,#fff 40%,rgba(255,255,255,0))}
`;var Ix=Object.defineProperty,Px=Object.getOwnPropertyDescriptor,Rx=(n,t,e,r)=>{for(var i=r>1?void 0:r?Px(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&Ix(t,e,i),i};let $s=class extends G{constructor(){super(...arguments),this.overflowContainer=this.querySelector("[data-horizontal-overflow]"),this.leftArrowRef=Re(),this.rightArrowRef=Re()}firstUpdated(){var t,e;if(!this.overflowContainer)return;new ResizeObserver(()=>{this.updateArrowVisibility()}).observe(this.overflowContainer),this.overflowContainer.addEventListener("scroll",()=>{this.updateArrowVisibility()}),(t=this.leftArrowRef.value)==null||t.addEventListener("click",()=>{this.overflowContainer.scrollBy({left:-(this.overflowContainer.clientWidth*.8),behavior:"smooth"})}),(e=this.rightArrowRef.value)==null||e.addEventListener("click",()=>{this.overflowContainer.scrollBy({left:this.overflowContainer.clientWidth*.8,behavior:"smooth"})}),this.updateArrowVisibility()}updateArrowVisibility(){const n=this.leftArrowRef.value,t=this.rightArrowRef.value;if(this.overflowContainer.scrollWidth>this.overflowContainer.clientWidth){const r=this.overflowContainer.scrollLeft>0,i=this.overflowContainer.scrollLeft<this.overflowContainer.scrollWidth-this.overflowContainer.clientWidth;n.style.display=r?"block":"none",t.style.display=i?"block":"none"}else n.style.display="none",t.style.display="none"}render(){return Ut`
      <slot></slot>

      <button ${Le(this.leftArrowRef)} class="arrow-left">
        ${xt(zl)}
      </button>

      <button ${Le(this.rightArrowRef)} class="arrow-right">
        ${xt(zl)}
      </button>
    `}};$s.styles=Z(Nx);$s=Rx([J("drb-horizontal-overflow-arrows")],$s);const Lx=`:host{display:contents;position:relative}.loading{display:flex;align-items:center;justify-content:center;padding:8px;color:#3d3d4e;text-align:center;grid-gap:6px;gap:6px}.default-loader{width:16px;height:16px;animation:spin 1s linear infinite;border:4px solid #ea4c89;border-top:4px solid #fff;border-radius:50%}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`;var zx=Object.defineProperty,Bx=Object.getOwnPropertyDescriptor,Xt=(n,t,e,r)=>{for(var i=r>1?void 0:r?Bx(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&zx(t,e,i),i};let Dt=class extends G{constructor(){super(...arguments),this._fetchAbortController=new AbortController,this._sentinelElRef=Re(),this.disabled=!1,this.page=1,this.perPage=10,this.pageLimit=null,this.offset=500,this.resultsKey="",this.baseUrl=document.location.toString(),this.scrollContainerSelector="",this.resetting=!1,this.fetching=!1,this.hasMore=!0}connectedCallback(){super.connectedCallback()}_fetchNextPage(){this.page++,this._fetchPage(this.page)}async _fetchPage(n){const t=this._fetchAbortController.signal,e=this.baseUrl.startsWith("/")?new URL(window.location.origin+this.baseUrl):new URL(this.baseUrl);e.searchParams.set("page",n.toString()),e.searchParams.set("perPage",this.perPage.toString()),this.fetching=!0;try{const r=await fetch(e.toString(),{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest"},signal:this._fetchAbortController.signal});if(!r.ok&&r.status!==404)throw new Error("Something went wrong");const i=await r.json();if(this.dispatchEvent(new CustomEvent("drb-infinite-scroll-fetched",{detail:{status:r.status,data:i}})),r.status===404){this.hasMore=!1;return}this.hasMore=!0;const o=this.resultsKey?i[this.resultsKey]:i,a=new DOMParser().parseFromString(o,"text/html");this.resetting?this.insertAdjacentHTML("afterbegin",a.body.innerHTML):(Array.from(a.body.children).forEach(l=>{const c=l.getAttribute("data-id");c&&this.querySelector(`[data-id="${c}"]`)&&l.remove()}),this.insertAdjacentHTML("beforeend",a.body.innerHTML))}catch(r){this.resetting&&(this.hasMore=!1),console.error(r)}finally{if(t.aborted)return;this.resetting=!1,this.fetching=!1,this.dispatchEvent(new CustomEvent("drb-infinite-scroll-updated",{bubbles:!0,composed:!0}))}}clearResults(){Array.from(this.children).forEach(n=>{n.hasAttribute("slot")||n.remove()})}_emitItemSeenEvent(n){this.dispatchEvent(new CustomEvent("drb-infinite-scroll-item-seen",{detail:{element:n},bubbles:!0,composed:!0}))}_updateSentinelObserver(){var n,t;this.disabled||this.fetching||!this.hasMore||this.pageLimit&&this.page>=this.pageLimit?(n=this._sentinelObserver)==null||n.unobserve(this._sentinelElRef.value):(t=this._sentinelObserver)==null||t.observe(this._sentinelElRef.value)}firstUpdated(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>this.initializeObservers()):this.initializeObservers()}initializeObservers(){const n=this.scrollContainerSelector?document.querySelector(this.scrollContainerSelector):null;this._sentinelObserver=new IntersectionObserver(t=>{t.forEach(e=>{e.intersectionRatio>0&&this._fetchNextPage()})},{root:n,rootMargin:`${this.offset}px`}),this._listItemSeenObserver=new IntersectionObserver(t=>{t.forEach(e=>{e.isIntersecting&&this._emitItemSeenEvent(e.target)})},{root:n,threshold:.2})}updated(){this._updateSentinelObserver(),this.querySelectorAll(":scope > [data-id]").forEach(n=>{var t;(t=this._listItemSeenObserver)==null||t.observe(n)})}reset(n){this.baseUrl=n||this.baseUrl,this.page=0,this.fetching=!1,this.disabled=!1,this.resetting=!0,this._fetchAbortController.abort(),this._fetchAbortController=new AbortController,this.clearResults(),this._fetchNextPage(),sn(()=>{this.dispatchEvent(new CustomEvent("drb-infinite-scroll-resetting"))})}render(){const n=!this.hasMore&&this.page===1&&!this.fetching,t=!this.hasMore&&this.page!==1&&!this.fetching,e=this.resetting&&this.page==1&&this.fetching,r=this.fetching&&!this.resetting;return z`
      <slot></slot>

      <slot name="skeleton-loading" ?hidden=${!e}>
        <div align="center" part="skeleton-loading">Loading...</div>
      </slot>

      <slot name="no-results" ?hidden=${!n}>
        <div align="center" part="no-results">No results found</div>
      </slot>

      <slot name="no-more-results" ?hidden=${!t}>
        <div align="center" part="no-more-results">You've reached the end of the list</div>
      </slot>

      <slot name="loading" ?hidden=${!r}>
        <div class="loading" part="loading">
          <span class="default-loader"></span>
        </div>
      </slot>

      <div ${Le(this._sentinelElRef)}></div>
    `}};Dt.styles=Z(Lx);Xt([b({type:Boolean})],Dt.prototype,"disabled",2);Xt([b({type:Number})],Dt.prototype,"page",2);Xt([b({attribute:"per-page",type:Number})],Dt.prototype,"perPage",2);Xt([b({attribute:"page-limit",type:Number})],Dt.prototype,"pageLimit",2);Xt([b({type:Number})],Dt.prototype,"offset",2);Xt([b({attribute:"results-key",type:String})],Dt.prototype,"resultsKey",2);Xt([b({attribute:"base-url",type:String})],Dt.prototype,"baseUrl",2);Xt([b({attribute:"scroll-container-selector",type:String})],Dt.prototype,"scrollContainerSelector",2);Xt([b({type:Boolean,reflect:!0})],Dt.prototype,"resetting",2);Xt([F()],Dt.prototype,"fetching",2);Xt([F()],Dt.prototype,"hasMore",2);Dt=Xt([J("drb-infinite-scroll")],Dt);const Fx=`:host{display:inline-flex}.counter{color:#6e6d7a;color:var(--character-counter-color, rgb(109.8, 109.2, 122.4));font-family:IBM Plex Mono,Consolas,Liberation Mono,Menlo,Courier,monospace;font-family:var(--character-counter-font-family, "IBM Plex Mono", Consolas, "Liberation Mono", Menlo, Courier, monospace);font-size:10px;font-size:var(--character-counter-font-size, 10px);font-weight:400;line-height:1}.counter.warning{color:#f5ad05;color:var(--character-counter-warning-color, #f5ad05)}.counter.error{color:#f50505;color:var(--character-counter-error-color, #f50505)}
`;var jx=Object.defineProperty,Vx=Object.getOwnPropertyDescriptor,ri=(n,t,e,r)=>{for(var i=r>1?void 0:r?Vx(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&jx(t,e,i),i};let Dn=class extends G{constructor(){super(...arguments),this.max=80,this.inputErrorClass="error",this.currentLength=0,this.inputElement=null,this._updateCounter=()=>{var n,t,e;this.currentLength=((t=(n=this.inputElement)==null?void 0:n.value)==null?void 0:t.length)||0,(e=this.inputElement)==null||e.classList.toggle(this.inputErrorClass,this.currentLength>this.max)}}connectedCallback(){var n;super.connectedCallback(),this.inputElement=document.getElementById(this.getAttribute("for")),(n=this.inputElement)==null||n.addEventListener("input",this._updateCounter),this._updateCounter()}disconnectedCallback(){var n;super.disconnectedCallback(),(n=this.inputElement)==null||n.removeEventListener("input",this._updateCounter)}render(){const n={warning:this.currentLength>this.max*.8,error:this.currentLength>this.max};return z`
      <div class="counter ${kt(n)}">
        ${this.currentLength}/${this.max}
      </div>
    `}};Dn.styles=Z(Fx);ri([b({type:Number})],Dn.prototype,"max",2);ri([b({attribute:"input-error-class",type:String})],Dn.prototype,"inputErrorClass",2);ri([F()],Dn.prototype,"currentLength",2);ri([F()],Dn.prototype,"inputElement",2);Dn=ri([J("drb-character-counter")],Dn);const Hx=`:host{display:contents}.autocomplete-option{display:flex;position:relative;box-sizing:border-box;align-items:center;width:100%;width:var(--autocomplete-option-width, 100%);height:38px;height:var(--autocomplete-option-height, 38px);margin:0;padding:12px;padding:var(--autocomplete-option-padding, 12px);border:1px solid transparent;border:1px solid var(--autocomplete-option-border-color, transparent);border-radius:8px;border-radius:var(--autocomplete-option-radius, 8px);background-color:#fff;background-color:var(--autocomplete-option-bg-color, #fff);color:#3d3d4e;color:var(--autocomplete-option-color, rgb(61.4, 60.6, 78.2));font-size:14px;font-size:var(--autocomplete-option-font-size, 14px);font-weight:500;font-weight:var(--autocomplete-option-font-weight, 500);line-height:1.1;text-decoration:none;cursor:pointer}:host([highlighted]) .autocomplete-option{--autocomplete-option-bg-color: rgb(250.16, 250.14, 250.58);--autocomplete-option-border-color: rgb(242.9, 242.85, 243.95)}.autocomplete-option__text{width:100%;overflow:hidden;text-align:left;text-overflow:ellipsis;white-space:nowrap}
`;var Wx=Object.defineProperty,qx=Object.getOwnPropertyDescriptor,mo=(n,t,e,r)=>{for(var i=r>1?void 0:r?qx(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&Wx(t,e,i),i};let nr=class extends G{constructor(){var n;super(...arguments),this.value=((n=this.textContent)==null?void 0:n.trim())||"",this.unstyled=!1,this.highlighted=!1}connectedCallback(){super.connectedCallback(),this.addEventListener("click",()=>{this.dispatchEvent(new CustomEvent("drb-autocomplete-option:clicked",{bubbles:!0,composed:!0,detail:{value:this.value,target:this}}))}),this.addEventListener("mouseover",()=>{this.dispatchEvent(new CustomEvent("drb-autocomplete-option:hovered",{bubbles:!0,composed:!0,detail:{value:this.value,target:this}}))})}render(){return this.unstyled?Ut`<slot></slot>`:Ut`
        <div class="autocomplete-option">
          <span class="autocomplete-option__text">
            <slot></slot>
          </span>
        </div>
      `}};nr.styles=Z(Hx);mo([b()],nr.prototype,"value",2);mo([b({reflect:!0,type:Boolean})],nr.prototype,"unstyled",2);mo([b({reflect:!0,type:Boolean})],nr.prototype,"highlighted",2);nr=mo([J("drb-autocomplete-option")],nr);const Ux=`:host{--popover-initial-transform: translate(0, -6px);display:contents}
`;var Kx=Object.defineProperty,Gx=Object.getOwnPropertyDescriptor,Ln=(n,t,e,r)=>{for(var i=r>1?void 0:r?Gx(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&Kx(t,e,i),i};let ze=class extends G{constructor(){super(...arguments),this.typeAheadRef=Re(),this.knownValues=[],this.isActive=!1,this.queryPath="",this.queryKey="q",this.requireSelection=!1,this.placement="bottom-start",this.strategy="absolute"}connectedCallback(){var n;super.connectedCallback(),this.inputEl=this.querySelector("input"),this.knownValues=[((n=this.inputEl)==null?void 0:n.value)||""],this.inputEl&&(this.inputEl.setAttribute("autocomplete","off"),this.addEventListener("keydown",t=>{this.isActive&&(t.key==="ArrowDown"||t.key==="ArrowUp"||t.key==="Tab")&&(t.stopPropagation(),t.preventDefault(),this._handleKeyboardNav(t.key==="Tab"?"ArrowDown":t.key))}),this.addEventListener("drb-autocomplete-option:hovered",t=>{const e=t.detail.target;this._highlightOption(e)}),this.addEventListener("drb-autocomplete-option:clicked",t=>{const e=t.detail.target;this._selectOption(e)}),this.addEventListener("drb-type-ahead-updated",()=>{this._updateVisibility(),this._updateKnownValues()}),this.inputEl.addEventListener("blur",()=>{setTimeout(()=>{this.requireSelection&&!this.knownValues.includes(this.inputEl.value)&&(this.inputEl.value="",this.inputEl.dispatchEvent(new Event("change",{bubbles:!0})),this.dispatchEvent(new CustomEvent("drb-autocomplete:invalid-input",{bubbles:!0,composed:!0})))},100)}),this.addEventListener("keydown",t=>{if(t.key==="Enter"&&this.isActive){t.stopPropagation(),t.preventDefault();const e=this.renderRoot.querySelector("drb-autocomplete-option[highlighted]");this._selectOption(e)}}),document.addEventListener("click",t=>{const e=t.target;!this.contains(e)&&this.isActive&&this.close()}),this.addEventListener("keyup",t=>{t.key==="Escape"&&this.isActive&&(t.stopPropagation(),this.close())}))}firstUpdated(){this.typeAheadRef.value&&(this.typeAheadRef.value.input=this.inputEl,this.typeAheadRef.value.initialize())}_highlightOption(n){if(!n)return;this.renderRoot.querySelectorAll("drb-autocomplete-option").forEach(e=>e.highlighted=!1),n.highlighted=!0}_selectOption(n){n&&(this.inputEl.value=n.value,this.inputEl.dispatchEvent(new Event("change",{bubbles:!0})),this.inputEl.blur(),this.close())}_updateVisibility(){var t;this.contains(document.activeElement)&&this.inputEl.value&&((t=this.typeAheadRef.value)!=null&&t.contentEl.innerHTML)?this.open():this.close()}_updateKnownValues(){this.renderRoot.querySelectorAll("drb-autocomplete-option").forEach(t=>{this.knownValues.includes(t.value)||this.knownValues.push(t.value)})}_handleKeyboardNav(n){const t=Array.from(this.renderRoot.querySelectorAll("drb-autocomplete-option"));if(!t.length)return;const e=t.find(s=>s.highlighted),r=n==="ArrowDown"?1:-1;let i=t.indexOf(e)+r;i>=t.length?i=0:i<0&&(i=t.length-1);const o=t[i];o&&(this._highlightOption(o),this.inputEl.value=o.value)}open(){this.isActive=!0}close(){var n;this.isActive=!1,(n=this.typeAheadRef.value)==null||n.abort()}render(){return z`
      <drb-type-ahead
        ${Le(this.typeAheadRef)}
        query-path="${this.queryPath}"
        query-key="${this.queryKey}"
      >
        <drb-popover
          active="${this.isActive||ot}"
          strategy="${this.strategy}"
          distance="8"
          placement="${this.placement}"
          sync="width"
        >
          <slot></slot>

          <div
            data-type-ahead-content
            slot="popover-content"
          ></div>
        </drb-dropdown>
      </drb-type-ahead>
    `}};ze.styles=Z(Ux);Ln([b({attribute:"active",reflect:!0})],ze.prototype,"isActive",2);Ln([b({attribute:"query-path",type:String})],ze.prototype,"queryPath",2);Ln([b({attribute:"query-key",type:String})],ze.prototype,"queryKey",2);Ln([b({attribute:"require-selection",type:Boolean})],ze.prototype,"requireSelection",2);Ln([b({attribute:"placement",type:String})],ze.prototype,"placement",2);Ln([b({type:String})],ze.prototype,"strategy",2);ze=Ln([J("drb-autocomplete")],ze);const Jx=`.clear-btn{position:absolute;top:50%;right:-10px;right:calc(var(--clearable-input-offset, 0px) - var(--clearable-input-tolerance, 10px));margin:0;padding:10px;padding:var(--clearable-input-tolerance, 10px);transform:translateY(-50%);border:0;background:none;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none}.clear-btn[hidden]{display:none}@media (hover: hover){:host([hover-only]:not(:focus-within):not(:hover)) .clear-btn{display:none}}.clear-btn__wrapper{display:grid;width:16px;width:var(--clearable-input-size, 16px);height:16px;height:var(--clearable-input-size, 16px);border-radius:50%;background-color:#3a3546;background-color:var(--clearable-input-bg-color, #3a3546);place-items:center}:hover .clear-btn__wrapper{background-color:#7b7194;background-color:var(--clearable-input-bg-color-hover, #7b7194)}.clear-btn svg{width:10px;height:10px;color:#fff}
`;var Yx=Object.defineProperty,Xx=Object.getOwnPropertyDescriptor,ka=(n,t,e,r)=>{for(var i=r>1?void 0:r?Xx(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&Yx(t,e,i),i};let qr=class extends G{constructor(){super(...arguments),this.inputEl=this.querySelector("input"),this.hoverOnly=!1,this.active=!1}connectedCallback(){super.connectedCallback(),this.inputEl&&(this.inputEl.addEventListener("input",this._updateVisibility.bind(this)),this.inputEl.addEventListener("change",this._updateVisibility.bind(this)),this._updateVisibility())}_updateVisibility(){var n;this.active=!!((n=this.inputEl)!=null&&n.value)}_clear(){this.inputEl&&(this.inputEl.value="",this.inputEl.dispatchEvent(new Event("change",{bubbles:!0})),this.inputEl.dispatchEvent(new Event("drb-clearable-input:cleared",{bubbles:!0})),this.active=!1)}render(){return z`
      <slot></slot>

      <button
        class="clear-btn"
        @click="${this._clear}"
        ?hidden="${!this.active}"
        aria-label="Clear"
      >
        <div class="clear-btn__wrapper">
          ${xt(hs)}
        </div>
      </button>
    `}};qr.styles=Z(Jx);ka([b({attribute:"hover-only",type:Boolean})],qr.prototype,"hoverOnly",2);ka([F()],qr.prototype,"active",2);qr=ka([J("drb-clearable-input")],qr);var Zx=Object.defineProperty,Qx=Object.getOwnPropertyDescriptor,tk=(n,t,e,r)=>{for(var i=r>1?void 0:r?Qx(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&Zx(t,e,i),i};let Bl=class extends G{constructor(){super(...arguments),this.typeAheadRef=Re(),this.dropdownRef=Re(),this.companies=[]}connectedCallback(){var n;super.connectedCallback(),this.inputEl=this.querySelector("input"),(n=this.inputEl)==null||n.addEventListener("focus",this._updateVisibility.bind(this))}firstUpdated(){this.typeAheadRef.value.input=this.inputEl,this.typeAheadRef.value.initialize(),this.typeAheadRef.value.transformContent=n=>(this.companies=n.filter((t,e,r)=>e===r.findIndex(i=>i.name===t.name)),this.companies.length?this.companies.map(t=>`
        <drb-dropdown-option>${t.name}</drb-dropdown-option>
      `).toString().replace(/,/g,""):"")}_updateVisibility(){var n,t,e;this.inputEl===document.activeElement&&(this.inputEl.value&&((n=this.typeAheadRef.value)!=null&&n.contentEl.innerHTML)?(t=this.dropdownRef.value)==null||t.open():(e=this.dropdownRef.value)==null||e.close())}_getCompany(n){return this.companies.find(t=>t.name.toLowerCase()===n.toLowerCase())}_selectCompany(n){var r;if(!(n.target instanceof St))return;const t=(r=this.dropdownRef.value)==null?void 0:r.value,e=this._getCompany(t);e&&(this.inputEl.value=e.name,this.dispatchEvent(new CustomEvent("drb-clearbit-company-selected",{detail:{company:e},bubbles:!0,composed:!0})))}render(){return z`
      <drb-type-ahead
        ${Le(this.typeAheadRef)}
        @drb-type-ahead-updated=${this._updateVisibility}
        query-path="https://autocomplete.clearbit.com/v1/companies/suggest"
        query-key="query"
        external
      >
        <drb-dropdown
          ${Le(this.dropdownRef)}
          @change=${this._selectCompany}
          no-toggle-open
        >
          <slot></slot>

          <div
            data-type-ahead-content
            slot="dropdown-content"
          ></div>
        </drb-dropdown>
      </drb-type-ahead>
    `}};Bl=tk([J("drb-clearbit")],Bl);function ht(n){this.content=n}ht.prototype={constructor:ht,find:function(n){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===n)return t;return-1},get:function(n){var t=this.find(n);return t==-1?void 0:this.content[t+1]},update:function(n,t,e){var r=e&&e!=n?this.remove(e):this,i=r.find(n),o=r.content.slice();return i==-1?o.push(e||n,t):(o[i+1]=t,e&&(o[i]=e)),new ht(o)},remove:function(n){var t=this.find(n);if(t==-1)return this;var e=this.content.slice();return e.splice(t,2),new ht(e)},addToStart:function(n,t){return new ht([n,t].concat(this.remove(n).content))},addToEnd:function(n,t){var e=this.remove(n).content.slice();return e.push(n,t),new ht(e)},addBefore:function(n,t,e){var r=this.remove(t),i=r.content.slice(),o=r.find(n);return i.splice(o==-1?i.length:o,0,t,e),new ht(i)},forEach:function(n){for(var t=0;t<this.content.length;t+=2)n(this.content[t],this.content[t+1])},prepend:function(n){return n=ht.from(n),n.size?new ht(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=ht.from(n),n.size?new ht(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var t=this;n=ht.from(n);for(var e=0;e<n.content.length;e+=2)t=t.remove(n.content[e]);return t},toObject:function(){var n={};return this.forEach(function(t,e){n[t]=e}),n},get size(){return this.content.length>>1}};ht.from=function(n){if(n instanceof ht)return n;var t=[];if(n)for(var e in n)t.push(e,n[e]);return new ht(t)};function oh(n,t,e){for(let r=0;;r++){if(r==n.childCount||r==t.childCount)return n.childCount==t.childCount?null:e;let i=n.child(r),o=t.child(r);if(i==o){e+=i.nodeSize;continue}if(!i.sameMarkup(o))return e;if(i.isText&&i.text!=o.text){for(let s=0;i.text[s]==o.text[s];s++)e++;return e}if(i.content.size||o.content.size){let s=oh(i.content,o.content,e+1);if(s!=null)return s}e+=i.nodeSize}}function sh(n,t,e,r){for(let i=n.childCount,o=t.childCount;;){if(i==0||o==0)return i==o?null:{a:e,b:r};let s=n.child(--i),a=t.child(--o),l=s.nodeSize;if(s==a){e-=l,r-=l;continue}if(!s.sameMarkup(a))return{a:e,b:r};if(s.isText&&s.text!=a.text){let c=0,d=Math.min(s.text.length,a.text.length);for(;c<d&&s.text[s.text.length-c-1]==a.text[a.text.length-c-1];)c++,e--,r--;return{a:e,b:r}}if(s.content.size||a.content.size){let c=sh(s.content,a.content,e-1,r-1);if(c)return c}e-=l,r-=l}}class x{constructor(t,e){if(this.content=t,this.size=e||0,e==null)for(let r=0;r<t.length;r++)this.size+=t[r].nodeSize}nodesBetween(t,e,r,i=0,o){for(let s=0,a=0;a<e;s++){let l=this.content[s],c=a+l.nodeSize;if(c>t&&r(l,i+a,o||null,s)!==!1&&l.content.size){let d=a+1;l.nodesBetween(Math.max(0,t-d),Math.min(l.content.size,e-d),r,i+d)}a=c}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,e,r,i){let o="",s=!0;return this.nodesBetween(t,e,(a,l)=>{let c=a.isText?a.text.slice(Math.max(t,l)-l,e-l):a.isLeaf?i?typeof i=="function"?i(a):i:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(s?s=!1:o+=r),o+=c},0),o}append(t){if(!t.size)return this;if(!this.size)return t;let e=this.lastChild,r=t.firstChild,i=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(r)&&(i[i.length-1]=e.withText(e.text+r.text),o=1);o<t.content.length;o++)i.push(t.content[o]);return new x(i,this.size+t.size)}cut(t,e=this.size){if(t==0&&e==this.size)return this;let r=[],i=0;if(e>t)for(let o=0,s=0;s<e;o++){let a=this.content[o],l=s+a.nodeSize;l>t&&((s<t||l>e)&&(a.isText?a=a.cut(Math.max(0,t-s),Math.min(a.text.length,e-s)):a=a.cut(Math.max(0,t-s-1),Math.min(a.content.size,e-s-1))),r.push(a),i+=a.nodeSize),s=l}return new x(r,i)}cutByIndex(t,e){return t==e?x.empty:t==0&&e==this.content.length?this:new x(this.content.slice(t,e))}replaceChild(t,e){let r=this.content[t];if(r==e)return this;let i=this.content.slice(),o=this.size+e.nodeSize-r.nodeSize;return i[t]=e,new x(i,o)}addToStart(t){return new x([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new x(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e}maybeChild(t){return this.content[t]||null}forEach(t){for(let e=0,r=0;e<this.content.length;e++){let i=this.content[e];t(i,r,e),r+=i.nodeSize}}findDiffStart(t,e=0){return oh(this,t,e)}findDiffEnd(t,e=this.size,r=t.size){return sh(this,t,e,r)}findIndex(t,e=-1){if(t==0)return gi(0,t);if(t==this.size)return gi(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let r=0,i=0;;r++){let o=this.child(r),s=i+o.nodeSize;if(s>=t)return s==t||e>0?gi(r+1,s):gi(r,i);i=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,e){if(!e)return x.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new x(e.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return x.empty;let e,r=0;for(let i=0;i<t.length;i++){let o=t[i];r+=o.nodeSize,i&&o.isText&&t[i-1].sameMarkup(o)?(e||(e=t.slice(0,i)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new x(e||t,r)}static from(t){if(!t)return x.empty;if(t instanceof x)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new x([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}x.empty=new x([],0);const Wo={index:0,offset:0};function gi(n,t){return Wo.index=n,Wo.offset=t,Wo}function Fi(n,t){if(n===t)return!0;if(!(n&&typeof n=="object")||!(t&&typeof t=="object"))return!1;let e=Array.isArray(n);if(Array.isArray(t)!=e)return!1;if(e){if(n.length!=t.length)return!1;for(let r=0;r<n.length;r++)if(!Fi(n[r],t[r]))return!1}else{for(let r in n)if(!(r in t)||!Fi(n[r],t[r]))return!1;for(let r in t)if(!(r in n))return!1}return!0}let W=class Ns{constructor(t,e){this.type=t,this.attrs=e}addToSet(t){let e,r=!1;for(let i=0;i<t.length;i++){let o=t[i];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,i));else{if(o.type.excludes(this.type))return t;!r&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,i)),e.push(this),r=!0),e&&e.push(o)}}return e||(e=t.slice()),r||e.push(this),e}removeFromSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t}isInSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1}eq(t){return this==t||this.type==t.type&&Fi(this.attrs,t.attrs)}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");let r=t.marks[e.type];if(!r)throw new RangeError(`There is no mark type ${e.type} in this schema`);let i=r.create(e.attrs);return r.checkAttrs(i.attrs),i}static sameSet(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!t[r].eq(e[r]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&t.length==0)return Ns.none;if(t instanceof Ns)return[t];let e=t.slice();return e.sort((r,i)=>r.type.rank-i.type.rank),e}};W.none=[];class ji extends Error{}class E{constructor(t,e,r){this.content=t,this.openStart=e,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,e){let r=lh(this.content,t+this.openStart,e);return r&&new E(r,this.openStart,this.openEnd)}removeBetween(t,e){return new E(ah(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,e){if(!e)return E.empty;let r=e.openStart||0,i=e.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new E(x.fromJSON(t,e.content),r,i)}static maxOpen(t,e=!0){let r=0,i=0;for(let o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=t.lastChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.lastChild)i++;return new E(t,r,i)}}E.empty=new E(x.empty,0,0);function ah(n,t,e){let{index:r,offset:i}=n.findIndex(t),o=n.maybeChild(r),{index:s,offset:a}=n.findIndex(e);if(i==t||o.isText){if(a!=e&&!n.child(s).isText)throw new RangeError("Removing non-flat range");return n.cut(0,t).append(n.cut(e))}if(r!=s)throw new RangeError("Removing non-flat range");return n.replaceChild(r,o.copy(ah(o.content,t-i-1,e-i-1)))}function lh(n,t,e,r){let{index:i,offset:o}=n.findIndex(t),s=n.maybeChild(i);if(o==t||s.isText)return r&&!r.canReplace(i,i,e)?null:n.cut(0,t).append(e).append(n.cut(t));let a=lh(s.content,t-o-1,e);return a&&n.replaceChild(i,s.copy(a))}function ek(n,t,e){if(e.openStart>n.depth)throw new ji("Inserted content deeper than insertion position");if(n.depth-e.openStart!=t.depth-e.openEnd)throw new ji("Inconsistent open depths");return ch(n,t,e,0)}function ch(n,t,e,r){let i=n.index(r),o=n.node(r);if(i==t.index(r)&&r<n.depth-e.openStart){let s=ch(n,t,e,r+1);return o.copy(o.content.replaceChild(i,s))}else if(e.content.size)if(!e.openStart&&!e.openEnd&&n.depth==r&&t.depth==r){let s=n.parent,a=s.content;return kn(s,a.cut(0,n.parentOffset).append(e.content).append(a.cut(t.parentOffset)))}else{let{start:s,end:a}=nk(e,n);return kn(o,hh(n,s,a,t,r))}else return kn(o,Vi(n,t,r))}function dh(n,t){if(!t.type.compatibleContent(n.type))throw new ji("Cannot join "+t.type.name+" onto "+n.type.name)}function Is(n,t,e){let r=n.node(e);return dh(r,t.node(e)),r}function xn(n,t){let e=t.length-1;e>=0&&n.isText&&n.sameMarkup(t[e])?t[e]=n.withText(t[e].text+n.text):t.push(n)}function zr(n,t,e,r){let i=(t||n).node(e),o=0,s=t?t.index(e):i.childCount;n&&(o=n.index(e),n.depth>e?o++:n.textOffset&&(xn(n.nodeAfter,r),o++));for(let a=o;a<s;a++)xn(i.child(a),r);t&&t.depth==e&&t.textOffset&&xn(t.nodeBefore,r)}function kn(n,t){return n.type.checkContent(t),n.copy(t)}function hh(n,t,e,r,i){let o=n.depth>i&&Is(n,t,i+1),s=r.depth>i&&Is(e,r,i+1),a=[];return zr(null,n,i,a),o&&s&&t.index(i)==e.index(i)?(dh(o,s),xn(kn(o,hh(n,t,e,r,i+1)),a)):(o&&xn(kn(o,Vi(n,t,i+1)),a),zr(t,e,i,a),s&&xn(kn(s,Vi(e,r,i+1)),a)),zr(r,null,i,a),new x(a)}function Vi(n,t,e){let r=[];if(zr(null,n,e,r),n.depth>e){let i=Is(n,t,e+1);xn(kn(i,Vi(n,t,e+1)),r)}return zr(t,null,e,r),new x(r)}function nk(n,t){let e=t.depth-n.openStart,i=t.node(e).copy(n.content);for(let o=e-1;o>=0;o--)i=t.node(o).copy(x.from(i));return{start:i.resolveNoCache(n.openStart+e),end:i.resolveNoCache(i.content.size-n.openEnd-e)}}class Ur{constructor(t,e,r){this.pos=t,this.path=e,this.parentOffset=r,this.depth=e.length/3-1}resolveDepth(t){return t==null?this.depth:t<0?this.depth+t:t}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(t){return this.path[this.resolveDepth(t)*3]}index(t){return this.path[this.resolveDepth(t)*3+1]}indexAfter(t){return t=this.resolveDepth(t),this.index(t)+(t==this.depth&&!this.textOffset?0:1)}start(t){return t=this.resolveDepth(t),t==0?0:this.path[t*3-1]+1}end(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}before(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]}after(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]+this.path[t*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=t.child(e);return r?t.child(e).cut(r):i}get nodeBefore(){let t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):t==0?null:this.parent.child(t-1)}posAtIndex(t,e){e=this.resolveDepth(e);let r=this.path[e*3],i=e==0?0:this.path[e*3-1]+1;for(let o=0;o<t;o++)i+=r.child(o).nodeSize;return i}marks(){let t=this.parent,e=this.index();if(t.content.size==0)return W.none;if(this.textOffset)return t.child(e).marks;let r=t.maybeChild(e-1),i=t.maybeChild(e);if(!r){let a=r;r=i,i=a}let o=r.marks;for(var s=0;s<o.length;s++)o[s].type.spec.inclusive===!1&&(!i||!o[s].isInSet(i.marks))&&(o=o[s--].removeFromSet(o));return o}marksAcross(t){let e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;let r=e.marks,i=t.parent.maybeChild(t.index());for(var o=0;o<r.length;o++)r[o].type.spec.inclusive===!1&&(!i||!r[o].isInSet(i.marks))&&(r=r[o--].removeFromSet(r));return r}sharedDepth(t){for(let e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0}blockRange(t=this,e){if(t.pos<this.pos)return t.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);r>=0;r--)if(t.pos<=this.end(r)&&(!e||e(this.node(r))))return new Hi(this,t,r);return null}sameParent(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}max(t){return t.pos>this.pos?t:this}min(t){return t.pos<this.pos?t:this}toString(){let t="";for(let e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset}static resolve(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");let r=[],i=0,o=e;for(let s=t;;){let{index:a,offset:l}=s.content.findIndex(o),c=o-l;if(r.push(s,a,i+l),!c||(s=s.child(a),s.isText))break;o=c-1,i+=l+1}return new Ur(e,r,o)}static resolveCached(t,e){let r=Fl.get(t);if(r)for(let o=0;o<r.elts.length;o++){let s=r.elts[o];if(s.pos==e)return s}else Fl.set(t,r=new rk);let i=r.elts[r.i]=Ur.resolve(t,e);return r.i=(r.i+1)%ik,i}}class rk{constructor(){this.elts=[],this.i=0}}const ik=12,Fl=new WeakMap;class Hi{constructor(t,e,r){this.$from=t,this.$to=e,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const ok=Object.create(null);let Sn=class Ps{constructor(t,e,r,i=W.none){this.type=t,this.attrs=e,this.marks=i,this.content=r||x.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(t){return this.content.child(t)}maybeChild(t){return this.content.maybeChild(t)}forEach(t){this.content.forEach(t)}nodesBetween(t,e,r,i=0){this.content.nodesBetween(t,e,r,i,this)}descendants(t){this.nodesBetween(0,this.content.size,t)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(t,e,r,i){return this.content.textBetween(t,e,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}sameMarkup(t){return this.hasMarkup(t.type,t.attrs,t.marks)}hasMarkup(t,e,r){return this.type==t&&Fi(this.attrs,e||t.defaultAttrs||ok)&&W.sameSet(this.marks,r||W.none)}copy(t=null){return t==this.content?this:new Ps(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new Ps(this.type,this.attrs,this.content,t)}cut(t,e=this.content.size){return t==0&&e==this.content.size?this:this.copy(this.content.cut(t,e))}slice(t,e=this.content.size,r=!1){if(t==e)return E.empty;let i=this.resolve(t),o=this.resolve(e),s=r?0:i.sharedDepth(e),a=i.start(s),c=i.node(s).content.cut(i.pos-a,o.pos-a);return new E(c,i.depth-s,o.depth-s)}replace(t,e,r){return ek(this.resolve(t),this.resolve(e),r)}nodeAt(t){for(let e=this;;){let{index:r,offset:i}=e.content.findIndex(t);if(e=e.maybeChild(r),!e)return null;if(i==t||e.isText)return e;t-=i+1}}childAfter(t){let{index:e,offset:r}=this.content.findIndex(t);return{node:this.content.maybeChild(e),index:e,offset:r}}childBefore(t){if(t==0)return{node:null,index:0,offset:0};let{index:e,offset:r}=this.content.findIndex(t);if(r<t)return{node:this.content.child(e),index:e,offset:r};let i=this.content.child(e-1);return{node:i,index:e-1,offset:r-i.nodeSize}}resolve(t){return Ur.resolveCached(this,t)}resolveNoCache(t){return Ur.resolve(this,t)}rangeHasMark(t,e,r){let i=!1;return e>t&&this.nodesBetween(t,e,o=>(r.isInSet(o.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),uh(this.marks,t)}contentMatchAt(t){let e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e}canReplace(t,e,r=x.empty,i=0,o=r.childCount){let s=this.contentMatchAt(t).matchFragment(r,i,o),a=s&&s.matchFragment(this.content,e);if(!a||!a.validEnd)return!1;for(let l=i;l<o;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(t,e,r,i){if(i&&!this.type.allowsMarks(i))return!1;let o=this.contentMatchAt(t).matchType(r),s=o&&o.matchFragment(this.content,e);return s?s.validEnd:!1}canAppend(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let t=W.none;for(let e=0;e<this.marks.length;e++){let r=this.marks[e];r.type.checkAttrs(r.attrs),t=r.addToSet(t)}if(!W.sameSet(t,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(e=>e.type.name)}`);this.content.forEach(e=>e.check())}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(e=>e.toJSON())),t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");let r;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=e.marks.map(t.markFromJSON)}if(e.type=="text"){if(typeof e.text!="string")throw new RangeError("Invalid text node in JSON");return t.text(e.text,r)}let i=x.fromJSON(t,e.content),o=t.nodeType(e.type).create(e.attrs,i,r);return o.type.checkAttrs(o.attrs),o}};Sn.prototype.text=void 0;class Wi extends Sn{constructor(t,e,r,i){if(super(t,e,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):uh(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(t,e){return this.text.slice(t,e)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new Wi(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new Wi(this.type,this.attrs,t,this.marks)}cut(t=0,e=this.text.length){return t==0&&e==this.text.length?this:this.withText(this.text.slice(t,e))}eq(t){return this.sameMarkup(t)&&this.text==t.text}toJSON(){let t=super.toJSON();return t.text=this.text,t}}function uh(n,t){for(let e=n.length-1;e>=0;e--)t=n[e].type.name+"("+t+")";return t}class $n{constructor(t){this.validEnd=t,this.next=[],this.wrapCache=[]}static parse(t,e){let r=new sk(t,e);if(r.next==null)return $n.empty;let i=ph(r);r.next&&r.err("Unexpected trailing text");let o=pk(uk(i));return fk(o,r),o}matchType(t){for(let e=0;e<this.next.length;e++)if(this.next[e].type==t)return this.next[e].next;return null}matchFragment(t,e=0,r=t.childCount){let i=this;for(let o=e;i&&o<r;o++)i=i.matchType(t.child(o).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let t=0;t<this.next.length;t++){let{type:e}=this.next[t];if(!(e.isText||e.hasRequiredAttrs()))return e}return null}compatible(t){for(let e=0;e<this.next.length;e++)for(let r=0;r<t.next.length;r++)if(this.next[e].type==t.next[r].type)return!0;return!1}fillBefore(t,e=!1,r=0){let i=[this];function o(s,a){let l=s.matchFragment(t,r);if(l&&(!e||l.validEnd))return x.from(a.map(c=>c.createAndFill()));for(let c=0;c<s.next.length;c++){let{type:d,next:h}=s.next[c];if(!(d.isText||d.hasRequiredAttrs())&&i.indexOf(h)==-1){i.push(h);let u=o(h,a.concat(d));if(u)return u}}return null}return o(this,[])}findWrapping(t){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==t)return this.wrapCache[r+1];let e=this.computeWrapping(t);return this.wrapCache.push(t,e),e}computeWrapping(t){let e=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),o=i.match;if(o.matchType(t)){let s=[];for(let a=i;a.type;a=a.via)s.push(a.type);return s.reverse()}for(let s=0;s<o.next.length;s++){let{type:a,next:l}=o.next[s];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in e)&&(!i.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:i}),e[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(t){if(t>=this.next.length)throw new RangeError(`There's no ${t}th edge in this content match`);return this.next[t]}toString(){let t=[];function e(r){t.push(r);for(let i=0;i<r.next.length;i++)t.indexOf(r.next[i].next)==-1&&e(r.next[i].next)}return e(this),t.map((r,i)=>{let o=i+(r.validEnd?"*":" ")+" ";for(let s=0;s<r.next.length;s++)o+=(s?", ":"")+r.next[s].type.name+"->"+t.indexOf(r.next[s].next);return o}).join(`
`)}}$n.empty=new $n(!0);class sk{constructor(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(t){return this.next==t&&(this.pos++||!0)}err(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}}function ph(n){let t=[];do t.push(ak(n));while(n.eat("|"));return t.length==1?t[0]:{type:"choice",exprs:t}}function ak(n){let t=[];do t.push(lk(n));while(n.next&&n.next!=")"&&n.next!="|");return t.length==1?t[0]:{type:"seq",exprs:t}}function lk(n){let t=hk(n);for(;;)if(n.eat("+"))t={type:"plus",expr:t};else if(n.eat("*"))t={type:"star",expr:t};else if(n.eat("?"))t={type:"opt",expr:t};else if(n.eat("{"))t=ck(n,t);else break;return t}function jl(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let t=Number(n.next);return n.pos++,t}function ck(n,t){let e=jl(n),r=e;return n.eat(",")&&(n.next!="}"?r=jl(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:e,max:r,expr:t}}function dk(n,t){let e=n.nodeTypes,r=e[t];if(r)return[r];let i=[];for(let o in e){let s=e[o];s.isInGroup(t)&&i.push(s)}return i.length==0&&n.err("No node type or group '"+t+"' found"),i}function hk(n){if(n.eat("(")){let t=ph(n);return n.eat(")")||n.err("Missing closing paren"),t}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let t=dk(n,n.next).map(e=>(n.inline==null?n.inline=e.isInline:n.inline!=e.isInline&&n.err("Mixing inline and block content"),{type:"name",value:e}));return n.pos++,t.length==1?t[0]:{type:"choice",exprs:t}}}function uk(n){let t=[[]];return i(o(n,0),e()),t;function e(){return t.push([])-1}function r(s,a,l){let c={term:l,to:a};return t[s].push(c),c}function i(s,a){s.forEach(l=>l.to=a)}function o(s,a){if(s.type=="choice")return s.exprs.reduce((l,c)=>l.concat(o(c,a)),[]);if(s.type=="seq")for(let l=0;;l++){let c=o(s.exprs[l],a);if(l==s.exprs.length-1)return c;i(c,a=e())}else if(s.type=="star"){let l=e();return r(a,l),i(o(s.expr,l),l),[r(l)]}else if(s.type=="plus"){let l=e();return i(o(s.expr,a),l),i(o(s.expr,l),l),[r(l)]}else{if(s.type=="opt")return[r(a)].concat(o(s.expr,a));if(s.type=="range"){let l=a;for(let c=0;c<s.min;c++){let d=e();i(o(s.expr,l),d),l=d}if(s.max==-1)i(o(s.expr,l),l);else for(let c=s.min;c<s.max;c++){let d=e();r(l,d),i(o(s.expr,l),d),l=d}return[r(l)]}else{if(s.type=="name")return[r(a,void 0,s.value)];throw new Error("Unknown expr type")}}}}function fh(n,t){return t-n}function Vl(n,t){let e=[];return r(t),e.sort(fh);function r(i){let o=n[i];if(o.length==1&&!o[0].term)return r(o[0].to);e.push(i);for(let s=0;s<o.length;s++){let{term:a,to:l}=o[s];!a&&e.indexOf(l)==-1&&r(l)}}}function pk(n){let t=Object.create(null);return e(Vl(n,0));function e(r){let i=[];r.forEach(s=>{n[s].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let d=0;d<i.length;d++)i[d][0]==a&&(c=i[d][1]);Vl(n,l).forEach(d=>{c||i.push([a,c=[]]),c.indexOf(d)==-1&&c.push(d)})})});let o=t[r.join(",")]=new $n(r.indexOf(n.length-1)>-1);for(let s=0;s<i.length;s++){let a=i[s][1].sort(fh);o.next.push({type:i[s][0],next:t[a.join(",")]||e(a)})}return o}}function fk(n,t){for(let e=0,r=[n];e<r.length;e++){let i=r[e],o=!i.validEnd,s=[];for(let a=0;a<i.next.length;a++){let{type:l,next:c}=i.next[a];s.push(l.name),o&&!(l.isText||l.hasRequiredAttrs())&&(o=!1),r.indexOf(c)==-1&&r.push(c)}o&&t.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function mh(n){let t=Object.create(null);for(let e in n){let r=n[e];if(!r.hasDefault)return null;t[e]=r.default}return t}function gh(n,t){let e=Object.create(null);for(let r in n){let i=t&&t[r];if(i===void 0){let o=n[r];if(o.hasDefault)i=o.default;else throw new RangeError("No value supplied for attribute "+r)}e[r]=i}return e}function bh(n,t,e,r){for(let i in t)if(!(i in n))throw new RangeError(`Unsupported attribute ${i} for ${e} of type ${i}`);for(let i in n){let o=n[i];o.validate&&o.validate(t[i])}}function yh(n,t){let e=Object.create(null);if(t)for(let r in t)e[r]=new gk(n,r,t[r]);return e}let Hl=class vh{constructor(t,e,r){this.name=t,this.schema=e,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=yh(t,r.attrs),this.defaultAttrs=mh(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||t=="text"),this.isText=t=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==$n.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(t){return this.groups.indexOf(t)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}compatibleContent(t){return this==t||this.contentMatch.compatible(t.contentMatch)}computeAttrs(t){return!t&&this.defaultAttrs?this.defaultAttrs:gh(this.attrs,t)}create(t=null,e,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Sn(this,this.computeAttrs(t),x.from(e),W.setFrom(r))}createChecked(t=null,e,r){return e=x.from(e),this.checkContent(e),new Sn(this,this.computeAttrs(t),e,W.setFrom(r))}createAndFill(t=null,e,r){if(t=this.computeAttrs(t),e=x.from(e),e.size){let s=this.contentMatch.fillBefore(e);if(!s)return null;e=s.append(e)}let i=this.contentMatch.matchFragment(e),o=i&&i.fillBefore(x.empty,!0);return o?new Sn(this,t,e.append(o),W.setFrom(r)):null}validContent(t){let e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(let r=0;r<t.childCount;r++)if(!this.allowsMarks(t.child(r).marks))return!1;return!0}checkContent(t){if(!this.validContent(t))throw new RangeError(`Invalid content for node ${this.name}: ${t.toString().slice(0,50)}`)}checkAttrs(t){bh(this.attrs,t,"node",this.name)}allowsMarkType(t){return this.markSet==null||this.markSet.indexOf(t)>-1}allowsMarks(t){if(this.markSet==null)return!0;for(let e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0}allowedMarks(t){if(this.markSet==null)return t;let e;for(let r=0;r<t.length;r++)this.allowsMarkType(t[r].type)?e&&e.push(t[r]):e||(e=t.slice(0,r));return e?e.length?e:W.none:t}static compile(t,e){let r=Object.create(null);t.forEach((o,s)=>r[o]=new vh(o,e,s));let i=e.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let o in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function mk(n,t,e){let r=e.split("|");return i=>{let o=i===null?"null":typeof i;if(r.indexOf(o)<0)throw new RangeError(`Expected value of type ${r} for attribute ${t} on type ${n}, got ${o}`)}}class gk{constructor(t,e,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?mk(t,e,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class go{constructor(t,e,r,i){this.name=t,this.rank=e,this.schema=r,this.spec=i,this.attrs=yh(t,i.attrs),this.excluded=null;let o=mh(this.attrs);this.instance=o?new W(this,o):null}create(t=null){return!t&&this.instance?this.instance:new W(this,gh(this.attrs,t))}static compile(t,e){let r=Object.create(null),i=0;return t.forEach((o,s)=>r[o]=new go(o,i++,e,s)),r}removeFromSet(t){for(var e=0;e<t.length;e++)t[e].type==this&&(t=t.slice(0,e).concat(t.slice(e+1)),e--);return t}isInSet(t){for(let e=0;e<t.length;e++)if(t[e].type==this)return t[e]}checkAttrs(t){bh(this.attrs,t,"mark",this.name)}excludes(t){return this.excluded.indexOf(t)>-1}}class bk{constructor(t){this.linebreakReplacement=null,this.cached=Object.create(null);let e=this.spec={};for(let i in t)e[i]=t[i];e.nodes=ht.from(t.nodes),e.marks=ht.from(t.marks||{}),this.nodes=Hl.compile(this.spec.nodes,this),this.marks=go.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let o=this.nodes[i],s=o.spec.content||"",a=o.spec.marks;if(o.contentMatch=r[s]||(r[s]=$n.parse(s,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=a=="_"?null:a?Wl(this,a.split(" ")):a==""||!o.inlineContent?[]:null}for(let i in this.marks){let o=this.marks[i],s=o.spec.excludes;o.excluded=s==null?[o]:s==""?[]:Wl(this,s.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(t,e=null,r,i){if(typeof t=="string")t=this.nodeType(t);else if(t instanceof Hl){if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}else throw new RangeError("Invalid node type: "+t);return t.createChecked(e,r,i)}text(t,e){let r=this.nodes.text;return new Wi(r,r.defaultAttrs,t,W.setFrom(e))}mark(t,e){return typeof t=="string"&&(t=this.marks[t]),t.create(e)}nodeFromJSON(t){return Sn.fromJSON(this,t)}markFromJSON(t){return W.fromJSON(this,t)}nodeType(t){let e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e}}function Wl(n,t){let e=[];for(let r=0;r<t.length;r++){let i=t[r],o=n.marks[i],s=o;if(o)e.push(o);else for(let a in n.marks){let l=n.marks[a];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&e.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+t[r]+"'")}return e}function yk(n){return n.tag!=null}function vk(n){return n.style!=null}let Sa=class Rs{constructor(t,e){this.schema=t,this.rules=e,this.tags=[],this.styles=[];let r=this.matchedStyles=[];e.forEach(i=>{if(yk(i))this.tags.push(i);else if(vk(i)){let o=/[^=]*/.exec(i.style)[0];r.indexOf(o)<0&&r.push(o),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let o=t.nodes[i.node];return o.contentMatch.matchType(o)})}parse(t,e={}){let r=new Ul(this,e,!1);return r.addAll(t,W.none,e.from,e.to),r.finish()}parseSlice(t,e={}){let r=new Ul(this,e,!0);return r.addAll(t,W.none,e.from,e.to),E.maxOpen(r.finish())}matchTag(t,e,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let o=this.tags[i];if(kk(t,o.tag)&&(o.namespace===void 0||t.namespaceURI==o.namespace)&&(!o.context||e.matchesContext(o.context))){if(o.getAttrs){let s=o.getAttrs(t);if(s===!1)continue;o.attrs=s||void 0}return o}}}matchStyle(t,e,r,i){for(let o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){let s=this.styles[o],a=s.style;if(!(a.indexOf(t)!=0||s.context&&!r.matchesContext(s.context)||a.length>t.length&&(a.charCodeAt(t.length)!=61||a.slice(t.length+1)!=e))){if(s.getAttrs){let l=s.getAttrs(e);if(l===!1)continue;s.attrs=l||void 0}return s}}}static schemaRules(t){let e=[];function r(i){let o=i.priority==null?50:i.priority,s=0;for(;s<e.length;s++){let a=e[s];if((a.priority==null?50:a.priority)<o)break}e.splice(s,0,i)}for(let i in t.marks){let o=t.marks[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Kl(s)),s.mark||s.ignore||s.clearMark||(s.mark=i)})}for(let i in t.nodes){let o=t.nodes[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Kl(s)),s.node||s.ignore||s.mark||(s.node=i)})}return e}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new Rs(t,Rs.schemaRules(t)))}};const wh={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},wk={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},xh={ol:!0,ul:!0},Kr=1,Ls=2,Br=4;function ql(n,t,e){return t!=null?(t?Kr:0)|(t==="full"?Ls:0):n&&n.whitespace=="pre"?Kr|Ls:e&~Br}class bi{constructor(t,e,r,i,o,s){this.type=t,this.attrs=e,this.marks=r,this.solid=i,this.options=s,this.content=[],this.activeMarks=W.none,this.match=o||(s&Br?null:t.contentMatch)}findWrapping(t){if(!this.match){if(!this.type)return[];let e=this.type.contentMatch.fillBefore(x.from(t));if(e)this.match=this.type.contentMatch.matchFragment(e);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(t.type))?(this.match=r,i):null}}return this.match.findWrapping(t.type)}finish(t){if(!(this.options&Kr)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let o=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-i[0].length))}}let e=x.from(this.content);return!t&&this.match&&(e=e.append(this.match.fillBefore(x.empty,!0))),this.type?this.type.create(this.attrs,e,this.marks):e}inlineContext(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!wh.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}}class Ul{constructor(t,e,r){this.parser=t,this.options=e,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=e.topNode,o,s=ql(null,e.preserveWhitespace,0)|(r?Br:0);i?o=new bi(i.type,i.attrs,W.none,!0,e.topMatch||i.type.contentMatch,s):r?o=new bi(null,null,W.none,!0,null,s):o=new bi(t.schema.topNodeType,null,W.none,!0,null,s),this.nodes=[o],this.find=e.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(t,e){t.nodeType==3?this.addTextNode(t,e):t.nodeType==1&&this.addElement(t,e)}addTextNode(t,e){let r=t.nodeValue,i=this.top,o=i.options&Ls?"full":this.localPreserveWS||(i.options&Kr)>0;if(o==="full"||i.inlineContext(t)||/[^ \t\r\n\u000c]/.test(r)){if(o)o!=="full"?r=r.replace(/\r?\n|\r/g," "):r=r.replace(/\r\n?/g,`
`);else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let s=i.content[i.content.length-1],a=t.previousSibling;(!s||a&&a.nodeName=="BR"||s.isText&&/[ \t\r\n\u000c]$/.test(s.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),e),this.findInText(t)}else this.findInside(t)}addElement(t,e,r){let i=this.localPreserveWS,o=this.top;(t.tagName=="PRE"||/pre/.test(t.style&&t.style.whiteSpace))&&(this.localPreserveWS=!0);let s=t.nodeName.toLowerCase(),a;xh.hasOwnProperty(s)&&this.parser.normalizeLists&&xk(t);let l=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(a=this.parser.matchTag(t,this,r));t:if(l?l.ignore:wk.hasOwnProperty(s))this.findInside(t),this.ignoreFallback(t,e);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(t=l.skip);let c,d=this.needsBlock;if(wh.hasOwnProperty(s))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),c=!0,o.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t,e);break t}let h=l&&l.skip?e:this.readStyles(t,e);h&&this.addAll(t,h),c&&this.sync(o),this.needsBlock=d}else{let c=this.readStyles(t,e);c&&this.addElementByRule(t,l,c,l.consuming===!1?a:void 0)}this.localPreserveWS=i}leafFallback(t,e){t.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode(`
`),e)}ignoreFallback(t,e){t.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),e)}readStyles(t,e){let r=t.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let o=this.parser.matchedStyles[i],s=r.getPropertyValue(o);if(s)for(let a=void 0;;){let l=this.parser.matchStyle(o,s,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?e=e.filter(c=>!l.clearMark(c)):e=e.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return e}addElementByRule(t,e,r,i){let o,s;if(e.node)if(s=this.parser.schema.nodes[e.node],s.isLeaf)this.insertNode(s.create(e.attrs),r)||this.leafFallback(t,r);else{let l=this.enter(s,e.attrs||null,r,e.preserveWhitespace);l&&(o=!0,r=l)}else{let l=this.parser.schema.marks[e.mark];r=r.concat(l.create(e.attrs))}let a=this.top;if(s&&s.isLeaf)this.findInside(t);else if(i)this.addElement(t,r,i);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach(l=>this.insertNode(l,r));else{let l=t;typeof e.contentElement=="string"?l=t.querySelector(e.contentElement):typeof e.contentElement=="function"?l=e.contentElement(t):e.contentElement&&(l=e.contentElement),this.findAround(t,l,!0),this.addAll(l,r),this.findAround(t,l,!1)}o&&this.sync(a)&&this.open--}addAll(t,e,r,i){let o=r||0;for(let s=r?t.childNodes[r]:t.firstChild,a=i==null?null:t.childNodes[i];s!=a;s=s.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(s,e);this.findAtPoint(t,o)}findPlace(t,e){let r,i;for(let o=this.open;o>=0;o--){let s=this.nodes[o],a=s.findWrapping(t);if(a&&(!r||r.length>a.length)&&(r=a,i=s,!a.length)||s.solid)break}if(!r)return null;this.sync(i);for(let o=0;o<r.length;o++)e=this.enterInner(r[o],null,e,!1);return e}insertNode(t,e){if(t.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(e=this.enterInner(i,null,e))}let r=this.findPlace(t,e);if(r){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(t.type));let o=W.none;for(let s of r.concat(t.marks))(i.type?i.type.allowsMarkType(s.type):Gl(s.type,t.type))&&(o=s.addToSet(o));return i.content.push(t.mark(o)),!0}return!1}enter(t,e,r,i){let o=this.findPlace(t.create(e),r);return o&&(o=this.enterInner(t,e,r,!0,i)),o}enterInner(t,e,r,i=!1,o){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(t);let a=ql(t,o,s.options);s.options&Br&&s.content.length==0&&(a|=Br);let l=W.none;return r=r.filter(c=>(s.type?s.type.allowsMarkType(c.type):Gl(c.type,t))?(l=c.addToSet(l),!1):!0),this.nodes.push(new bi(t,e,l,i,null,a)),this.open++,r}closeExtra(t=!1){let e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(t){for(let e=this.open;e>=0;e--){if(this.nodes[e]==t)return this.open=e,!0;this.localPreserveWS&&(this.nodes[e].options|=Kr)}return!1}get currentPos(){this.closeExtra();let t=0;for(let e=this.open;e>=0;e--){let r=this.nodes[e].content;for(let i=r.length-1;i>=0;i--)t+=r[i].nodeSize;e&&t++}return t}findAtPoint(t,e){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==t&&this.find[r].offset==e&&(this.find[r].pos=this.currentPos)}findInside(t){if(this.find)for(let e=0;e<this.find.length;e++)this.find[e].pos==null&&t.nodeType==1&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)}findAround(t,e,r){if(t!=e&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&t.nodeType==1&&t.contains(this.find[i].node)&&e.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(t){if(this.find)for(let e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))}matchesContext(t){if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);let e=t.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),o=-(r?r.depth+1:0)+(i?0:1),s=(a,l)=>{for(;a>=0;a--){let c=e[a];if(c==""){if(a==e.length-1||a==0)continue;for(;l>=o;l--)if(s(a-1,l))return!0;return!1}else{let d=l>0||l==0&&i?this.nodes[l].type:r&&l>=o?r.node(l-o).type:null;if(!d||d.name!=c&&!d.isInGroup(c))return!1;l--}}return!0};return s(e.length-1,this.open)}textblockFromContext(){let t=this.options.context;if(t)for(let e=t.depth;e>=0;e--){let r=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let e in this.parser.schema.nodes){let r=this.parser.schema.nodes[e];if(r.isTextblock&&r.defaultAttrs)return r}}}function xk(n){for(let t=n.firstChild,e=null;t;t=t.nextSibling){let r=t.nodeType==1?t.nodeName.toLowerCase():null;r&&xh.hasOwnProperty(r)&&e?(e.appendChild(t),t=e):r=="li"?e=t:r&&(e=null)}}function kk(n,t){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,t)}function Kl(n){let t={};for(let e in n)t[e]=n[e];return t}function Gl(n,t){let e=t.schema.nodes;for(let r in e){let i=e[r];if(!i.allowsMarkType(n))continue;let o=[],s=a=>{o.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:d}=a.edge(l);if(c==t||o.indexOf(d)<0&&s(d))return!0}};if(s(i.contentMatch))return!0}}class zn{constructor(t,e){this.nodes=t,this.marks=e}serializeFragment(t,e={},r){r||(r=qo(e).createDocumentFragment());let i=r,o=[];return t.forEach(s=>{if(o.length||s.marks.length){let a=0,l=0;for(;a<o.length&&l<s.marks.length;){let c=s.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(o[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<o.length;)i=o.pop()[1];for(;l<s.marks.length;){let c=s.marks[l++],d=this.serializeMark(c,s.isInline,e);d&&(o.push([c,i]),i.appendChild(d.dom),i=d.contentDOM||d.dom)}}i.appendChild(this.serializeNodeInner(s,e))}),r}serializeNodeInner(t,e){let{dom:r,contentDOM:i}=ki(qo(e),this.nodes[t.type.name](t),null,t.attrs);if(i){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,e,i)}return r}serializeNode(t,e={}){let r=this.serializeNodeInner(t,e);for(let i=t.marks.length-1;i>=0;i--){let o=this.serializeMark(t.marks[i],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(r),r=o.dom)}return r}serializeMark(t,e,r={}){let i=this.marks[t.type.name];return i&&ki(qo(r),i(t,e),null,t.attrs)}static renderSpec(t,e,r=null,i){return ki(t,e,r,i)}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new zn(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let e=Jl(t.nodes);return e.text||(e.text=r=>r.text),e}static marksFromSchema(t){return Jl(t.marks)}}function Jl(n){let t={};for(let e in n){let r=n[e].spec.toDOM;r&&(t[e]=r)}return t}function qo(n){return n.document||window.document}const Yl=new WeakMap;function Sk(n){let t=Yl.get(n);return t===void 0&&Yl.set(n,t=Ck(n)),t}function Ck(n){let t=null;function e(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")t||(t=[]),t.push(r);else for(let i=0;i<r.length;i++)e(r[i]);else for(let i in r)e(r[i])}return e(n),t}function ki(n,t,e,r){if(typeof t=="string")return{dom:n.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let i=t[0],o;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=Sk(r))&&o.indexOf(t)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=i.indexOf(" ");s>0&&(e=i.slice(0,s),i=i.slice(s+1));let a,l=e?n.createElementNS(e,i):n.createElement(i),c=t[1],d=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){d=2;for(let h in c)if(c[h]!=null){let u=h.indexOf(" ");u>0?l.setAttributeNS(h.slice(0,u),h.slice(u+1),c[h]):l.setAttribute(h,c[h])}}for(let h=d;h<t.length;h++){let u=t[h];if(u===0){if(h<t.length-1||h>d)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:p,contentDOM:f}=ki(n,u,e,r);if(l.appendChild(p),f){if(a)throw new RangeError("Multiple content holes");a=f}}}return{dom:l,contentDOM:a}}const kh=65535,Sh=Math.pow(2,16);function Ek(n,t){return n+t*Sh}function Xl(n){return n&kh}function Ok(n){return(n-(n&kh))/Sh}const Ch=1,Eh=2,Si=4,Oh=8;class zs{constructor(t,e,r){this.pos=t,this.delInfo=e,this.recover=r}get deleted(){return(this.delInfo&Oh)>0}get deletedBefore(){return(this.delInfo&(Ch|Si))>0}get deletedAfter(){return(this.delInfo&(Eh|Si))>0}get deletedAcross(){return(this.delInfo&Si)>0}}class Pt{constructor(t,e=!1){if(this.ranges=t,this.inverted=e,!t.length&&Pt.empty)return Pt.empty}recover(t){let e=0,r=Xl(t);if(!this.inverted)for(let i=0;i<r;i++)e+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+e+Ok(t)}mapResult(t,e=1){return this._map(t,e,!1)}map(t,e=1){return this._map(t,e,!0)}_map(t,e,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?i:0);if(l>t)break;let c=this.ranges[a+o],d=this.ranges[a+s],h=l+c;if(t<=h){let u=c?t==l?-1:t==h?1:e:e,p=l+i+(u<0?0:d);if(r)return p;let f=t==(e<0?l:h)?null:Ek(a/3,t-l),m=t==l?Eh:t==h?Ch:Si;return(e<0?t!=l:t!=h)&&(m|=Oh),new zs(p,m,f)}i+=d-c}return r?t+i:new zs(t+i,0,null)}touches(t,e){let r=0,i=Xl(e),o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>t)break;let c=this.ranges[a+o],d=l+c;if(t<=d&&a==i*3)return!0;r+=this.ranges[a+s]-c}return!1}forEach(t){let e=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],a=s-(this.inverted?o:0),l=s+(this.inverted?0:o),c=this.ranges[i+e],d=this.ranges[i+r];t(a,a+c,l,l+d),o+=d-c}}invert(){return new Pt(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return t==0?Pt.empty:new Pt(t<0?[0,-t,0]:[0,0,t])}}Pt.empty=new Pt([]);class Jn{constructor(t=[],e,r=0,i=t.length){this.maps=t,this.mirror=e,this.from=r,this.to=i}slice(t=0,e=this.maps.length){return new Jn(this.maps,this.mirror,t,e)}copy(){return new Jn(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(t,e){this.to=this.maps.push(t),e!=null&&this.setMirror(this.maps.length-1,e)}appendMapping(t){for(let e=0,r=this.maps.length;e<t.maps.length;e++){let i=t.getMirror(e);this.appendMap(t.maps[e],i!=null&&i<e?r+i:void 0)}}getMirror(t){if(this.mirror){for(let e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]}}setMirror(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)}appendMappingInverted(t){for(let e=t.maps.length-1,r=this.maps.length+t.maps.length;e>=0;e--){let i=t.getMirror(e);this.appendMap(t.maps[e].invert(),i!=null&&i>e?r-i-1:void 0)}}invert(){let t=new Jn;return t.appendMappingInverted(this),t}map(t,e=1){if(this.mirror)return this._map(t,e,!0);for(let r=this.from;r<this.to;r++)t=this.maps[r].map(t,e);return t}mapResult(t,e=1){return this._map(t,e,!1)}_map(t,e,r){let i=0;for(let o=this.from;o<this.to;o++){let s=this.maps[o],a=s.mapResult(t,e);if(a.recover!=null){let l=this.getMirror(o);if(l!=null&&l>o&&l<this.to){o=l,t=this.maps[l].recover(a.recover);continue}}i|=a.delInfo,t=a.pos}return r?t:new zs(t,i,null)}}const Uo=Object.create(null);class wt{getMap(){return Pt.empty}merge(t){return null}static fromJSON(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Uo[e.stepType];if(!r)throw new RangeError(`No step type ${e.stepType} defined`);return r.fromJSON(t,e)}static jsonID(t,e){if(t in Uo)throw new RangeError("Duplicate use of step JSON ID "+t);return Uo[t]=e,e.prototype.jsonID=t,e}}class Q{constructor(t,e){this.doc=t,this.failed=e}static ok(t){return new Q(t,null)}static fail(t){return new Q(null,t)}static fromReplace(t,e,r,i){try{return Q.ok(t.replace(e,r,i))}catch(o){if(o instanceof ji)return Q.fail(o.message);throw o}}}function Ca(n,t,e){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(Ca(o.content,t,o))),o.isInline&&(o=t(o,e,i)),r.push(o)}return x.fromArray(r)}class Ge extends wt{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=t.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new E(Ca(e.content,(s,a)=>!s.isAtom||!a.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),e.openStart,e.openEnd);return Q.fromReplace(t,this.from,this.to,o)}invert(){return new be(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new Ge(e.pos,r.pos,this.mark)}merge(t){return t instanceof Ge&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new Ge(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Ge(e.from,e.to,t.markFromJSON(e.mark))}}wt.jsonID("addMark",Ge);class be extends wt{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=new E(Ca(e.content,i=>i.mark(this.mark.removeFromSet(i.marks)),t),e.openStart,e.openEnd);return Q.fromReplace(t,this.from,this.to,r)}invert(){return new Ge(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new be(e.pos,r.pos,this.mark)}merge(t){return t instanceof be&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new be(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new be(e.from,e.to,t.markFromJSON(e.mark))}}wt.jsonID("removeMark",be);class Je extends wt{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return Q.fail("No node at mark step's position");let r=e.type.create(e.attrs,null,this.mark.addToSet(e.marks));return Q.fromReplace(t,this.pos,this.pos+1,new E(x.from(r),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);if(e){let r=this.mark.addToSet(e.marks);if(r.length==e.marks.length){for(let i=0;i<e.marks.length;i++)if(!e.marks[i].isInSet(r))return new Je(this.pos,e.marks[i]);return new Je(this.pos,this.mark)}}return new rr(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new Je(e.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Je(e.pos,t.markFromJSON(e.mark))}}wt.jsonID("addNodeMark",Je);class rr extends wt{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return Q.fail("No node at mark step's position");let r=e.type.create(e.attrs,null,this.mark.removeFromSet(e.marks));return Q.fromReplace(t,this.pos,this.pos+1,new E(x.from(r),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);return!e||!this.mark.isInSet(e.marks)?this:new Je(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new rr(e.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new rr(e.pos,t.markFromJSON(e.mark))}}wt.jsonID("removeNodeMark",rr);class ut extends wt{constructor(t,e,r,i=!1){super(),this.from=t,this.to=e,this.slice=r,this.structure=i}apply(t){return this.structure&&Bs(t,this.from,this.to)?Q.fail("Structure replace would overwrite content"):Q.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new Pt([this.from,this.to-this.from,this.slice.size])}invert(t){return new ut(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deletedAcross&&r.deletedAcross?null:new ut(e.pos,Math.max(e.pos,r.pos),this.slice)}merge(t){if(!(t instanceof ut)||t.structure||this.structure)return null;if(this.from+this.slice.size==t.from&&!this.slice.openEnd&&!t.slice.openStart){let e=this.slice.size+t.slice.size==0?E.empty:new E(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new ut(this.from,this.to+(t.to-t.from),e,this.structure)}else if(t.to==this.from&&!this.slice.openStart&&!t.slice.openEnd){let e=this.slice.size+t.slice.size==0?E.empty:new E(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new ut(t.from,this.to,e,this.structure)}else return null}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new ut(e.from,e.to,E.fromJSON(t,e.slice),!!e.structure)}}wt.jsonID("replace",ut);class st extends wt{constructor(t,e,r,i,o,s,a=!1){super(),this.from=t,this.to=e,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=a}apply(t){if(this.structure&&(Bs(t,this.from,this.gapFrom)||Bs(t,this.gapTo,this.to)))return Q.fail("Structure gap-replace would overwrite content");let e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return Q.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,e.content);return r?Q.fromReplace(t,this.from,this.to,r):Q.fail("Content does not fit in gap")}getMap(){return new Pt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let e=this.gapTo-this.gapFrom;return new st(this.from,this.from+this.slice.size+e,this.from+this.insert,this.from+this.insert+e,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1),i=this.from==this.gapFrom?e.pos:t.map(this.gapFrom,-1),o=this.to==this.gapTo?r.pos:t.map(this.gapTo,1);return e.deletedAcross&&r.deletedAcross||i<e.pos||o>r.pos?null:new st(e.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number"||typeof e.gapFrom!="number"||typeof e.gapTo!="number"||typeof e.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new st(e.from,e.to,e.gapFrom,e.gapTo,E.fromJSON(t,e.slice),e.insert,!!e.structure)}}wt.jsonID("replaceAround",st);function Bs(n,t,e){let r=n.resolve(t),i=e-t,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function Mk(n,t,e,r){let i=[],o=[],s,a;n.doc.nodesBetween(t,e,(l,c,d)=>{if(!l.isInline)return;let h=l.marks;if(!r.isInSet(h)&&d.type.allowsMarkType(r.type)){let u=Math.max(c,t),p=Math.min(c+l.nodeSize,e),f=r.addToSet(h);for(let m=0;m<h.length;m++)h[m].isInSet(f)||(s&&s.to==u&&s.mark.eq(h[m])?s.to=p:i.push(s=new be(u,p,h[m])));a&&a.to==u?a.to=p:o.push(a=new Ge(u,p,r))}}),i.forEach(l=>n.step(l)),o.forEach(l=>n.step(l))}function Tk(n,t,e,r){let i=[],o=0;n.doc.nodesBetween(t,e,(s,a)=>{if(!s.isInline)return;o++;let l=null;if(r instanceof go){let c=s.marks,d;for(;d=r.isInSet(c);)(l||(l=[])).push(d),c=d.removeFromSet(c)}else r?r.isInSet(s.marks)&&(l=[r]):l=s.marks;if(l&&l.length){let c=Math.min(a+s.nodeSize,e);for(let d=0;d<l.length;d++){let h=l[d],u;for(let p=0;p<i.length;p++){let f=i[p];f.step==o-1&&h.eq(i[p].style)&&(u=f)}u?(u.to=c,u.step=o):i.push({style:h,from:Math.max(a,t),to:c,step:o})}}}),i.forEach(s=>n.step(new be(s.from,s.to,s.style)))}function Ea(n,t,e,r=e.contentMatch,i=!0){let o=n.doc.nodeAt(t),s=[],a=t+1;for(let l=0;l<o.childCount;l++){let c=o.child(l),d=a+c.nodeSize,h=r.matchType(c.type);if(!h)s.push(new ut(a,d,E.empty));else{r=h;for(let u=0;u<c.marks.length;u++)e.allowsMarkType(c.marks[u].type)||n.step(new be(a,d,c.marks[u]));if(i&&c.isText&&e.whitespace!="pre"){let u,p=/\r?\n|\r/g,f;for(;u=p.exec(c.text);)f||(f=new E(x.from(e.schema.text(" ",e.allowedMarks(c.marks))),0,0)),s.push(new ut(a+u.index,a+u.index+u[0].length,f))}}a=d}if(!r.validEnd){let l=r.fillBefore(x.empty,!0);n.replace(a,a,new E(l,0,0))}for(let l=s.length-1;l>=0;l--)n.step(s[l])}function Ak(n,t,e){return(t==0||n.canReplace(t,n.childCount))&&(e==n.childCount||n.canReplace(0,e))}function Sr(n){let e=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let i=n.$from.node(r),o=n.$from.index(r),s=n.$to.indexAfter(r);if(r<n.depth&&i.canReplace(o,s,e))return r;if(r==0||i.type.spec.isolating||!Ak(i,o,s))break}return null}function _k(n,t,e){let{$from:r,$to:i,depth:o}=t,s=r.before(o+1),a=i.after(o+1),l=s,c=a,d=x.empty,h=0;for(let f=o,m=!1;f>e;f--)m||r.index(f)>0?(m=!0,d=x.from(r.node(f).copy(d)),h++):l--;let u=x.empty,p=0;for(let f=o,m=!1;f>e;f--)m||i.after(f+1)<i.end(f)?(m=!0,u=x.from(i.node(f).copy(u)),p++):c++;n.step(new st(l,c,s,a,new E(d.append(u),h,p),d.size-h,!0))}function Oa(n,t,e=null,r=n){let i=Dk(n,t),o=i&&$k(r,t);return o?i.map(Zl).concat({type:t,attrs:e}).concat(o.map(Zl)):null}function Zl(n){return{type:n,attrs:null}}function Dk(n,t){let{parent:e,startIndex:r,endIndex:i}=n,o=e.contentMatchAt(r).findWrapping(t);if(!o)return null;let s=o.length?o[0]:t;return e.canReplaceWith(r,i,s)?o:null}function $k(n,t){let{parent:e,startIndex:r,endIndex:i}=n,o=e.child(r),s=t.contentMatch.findWrapping(o.type);if(!s)return null;let l=(s.length?s[s.length-1]:t).contentMatch;for(let c=r;l&&c<i;c++)l=l.matchType(e.child(c).type);return!l||!l.validEnd?null:s}function Nk(n,t,e){let r=x.empty;for(let s=e.length-1;s>=0;s--){if(r.size){let a=e[s].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=x.from(e[s].type.create(e[s].attrs,r))}let i=t.start,o=t.end;n.step(new st(i,o,i,o,new E(r,0,0),e.length,!0))}function Ik(n,t,e,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=n.steps.length;n.doc.nodesBetween(t,e,(s,a)=>{let l=typeof i=="function"?i(s):i;if(s.isTextblock&&!s.hasMarkup(r,l)&&Pk(n.doc,n.mapping.slice(o).map(a),r)){let c=null;if(r.schema.linebreakReplacement){let p=r.whitespace=="pre",f=!!r.contentMatch.matchType(r.schema.linebreakReplacement);p&&!f?c=!1:!p&&f&&(c=!0)}c===!1&&Th(n,s,a,o),Ea(n,n.mapping.slice(o).map(a,1),r,void 0,c===null);let d=n.mapping.slice(o),h=d.map(a,1),u=d.map(a+s.nodeSize,1);return n.step(new st(h,u,h+1,u-1,new E(x.from(r.create(l,null,s.marks)),0,0),1,!0)),c===!0&&Mh(n,s,a,o),!1}})}function Mh(n,t,e,r){t.forEach((i,o)=>{if(i.isText){let s,a=/\r?\n|\r/g;for(;s=a.exec(i.text);){let l=n.mapping.slice(r).map(e+1+o+s.index);n.replaceWith(l,l+1,t.type.schema.linebreakReplacement.create())}}})}function Th(n,t,e,r){t.forEach((i,o)=>{if(i.type==i.type.schema.linebreakReplacement){let s=n.mapping.slice(r).map(e+1+o);n.replaceWith(s,s+1,t.type.schema.text(`
`))}})}function Pk(n,t,e){let r=n.resolve(t),i=r.index();return r.parent.canReplaceWith(i,i+1,e)}function Rk(n,t,e,r,i){let o=n.doc.nodeAt(t);if(!o)throw new RangeError("No node at given position");e||(e=o.type);let s=e.create(r,null,i||o.marks);if(o.isLeaf)return n.replaceWith(t,t+o.nodeSize,s);if(!e.validContent(o.content))throw new RangeError("Invalid content for node type "+e.name);n.step(new st(t,t+o.nodeSize,t+1,t+o.nodeSize-1,new E(x.from(s),0,0),1,!0))}function Yn(n,t,e=1,r){let i=n.resolve(t),o=i.depth-e,s=r&&r[r.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let c=i.depth-1,d=e-2;c>o;c--,d--){let h=i.node(c),u=i.index(c);if(h.type.spec.isolating)return!1;let p=h.content.cutByIndex(u,h.childCount),f=r&&r[d+1];f&&(p=p.replaceChild(0,f.type.create(f.attrs)));let m=r&&r[d]||h;if(!h.canReplace(u+1,h.childCount)||!m.type.validContent(p))return!1}let a=i.indexAfter(o),l=r&&r[0];return i.node(o).canReplaceWith(a,a,l?l.type:i.node(o+1).type)}function Lk(n,t,e=1,r){let i=n.doc.resolve(t),o=x.empty,s=x.empty;for(let a=i.depth,l=i.depth-e,c=e-1;a>l;a--,c--){o=x.from(i.node(a).copy(o));let d=r&&r[c];s=x.from(d?d.type.create(d.attrs,s):i.node(a).copy(s))}n.step(new ut(t,t,new E(o.append(s),e,e),!0))}function hn(n,t){let e=n.resolve(t),r=e.index();return Ah(e.nodeBefore,e.nodeAfter)&&e.parent.canReplace(r,r+1)}function zk(n,t){t.content.size||n.type.compatibleContent(t.type);let e=n.contentMatchAt(n.childCount),{linebreakReplacement:r}=n.type.schema;for(let i=0;i<t.childCount;i++){let o=t.child(i),s=o.type==r?n.type.schema.nodes.text:o.type;if(e=e.matchType(s),!e||!n.type.allowsMarks(o.marks))return!1}return e.validEnd}function Ah(n,t){return!!(n&&t&&!n.isLeaf&&zk(n,t))}function _h(n,t,e=-1){let r=n.resolve(t);for(let i=r.depth;;i--){let o,s,a=r.index(i);if(i==r.depth?(o=r.nodeBefore,s=r.nodeAfter):e>0?(o=r.node(i+1),a++,s=r.node(i).maybeChild(a)):(o=r.node(i).maybeChild(a-1),s=r.node(i+1)),o&&!o.isTextblock&&Ah(o,s)&&r.node(i).canReplace(a,a+1))return t;if(i==0)break;t=e<0?r.before(i):r.after(i)}}function Bk(n,t,e){let r=null,{linebreakReplacement:i}=n.doc.type.schema,o=n.doc.resolve(t-e),s=o.node().type;if(i&&s.inlineContent){let d=s.whitespace=="pre",h=!!s.contentMatch.matchType(i);d&&!h?r=!1:!d&&h&&(r=!0)}let a=n.steps.length;if(r===!1){let d=n.doc.resolve(t+e);Th(n,d.node(),d.before(),a)}s.inlineContent&&Ea(n,t+e-1,s,o.node().contentMatchAt(o.index()),r==null);let l=n.mapping.slice(a),c=l.map(t-e);if(n.step(new ut(c,l.map(t+e,-1),E.empty,!0)),r===!0){let d=n.doc.resolve(c);Mh(n,d.node(),d.before(),n.steps.length)}return n}function Fk(n,t,e){let r=n.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),e))return t;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let o=r.index(i);if(r.node(i).canReplaceWith(o,o,e))return r.before(i+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let o=r.indexAfter(i);if(r.node(i).canReplaceWith(o,o,e))return r.after(i+1);if(o<r.node(i).childCount)return null}return null}function jk(n,t,e){let r=n.resolve(t);if(!e.content.size)return t;let i=e.content;for(let o=0;o<e.openStart;o++)i=i.firstChild.content;for(let o=1;o<=(e.openStart==0&&e.size?2:1);o++)for(let s=r.depth;s>=0;s--){let a=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,l=r.index(s)+(a>0?1:0),c=r.node(s),d=!1;if(o==1)d=c.canReplace(l,l,i);else{let h=c.contentMatchAt(l).findWrapping(i.firstChild.type);d=h&&c.canReplaceWith(l,l,h[0])}if(d)return a==0?r.pos:a<0?r.before(s+1):r.after(s+1)}return null}function Ma(n,t,e=t,r=E.empty){if(t==e&&!r.size)return null;let i=n.resolve(t),o=n.resolve(e);return Dh(i,o,r)?new ut(t,e,r):new Vk(i,o,r).fit()}function Dh(n,t,e){return!e.openStart&&!e.openEnd&&n.start()==t.start()&&n.parent.canReplace(n.index(),t.index(),e.content)}class Vk{constructor(t,e,r){this.$from=t,this.$to=e,this.unplaced=r,this.frontier=[],this.placed=x.empty;for(let i=0;i<=t.depth;i++){let o=t.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(t.indexAfter(i))})}for(let i=t.depth;i>0;i--)this.placed=x.from(t.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),e=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(t<0?this.$to:r.doc.resolve(t));if(!i)return null;let o=this.placed,s=r.depth,a=i.depth;for(;s&&a&&o.childCount==1;)o=o.firstChild.content,s--,a--;let l=new E(o,s,a);return t>-1?new st(r.pos,t,this.$to.pos,this.$to.end(),l,e):l.size||r.pos!=this.$to.pos?new ut(r.pos,i.pos,l):null}findFittable(){let t=this.unplaced.openStart;for(let e=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<t;r++){let o=e.firstChild;if(e.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){t=r;break}e=o.content}for(let e=1;e<=2;e++)for(let r=e==1?t:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=Ko(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let s=i.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],d,h=null;if(e==1&&(s?c.matchType(s.type)||(h=c.fillBefore(x.from(s),!1)):o&&l.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:a,parent:o,inject:h};if(e==2&&s&&(d=c.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:a,parent:o,wrap:d};if(o&&c.matchType(o.type))break}}}openMore(){let{content:t,openStart:e,openEnd:r}=this.unplaced,i=Ko(t,e);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new E(t,e+1,Math.max(r,i.size+e>=t.size-r?e+1:0)),!0)}dropNode(){let{content:t,openStart:e,openEnd:r}=this.unplaced,i=Ko(t,e);if(i.childCount<=1&&e>0){let o=t.size-e<=e+i.size;this.unplaced=new E(Dr(t,e-1,1),e-1,o?e-1:r)}else this.unplaced=new E(Dr(t,e,1),e,r)}placeNodes({sliceDepth:t,frontierDepth:e,parent:r,inject:i,wrap:o}){for(;this.depth>e;)this.closeFrontierNode();if(o)for(let m=0;m<o.length;m++)this.openFrontierNode(o[m]);let s=this.unplaced,a=r?r.content:s.content,l=s.openStart-t,c=0,d=[],{match:h,type:u}=this.frontier[e];if(i){for(let m=0;m<i.childCount;m++)d.push(i.child(m));h=h.matchFragment(i)}let p=a.size+t-(s.content.size-s.openEnd);for(;c<a.childCount;){let m=a.child(c),g=h.matchType(m.type);if(!g)break;c++,(c>1||l==0||m.content.size)&&(h=g,d.push($h(m.mark(u.allowedMarks(m.marks)),c==1?l:0,c==a.childCount?p:-1)))}let f=c==a.childCount;f||(p=-1),this.placed=$r(this.placed,e,x.from(d)),this.frontier[e].match=h,f&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,g=a;m<p;m++){let y=g.lastChild;this.frontier.push({type:y.type,match:y.contentMatchAt(y.childCount)}),g=y.content}this.unplaced=f?t==0?E.empty:new E(Dr(s.content,t-1,1),t-1,p<0?s.openEnd:t-1):new E(Dr(s.content,t,c),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let t=this.frontier[this.depth],e;if(!t.type.isTextblock||!Go(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(t){t:for(let e=Math.min(this.depth,t.depth);e>=0;e--){let{match:r,type:i}=this.frontier[e],o=e<t.depth&&t.end(e+1)==t.pos+(t.depth-(e+1)),s=Go(t,e,i,r,o);if(s){for(let a=e-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],d=Go(t,a,c,l,!0);if(!d||d.childCount)continue t}return{depth:e,fit:s,move:o?t.doc.resolve(t.after(e+1)):t}}}}close(t){let e=this.findCloseLevel(t);if(!e)return null;for(;this.depth>e.depth;)this.closeFrontierNode();e.fit.childCount&&(this.placed=$r(this.placed,e.depth,e.fit)),t=e.move;for(let r=e.depth+1;r<=t.depth;r++){let i=t.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,t.index(r));this.openFrontierNode(i.type,i.attrs,o)}return t}openFrontierNode(t,e=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(t),this.placed=$r(this.placed,this.depth,x.from(t.create(e,r))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(x.empty,!0);e.childCount&&(this.placed=$r(this.placed,this.frontier.length,e))}}function Dr(n,t,e){return t==0?n.cutByIndex(e,n.childCount):n.replaceChild(0,n.firstChild.copy(Dr(n.firstChild.content,t-1,e)))}function $r(n,t,e){return t==0?n.append(e):n.replaceChild(n.childCount-1,n.lastChild.copy($r(n.lastChild.content,t-1,e)))}function Ko(n,t){for(let e=0;e<t;e++)n=n.firstChild.content;return n}function $h(n,t,e){if(t<=0)return n;let r=n.content;return t>1&&(r=r.replaceChild(0,$h(r.firstChild,t-1,r.childCount==1?e-1:0))),t>0&&(r=n.type.contentMatch.fillBefore(r).append(r),e<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(x.empty,!0)))),n.copy(r)}function Go(n,t,e,r,i){let o=n.node(t),s=i?n.indexAfter(t):n.index(t);if(s==o.childCount&&!e.compatibleContent(o.type))return null;let a=r.fillBefore(o.content,!0,s);return a&&!Hk(e,o.content,s)?a:null}function Hk(n,t,e){for(let r=e;r<t.childCount;r++)if(!n.allowsMarks(t.child(r).marks))return!0;return!1}function Wk(n){return n.spec.defining||n.spec.definingForContent}function qk(n,t,e,r){if(!r.size)return n.deleteRange(t,e);let i=n.doc.resolve(t),o=n.doc.resolve(e);if(Dh(i,o,r))return n.step(new ut(t,e,r));let s=Ih(i,n.doc.resolve(e));s[s.length-1]==0&&s.pop();let a=-(i.depth+1);s.unshift(a);for(let u=i.depth,p=i.pos-1;u>0;u--,p--){let f=i.node(u).type.spec;if(f.defining||f.definingAsContext||f.isolating)break;s.indexOf(u)>-1?a=u:i.before(u)==p&&s.splice(1,0,-u)}let l=s.indexOf(a),c=[],d=r.openStart;for(let u=r.content,p=0;;p++){let f=u.firstChild;if(c.push(f),p==r.openStart)break;u=f.content}for(let u=d-1;u>=0;u--){let p=c[u],f=Wk(p.type);if(f&&!p.sameMarkup(i.node(Math.abs(a)-1)))d=u;else if(f||!p.type.isTextblock)break}for(let u=r.openStart;u>=0;u--){let p=(u+d+1)%(r.openStart+1),f=c[p];if(f)for(let m=0;m<s.length;m++){let g=s[(m+l)%s.length],y=!0;g<0&&(y=!1,g=-g);let w=i.node(g-1),k=i.index(g-1);if(w.canReplaceWith(k,k,f.type,f.marks))return n.replace(i.before(g),y?o.after(g):e,new E(Nh(r.content,0,r.openStart,p),p,r.openEnd))}}let h=n.steps.length;for(let u=s.length-1;u>=0&&(n.replace(t,e,r),!(n.steps.length>h));u--){let p=s[u];p<0||(t=i.before(p),e=o.after(p))}}function Nh(n,t,e,r,i){if(t<e){let o=n.firstChild;n=n.replaceChild(0,o.copy(Nh(o.content,t+1,e,r,o)))}if(t>r){let o=i.contentMatchAt(0),s=o.fillBefore(n).append(n);n=s.append(o.matchFragment(s).fillBefore(x.empty,!0))}return n}function Uk(n,t,e,r){if(!r.isInline&&t==e&&n.doc.resolve(t).parent.content.size){let i=Fk(n.doc,t,r.type);i!=null&&(t=e=i)}n.replaceRange(t,e,new E(x.from(r),0,0))}function Kk(n,t,e){let r=n.doc.resolve(t),i=n.doc.resolve(e),o=Ih(r,i);for(let s=0;s<o.length;s++){let a=o[s],l=s==o.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return n.delete(r.start(a),i.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),i.indexAfter(a-1))))return n.delete(r.before(a),i.after(a))}for(let s=1;s<=r.depth&&s<=i.depth;s++)if(t-r.start(s)==r.depth-s&&e>r.end(s)&&i.end(s)-e!=i.depth-s&&r.start(s-1)==i.start(s-1)&&r.node(s-1).canReplace(r.index(s-1),i.index(s-1)))return n.delete(r.before(s),e);n.delete(t,e)}function Ih(n,t){let e=[],r=Math.min(n.depth,t.depth);for(let i=r;i>=0;i--){let o=n.start(i);if(o<n.pos-(n.depth-i)||t.end(i)>t.pos+(t.depth-i)||n.node(i).type.spec.isolating||t.node(i).type.spec.isolating)break;(o==t.start(i)||i==n.depth&&i==t.depth&&n.parent.inlineContent&&t.parent.inlineContent&&i&&t.start(i-1)==o-1)&&e.push(i)}return e}class Xn extends wt{constructor(t,e,r){super(),this.pos=t,this.attr=e,this.value=r}apply(t){let e=t.nodeAt(this.pos);if(!e)return Q.fail("No node at attribute step's position");let r=Object.create(null);for(let o in e.attrs)r[o]=e.attrs[o];r[this.attr]=this.value;let i=e.type.create(r,null,e.marks);return Q.fromReplace(t,this.pos,this.pos+1,new E(x.from(i),0,e.isLeaf?0:1))}getMap(){return Pt.empty}invert(t){return new Xn(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new Xn(e.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,e){if(typeof e.pos!="number"||typeof e.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Xn(e.pos,e.attr,e.value)}}wt.jsonID("attr",Xn);class Gr extends wt{constructor(t,e){super(),this.attr=t,this.value=e}apply(t){let e=Object.create(null);for(let i in t.attrs)e[i]=t.attrs[i];e[this.attr]=this.value;let r=t.type.create(e,t.content,t.marks);return Q.ok(r)}getMap(){return Pt.empty}invert(t){return new Gr(this.attr,t.attrs[this.attr])}map(t){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,e){if(typeof e.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Gr(e.attr,e.value)}}wt.jsonID("docAttr",Gr);let ir=class extends Error{};ir=function n(t){let e=Error.call(this,t);return e.__proto__=n.prototype,e};ir.prototype=Object.create(Error.prototype);ir.prototype.constructor=ir;ir.prototype.name="TransformError";class Gk{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new Jn}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let e=this.maybeStep(t);if(e.failed)throw new ir(e.failed);return this}maybeStep(t){let e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e}get docChanged(){return this.steps.length>0}addStep(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e}replace(t,e=t,r=E.empty){let i=Ma(this.doc,t,e,r);return i&&this.step(i),this}replaceWith(t,e,r){return this.replace(t,e,new E(x.from(r),0,0))}delete(t,e){return this.replace(t,e,E.empty)}insert(t,e){return this.replaceWith(t,t,e)}replaceRange(t,e,r){return qk(this,t,e,r),this}replaceRangeWith(t,e,r){return Uk(this,t,e,r),this}deleteRange(t,e){return Kk(this,t,e),this}lift(t,e){return _k(this,t,e),this}join(t,e=1){return Bk(this,t,e),this}wrap(t,e){return Nk(this,t,e),this}setBlockType(t,e=t,r,i=null){return Ik(this,t,e,r,i),this}setNodeMarkup(t,e,r=null,i){return Rk(this,t,e,r,i),this}setNodeAttribute(t,e,r){return this.step(new Xn(t,e,r)),this}setDocAttribute(t,e){return this.step(new Gr(t,e)),this}addNodeMark(t,e){return this.step(new Je(t,e)),this}removeNodeMark(t,e){if(!(e instanceof W)){let r=this.doc.nodeAt(t);if(!r)throw new RangeError("No node at position "+t);if(e=e.isInSet(r.marks),!e)return this}return this.step(new rr(t,e)),this}split(t,e=1,r){return Lk(this,t,e,r),this}addMark(t,e,r){return Mk(this,t,e,r),this}removeMark(t,e,r){return Tk(this,t,e,r),this}clearIncompatible(t,e,r){return Ea(this,t,e,r),this}}const Jo=Object.create(null);class L{constructor(t,e,r){this.$anchor=t,this.$head=e,this.ranges=r||[new Jk(t.min(e),t.max(e))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let t=this.ranges;for(let e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(t,e=E.empty){let r=e.content.lastChild,i=null;for(let a=0;a<e.openEnd;a++)i=r,r=r.lastChild;let o=t.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:l,$to:c}=s[a],d=t.mapping.slice(o);t.replaceRange(d.map(l.pos),d.map(c.pos),a?E.empty:e),a==0&&ec(t,o,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(t,e){let r=t.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:s,$to:a}=i[o],l=t.mapping.slice(r),c=l.map(s.pos),d=l.map(a.pos);o?t.deleteRange(c,d):(t.replaceRangeWith(c,d,e),ec(t,r,e.isInline?-1:1))}}static findFrom(t,e,r=!1){let i=t.parent.inlineContent?new B(t):Hn(t.node(0),t.parent,t.pos,t.index(),e,r);if(i)return i;for(let o=t.depth-1;o>=0;o--){let s=e<0?Hn(t.node(0),t.node(o),t.before(o+1),t.index(o),e,r):Hn(t.node(0),t.node(o),t.after(o+1),t.index(o)+1,e,r);if(s)return s}return null}static near(t,e=1){return this.findFrom(t,e)||this.findFrom(t,-e)||new ee(t.node(0))}static atStart(t){return Hn(t,t,0,0,1)||new ee(t)}static atEnd(t){return Hn(t,t,t.content.size,t.childCount,-1)||new ee(t)}static fromJSON(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Jo[e.type];if(!r)throw new RangeError(`No selection type ${e.type} defined`);return r.fromJSON(t,e)}static jsonID(t,e){if(t in Jo)throw new RangeError("Duplicate use of selection JSON ID "+t);return Jo[t]=e,e.prototype.jsonID=t,e}getBookmark(){return B.between(this.$anchor,this.$head).getBookmark()}}L.prototype.visible=!0;class Jk{constructor(t,e){this.$from=t,this.$to=e}}let Ql=!1;function tc(n){!Ql&&!n.parent.inlineContent&&(Ql=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class B extends L{constructor(t,e=t){tc(t),tc(e),super(t,e)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,e){let r=t.resolve(e.map(this.head));if(!r.parent.inlineContent)return L.near(r);let i=t.resolve(e.map(this.anchor));return new B(i.parent.inlineContent?i:r,r)}replace(t,e=E.empty){if(super.replace(t,e),e==E.empty){let r=this.$from.marksAcross(this.$to);r&&t.ensureMarks(r)}}eq(t){return t instanceof B&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new bo(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,e){if(typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new B(t.resolve(e.anchor),t.resolve(e.head))}static create(t,e,r=e){let i=t.resolve(e);return new this(i,r==e?i:t.resolve(r))}static between(t,e,r){let i=t.pos-e.pos;if((!r||i)&&(r=i>=0?1:-1),!e.parent.inlineContent){let o=L.findFrom(e,r,!0)||L.findFrom(e,-r,!0);if(o)e=o.$head;else return L.near(e,r)}return t.parent.inlineContent||(i==0?t=e:(t=(L.findFrom(t,-r,!0)||L.findFrom(t,r,!0)).$anchor,t.pos<e.pos!=i<0&&(t=e))),new B(t,e)}}L.jsonID("text",B);class bo{constructor(t,e){this.anchor=t,this.head=e}map(t){return new bo(t.map(this.anchor),t.map(this.head))}resolve(t){return B.between(t.resolve(this.anchor),t.resolve(this.head))}}class _ extends L{constructor(t){let e=t.nodeAfter,r=t.node(0).resolve(t.pos+e.nodeSize);super(t,r),this.node=e}map(t,e){let{deleted:r,pos:i}=e.mapResult(this.anchor),o=t.resolve(i);return r?L.near(o):new _(o)}content(){return new E(x.from(this.node),0,0)}eq(t){return t instanceof _&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Ta(this.anchor)}static fromJSON(t,e){if(typeof e.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new _(t.resolve(e.anchor))}static create(t,e){return new _(t.resolve(e))}static isSelectable(t){return!t.isText&&t.type.spec.selectable!==!1}}_.prototype.visible=!1;L.jsonID("node",_);class Ta{constructor(t){this.anchor=t}map(t){let{deleted:e,pos:r}=t.mapResult(this.anchor);return e?new bo(r,r):new Ta(r)}resolve(t){let e=t.resolve(this.anchor),r=e.nodeAfter;return r&&_.isSelectable(r)?new _(e):L.near(e)}}class ee extends L{constructor(t){super(t.resolve(0),t.resolve(t.content.size))}replace(t,e=E.empty){if(e==E.empty){t.delete(0,t.doc.content.size);let r=L.atStart(t.doc);r.eq(t.selection)||t.setSelection(r)}else super.replace(t,e)}toJSON(){return{type:"all"}}static fromJSON(t){return new ee(t)}map(t){return new ee(t)}eq(t){return t instanceof ee}getBookmark(){return Yk}}L.jsonID("all",ee);const Yk={map(){return this},resolve(n){return new ee(n)}};function Hn(n,t,e,r,i,o=!1){if(t.inlineContent)return B.create(n,e);for(let s=r-(i>0?0:1);i>0?s<t.childCount:s>=0;s+=i){let a=t.child(s);if(a.isAtom){if(!o&&_.isSelectable(a))return _.create(n,e-(i<0?a.nodeSize:0))}else{let l=Hn(n,a,e+i,i<0?a.childCount:0,i,o);if(l)return l}e+=a.nodeSize*i}return null}function ec(n,t,e){let r=n.steps.length-1;if(r<t)return;let i=n.steps[r];if(!(i instanceof ut||i instanceof st))return;let o=n.mapping.maps[r],s;o.forEach((a,l,c,d)=>{s==null&&(s=d)}),n.setSelection(L.near(n.doc.resolve(s),e))}const nc=1,yi=2,rc=4;class Xk extends Gk{constructor(t){super(t.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=t.selection,this.storedMarks=t.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=(this.updated|nc)&~yi,this.storedMarks=null,this}get selectionSet(){return(this.updated&nc)>0}setStoredMarks(t){return this.storedMarks=t,this.updated|=yi,this}ensureMarks(t){return W.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this}addStoredMark(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&yi)>0}addStep(t,e){super.addStep(t,e),this.updated=this.updated&~yi,this.storedMarks=null}setTime(t){return this.time=t,this}replaceSelection(t){return this.selection.replace(this,t),this}replaceSelectionWith(t,e=!0){let r=this.selection;return e&&(t=t.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||W.none))),r.replaceWith(this,t),this}deleteSelection(){return this.selection.replace(this),this}insertText(t,e,r){let i=this.doc.type.schema;if(e==null)return t?this.replaceSelectionWith(i.text(t),!0):this.deleteSelection();{if(r==null&&(r=e),r=r??e,!t)return this.deleteRange(e,r);let o=this.storedMarks;if(!o){let s=this.doc.resolve(e);o=r==e?s.marks():s.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(e,r,i.text(t,o)),this.selection.empty||this.setSelection(L.near(this.selection.$to)),this}}setMeta(t,e){return this.meta[typeof t=="string"?t:t.key]=e,this}getMeta(t){return this.meta[typeof t=="string"?t:t.key]}get isGeneric(){for(let t in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=rc,this}get scrolledIntoView(){return(this.updated&rc)>0}}function ic(n,t){return!t||!n?n:n.bind(t)}class Nr{constructor(t,e,r){this.name=t,this.init=ic(e.init,r),this.apply=ic(e.apply,r)}}const Zk=[new Nr("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new Nr("selection",{init(n,t){return n.selection||L.atStart(t.doc)},apply(n){return n.selection}}),new Nr("storedMarks",{init(n){return n.storedMarks||null},apply(n,t,e,r){return r.selection.$cursor?n.storedMarks:null}}),new Nr("scrollToSelection",{init(){return 0},apply(n,t){return n.scrolledIntoView?t+1:t}})];class Yo{constructor(t,e){this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=Zk.slice(),e&&e.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Nr(r.key,r.spec.state,r))})}}class qn{constructor(t){this.config=t}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(t){return this.applyTransaction(t).state}filterTransaction(t,e=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=e){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,t,this))return!1}return!0}applyTransaction(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};let e=[t],r=this.applyInner(t),i=null;for(;;){let o=!1;for(let s=0;s<this.config.plugins.length;s++){let a=this.config.plugins[s];if(a.spec.appendTransaction){let l=i?i[s].n:0,c=i?i[s].state:this,d=l<e.length&&a.spec.appendTransaction.call(a,l?e.slice(l):e,c,r);if(d&&r.filterTransaction(d,s)){if(d.setMeta("appendedTransaction",t),!i){i=[];for(let h=0;h<this.config.plugins.length;h++)i.push(h<s?{state:r,n:e.length}:{state:this,n:0})}e.push(d),r=r.applyInner(d),o=!0}i&&(i[s]={state:r,n:e.length})}}if(!o)return{state:r,transactions:e}}}applyInner(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let e=new qn(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let o=r[i];e[o.name]=o.apply(t,this[o.name],this,e)}return e}get tr(){return new Xk(this)}static create(t){let e=new Yo(t.doc?t.doc.type.schema:t.schema,t.plugins),r=new qn(e);for(let i=0;i<e.fields.length;i++)r[e.fields[i].name]=e.fields[i].init(t,r);return r}reconfigure(t){let e=new Yo(this.schema,t.plugins),r=e.fields,i=new qn(e);for(let o=0;o<r.length;o++){let s=r[o].name;i[s]=this.hasOwnProperty(s)?this[s]:r[o].init(t,i)}return i}toJSON(t){let e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map(r=>r.toJSON())),t&&typeof t=="object")for(let r in t){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=t[r],o=i.spec.state;o&&o.toJSON&&(e[r]=o.toJSON.call(i,this[i.key]))}return e}static fromJSON(t,e,r){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");let i=new Yo(t.schema,t.plugins),o=new qn(i);return i.fields.forEach(s=>{if(s.name=="doc")o.doc=Sn.fromJSON(t.schema,e.doc);else if(s.name=="selection")o.selection=L.fromJSON(o.doc,e.selection);else if(s.name=="storedMarks")e.storedMarks&&(o.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==s.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(e,a)){o[s.name]=c.fromJSON.call(l,t,e[a],o);return}}o[s.name]=s.init(t,o)}}),o}}function Ph(n,t,e){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(t):r=="handleDOMEvents"&&(i=Ph(i,t,{})),e[r]=i}return e}class Me{constructor(t){this.spec=t,this.props={},t.props&&Ph(t.props,this,this.props),this.key=t.key?t.key.key:Rh("plugin")}getState(t){return t[this.key]}}const Xo=Object.create(null);function Rh(n){return n in Xo?n+"$"+ ++Xo[n]:(Xo[n]=0,n+"$")}class Bn{constructor(t="key"){this.key=Rh(t)}get(t){return t.config.pluginsByKey[this.key]}getState(t){return t[this.key]}}const pt=function(n){for(var t=0;;t++)if(n=n.previousSibling,!n)return t},Jr=function(n){let t=n.assignedSlot||n.parentNode;return t&&t.nodeType==11?t.host:t};let Fs=null;const _e=function(n,t,e){let r=Fs||(Fs=document.createRange());return r.setEnd(n,e??n.nodeValue.length),r.setStart(n,t||0),r},Qk=function(){Fs=null},Nn=function(n,t,e,r){return e&&(oc(n,t,e,r,-1)||oc(n,t,e,r,1))},tS=/^(img|br|input|textarea|hr)$/i;function oc(n,t,e,r,i){for(;;){if(n==e&&t==r)return!0;if(t==(i<0?0:Wt(n))){let o=n.parentNode;if(!o||o.nodeType!=1||ii(n)||tS.test(n.nodeName)||n.contentEditable=="false")return!1;t=pt(n)+(i<0?0:1),n=o}else if(n.nodeType==1){if(n=n.childNodes[t+(i<0?-1:0)],n.contentEditable=="false")return!1;t=i<0?Wt(n):0}else return!1}}function Wt(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function eS(n,t){for(;;){if(n.nodeType==3&&t)return n;if(n.nodeType==1&&t>0){if(n.contentEditable=="false")return null;n=n.childNodes[t-1],t=Wt(n)}else if(n.parentNode&&!ii(n))t=pt(n),n=n.parentNode;else return null}}function nS(n,t){for(;;){if(n.nodeType==3&&t<n.nodeValue.length)return n;if(n.nodeType==1&&t<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[t],t=0}else if(n.parentNode&&!ii(n))t=pt(n)+1,n=n.parentNode;else return null}}function rS(n,t,e){for(let r=t==0,i=t==Wt(n);r||i;){if(n==e)return!0;let o=pt(n);if(n=n.parentNode,!n)return!1;r=r&&o==0,i=i&&o==Wt(n)}}function ii(n){let t;for(let e=n;e&&!(t=e.pmViewDesc);e=e.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==n||t.contentDOM==n)}const yo=function(n){return n.focusNode&&Nn(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function bn(n,t){let e=document.createEvent("Event");return e.initEvent("keydown",!0,!0),e.keyCode=n,e.key=e.code=t,e}function iS(n){let t=n.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}function oS(n,t,e){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(t,e);if(r)return{node:r.offsetNode,offset:Math.min(Wt(r.offsetNode),r.offset)}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(t,e);if(r)return{node:r.startContainer,offset:Math.min(Wt(r.startContainer),r.startOffset)}}}const ke=typeof navigator<"u"?navigator:null,sc=typeof document<"u"?document:null,un=ke&&ke.userAgent||"",js=/Edge\/(\d+)/.exec(un),Lh=/MSIE \d/.exec(un),Vs=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(un),At=!!(Lh||Vs||js),Xe=Lh?document.documentMode:Vs?+Vs[1]:js?+js[1]:0,ie=!At&&/gecko\/(\d+)/i.test(un);ie&&+(/Firefox\/(\d+)/.exec(un)||[0,0])[1];const Hs=!At&&/Chrome\/(\d+)/.exec(un),vt=!!Hs,zh=Hs?+Hs[1]:0,Ct=!At&&!!ke&&/Apple Computer/.test(ke.vendor),or=Ct&&(/Mobile\/\w+/.test(un)||!!ke&&ke.maxTouchPoints>2),Ht=or||(ke?/Mac/.test(ke.platform):!1),sS=ke?/Win/.test(ke.platform):!1,Ne=/Android \d/.test(un),oi=!!sc&&"webkitFontSmoothing"in sc.documentElement.style,aS=oi?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function lS(n){let t=n.defaultView&&n.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function Ae(n,t){return typeof n=="number"?n:n[t]}function cS(n){let t=n.getBoundingClientRect(),e=t.width/n.offsetWidth||1,r=t.height/n.offsetHeight||1;return{left:t.left,right:t.left+n.clientWidth*e,top:t.top,bottom:t.top+n.clientHeight*r}}function ac(n,t,e){let r=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,o=n.dom.ownerDocument;for(let s=e||n.dom;s;s=Jr(s)){if(s.nodeType!=1)continue;let a=s,l=a==o.body,c=l?lS(o):cS(a),d=0,h=0;if(t.top<c.top+Ae(r,"top")?h=-(c.top-t.top+Ae(i,"top")):t.bottom>c.bottom-Ae(r,"bottom")&&(h=t.bottom-t.top>c.bottom-c.top?t.top+Ae(i,"top")-c.top:t.bottom-c.bottom+Ae(i,"bottom")),t.left<c.left+Ae(r,"left")?d=-(c.left-t.left+Ae(i,"left")):t.right>c.right-Ae(r,"right")&&(d=t.right-c.right+Ae(i,"right")),d||h)if(l)o.defaultView.scrollBy(d,h);else{let u=a.scrollLeft,p=a.scrollTop;h&&(a.scrollTop+=h),d&&(a.scrollLeft+=d);let f=a.scrollLeft-u,m=a.scrollTop-p;t={left:t.left-f,top:t.top-m,right:t.right-f,bottom:t.bottom-m}}if(l||/^(fixed|sticky)$/.test(getComputedStyle(s).position))break}}function dS(n){let t=n.dom.getBoundingClientRect(),e=Math.max(0,t.top),r,i;for(let o=(t.left+t.right)/2,s=e+1;s<Math.min(innerHeight,t.bottom);s+=5){let a=n.root.elementFromPoint(o,s);if(!a||a==n.dom||!n.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=e-20){r=a,i=l.top;break}}return{refDOM:r,refTop:i,stack:Bh(n.dom)}}function Bh(n){let t=[],e=n.ownerDocument;for(let r=n;r&&(t.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=e);r=Jr(r));return t}function hS({refDOM:n,refTop:t,stack:e}){let r=n?n.getBoundingClientRect().top:0;Fh(e,r==0?0:r-t)}function Fh(n,t){for(let e=0;e<n.length;e++){let{dom:r,top:i,left:o}=n[e];r.scrollTop!=i+t&&(r.scrollTop=i+t),r.scrollLeft!=o&&(r.scrollLeft=o)}}let jn=null;function uS(n){if(n.setActive)return n.setActive();if(jn)return n.focus(jn);let t=Bh(n);n.focus(jn==null?{get preventScroll(){return jn={preventScroll:!0},!0}}:void 0),jn||(jn=!1,Fh(t,0))}function jh(n,t){let e,r=2e8,i,o=0,s=t.top,a=t.top,l,c;for(let d=n.firstChild,h=0;d;d=d.nextSibling,h++){let u;if(d.nodeType==1)u=d.getClientRects();else if(d.nodeType==3)u=_e(d).getClientRects();else continue;for(let p=0;p<u.length;p++){let f=u[p];if(f.top<=s&&f.bottom>=a){s=Math.max(f.bottom,s),a=Math.min(f.top,a);let m=f.left>t.left?f.left-t.left:f.right<t.left?t.left-f.right:0;if(m<r){e=d,r=m,i=m&&e.nodeType==3?{left:f.right<t.left?f.right:f.left,top:t.top}:t,d.nodeType==1&&m&&(o=h+(t.left>=(f.left+f.right)/2?1:0));continue}}else f.top>t.top&&!l&&f.left<=t.left&&f.right>=t.left&&(l=d,c={left:Math.max(f.left,Math.min(f.right,t.left)),top:f.top});!e&&(t.left>=f.right&&t.top>=f.top||t.left>=f.left&&t.top>=f.bottom)&&(o=h+1)}}return!e&&l&&(e=l,i=c,r=0),e&&e.nodeType==3?pS(e,i):!e||r&&e.nodeType==1?{node:n,offset:o}:jh(e,i)}function pS(n,t){let e=n.nodeValue.length,r=document.createRange();for(let i=0;i<e;i++){r.setEnd(n,i+1),r.setStart(n,i);let o=je(r,1);if(o.top!=o.bottom&&Aa(t,o))return{node:n,offset:i+(t.left>=(o.left+o.right)/2?1:0)}}return{node:n,offset:0}}function Aa(n,t){return n.left>=t.left-1&&n.left<=t.right+1&&n.top>=t.top-1&&n.top<=t.bottom+1}function fS(n,t){let e=n.parentNode;return e&&/^li$/i.test(e.nodeName)&&t.left<n.getBoundingClientRect().left?e:n}function mS(n,t,e){let{node:r,offset:i}=jh(t,e),o=-1;if(r.nodeType==1&&!r.firstChild){let s=r.getBoundingClientRect();o=s.left!=s.right&&e.left>(s.left+s.right)/2?1:-1}return n.docView.posFromDOM(r,i,o)}function gS(n,t,e,r){let i=-1;for(let o=t,s=!1;o!=n.dom;){let a=n.docView.nearestDesc(o,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&(!s&&l.left>r.left||l.top>r.top?i=a.posBefore:(!s&&l.right<r.left||l.bottom<r.top)&&(i=a.posAfter),s=!0),!a.contentDOM&&i<0&&!a.node.isText))return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;o=a.dom.parentNode}return i>-1?i:n.docView.posFromDOM(t,e,-1)}function Vh(n,t,e){let r=n.childNodes.length;if(r&&e.top<e.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(t.top-e.top)/(e.bottom-e.top))-2)),o=i;;){let s=n.childNodes[o];if(s.nodeType==1){let a=s.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(Aa(t,c))return Vh(s,t,c)}}if((o=(o+1)%r)==i)break}return n}function bS(n,t){let e=n.dom.ownerDocument,r,i=0,o=oS(e,t.left,t.top);o&&({node:r,offset:i}=o);let s=(n.root.elementFromPoint?n.root:e).elementFromPoint(t.left,t.top),a;if(!s||!n.dom.contains(s.nodeType!=1?s.parentNode:s)){let c=n.dom.getBoundingClientRect();if(!Aa(t,c)||(s=Vh(n.dom,t,c),!s))return null}if(Ct)for(let c=s;r&&c;c=Jr(c))c.draggable&&(r=void 0);if(s=fS(s,t),r){if(ie&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let d=r.childNodes[i],h;d.nodeName=="IMG"&&(h=d.getBoundingClientRect()).right<=t.left&&h.bottom>t.top&&i++}let c;oi&&i&&r.nodeType==1&&(c=r.childNodes[i-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=t.top&&i--,r==n.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&t.top>r.lastChild.getBoundingClientRect().bottom?a=n.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(a=gS(n,r,i,t))}a==null&&(a=mS(n,s,t));let l=n.docView.nearestDesc(s,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function lc(n){return n.top<n.bottom||n.left<n.right}function je(n,t){let e=n.getClientRects();if(e.length){let r=e[t<0?0:e.length-1];if(lc(r))return r}return Array.prototype.find.call(e,lc)||n.getBoundingClientRect()}const yS=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Hh(n,t,e){let{node:r,offset:i,atom:o}=n.docView.domFromPos(t,e<0?-1:1),s=oi||ie;if(r.nodeType==3)if(s&&(yS.test(r.nodeValue)||(e<0?!i:i==r.nodeValue.length))){let l=je(_e(r,i,i),e);if(ie&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let c=je(_e(r,i-1,i-1),-1);if(c.top==l.top){let d=je(_e(r,i,i+1),-1);if(d.top!=l.top)return Ar(d,d.left<c.left)}}return l}else{let l=i,c=i,d=e<0?1:-1;return e<0&&!i?(c++,d=-1):e>=0&&i==r.nodeValue.length?(l--,d=1):e<0?l--:c++,Ar(je(_e(r,l,c),d),d<0)}if(!n.state.doc.resolve(t-(o||0)).parent.inlineContent){if(o==null&&i&&(e<0||i==Wt(r))){let l=r.childNodes[i-1];if(l.nodeType==1)return Zo(l.getBoundingClientRect(),!1)}if(o==null&&i<Wt(r)){let l=r.childNodes[i];if(l.nodeType==1)return Zo(l.getBoundingClientRect(),!0)}return Zo(r.getBoundingClientRect(),e>=0)}if(o==null&&i&&(e<0||i==Wt(r))){let l=r.childNodes[i-1],c=l.nodeType==3?_e(l,Wt(l)-(s?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return Ar(je(c,1),!1)}if(o==null&&i<Wt(r)){let l=r.childNodes[i];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?_e(l,0,s?0:1):l.nodeType==1?l:null:null;if(c)return Ar(je(c,-1),!0)}return Ar(je(r.nodeType==3?_e(r):r,-e),e>=0)}function Ar(n,t){if(n.width==0)return n;let e=t?n.left:n.right;return{top:n.top,bottom:n.bottom,left:e,right:e}}function Zo(n,t){if(n.height==0)return n;let e=t?n.top:n.bottom;return{top:e,bottom:e,left:n.left,right:n.right}}function Wh(n,t,e){let r=n.state,i=n.root.activeElement;r!=t&&n.updateState(t),i!=n.dom&&n.focus();try{return e()}finally{r!=t&&n.updateState(r),i!=n.dom&&i&&i.focus()}}function vS(n,t,e){let r=t.selection,i=e=="up"?r.$from:r.$to;return Wh(n,t,()=>{let{node:o}=n.docView.domFromPos(i.pos,e=="up"?-1:1);for(;;){let a=n.docView.nearestDesc(o,!0);if(!a)break;if(a.node.isBlock){o=a.contentDOM||a.dom;break}o=a.dom.parentNode}let s=Hh(n,i.pos,1);for(let a=o.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=_e(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let d=l[c];if(d.bottom>d.top+1&&(e=="up"?s.top-d.top>(d.bottom-s.top)*2:d.bottom-s.bottom>(s.bottom-d.top)*2))return!1}}return!0})}const wS=/[\u0590-\u08ac]/;function xS(n,t,e){let{$head:r}=t.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,o=!i,s=i==r.parent.content.size,a=n.domSelection();return a?!wS.test(r.parent.textContent)||!a.modify?e=="left"||e=="backward"?o:s:Wh(n,t,()=>{let{focusNode:l,focusOffset:c,anchorNode:d,anchorOffset:h}=n.domSelectionRange(),u=a.caretBidiLevel;a.modify("move",e,"character");let p=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:f,focusOffset:m}=n.domSelectionRange(),g=f&&!p.contains(f.nodeType==1?f:f.parentNode)||l==f&&c==m;try{a.collapse(d,h),l&&(l!=d||c!=h)&&a.extend&&a.extend(l,c)}catch{}return u!=null&&(a.caretBidiLevel=u),g}):r.pos==r.start()||r.pos==r.end()}let cc=null,dc=null,hc=!1;function kS(n,t,e){return cc==t&&dc==e?hc:(cc=t,dc=e,hc=e=="up"||e=="down"?vS(n,t,e):xS(n,t,e))}const Kt=0,uc=1,yn=2,Se=3;class si{constructor(t,e,r,i){this.parent=t,this.children=e,this.dom=r,this.contentDOM=i,this.dirty=Kt,r.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,e,r){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let e=0;e<this.children.length;e++)t+=this.children[e].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let e=0,r=this.posAtStart;;e++){let i=this.children[e];if(i==t)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,e,r){if(this.contentDOM&&this.contentDOM.contains(t.nodeType==1?t:t.parentNode))if(r<0){let o,s;if(t==this.contentDOM)o=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;o=t.previousSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(s)+s.size:this.posAtStart}else{let o,s;if(t==this.contentDOM)o=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;o=t.nextSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(s):this.posAtEnd}let i;if(t==this.dom&&this.contentDOM)i=e>pt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=t.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(e==0)for(let o=t;;o=o.parentNode){if(o==this.dom){i=!1;break}if(o.previousSibling)break}if(i==null&&e==t.childNodes.length)for(let o=t;;o=o.parentNode){if(o==this.dom){i=!0;break}if(o.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(t,e=!1){for(let r=!0,i=t;i;i=i.parentNode){let o=this.getDesc(i),s;if(o&&(!e||o.node))if(r&&(s=o.nodeDOM)&&!(s.nodeType==1?s.contains(t.nodeType==1?t:t.parentNode):s==t))r=!1;else return o}}getDesc(t){let e=t.pmViewDesc;for(let r=e;r;r=r.parent)if(r==this)return e}posFromDOM(t,e,r){for(let i=t;i;i=i.parentNode){let o=this.getDesc(i);if(o)return o.localPosFromDOM(t,e,r)}return-1}descAt(t){for(let e=0,r=0;e<this.children.length;e++){let i=this.children[e],o=r+i.size;if(r==t&&o!=r){for(;!i.border&&i.children.length;)for(let s=0;s<i.children.length;s++){let a=i.children[s];if(a.size){i=a;break}}return i}if(t<o)return i.descAt(t-r-i.border);r=o}}domFromPos(t,e){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let r=0,i=0;for(let o=0;r<this.children.length;r++){let s=this.children[r],a=o+s.size;if(a>t||s instanceof Uh){i=t-o;break}o=a}if(i)return this.children[r].domFromPos(i-this.children[r].border,e);for(let o;r&&!(o=this.children[r-1]).size&&o instanceof qh&&o.side>=0;r--);if(e<=0){let o,s=!0;for(;o=r?this.children[r-1]:null,!(!o||o.dom.parentNode==this.contentDOM);r--,s=!1);return o&&e&&s&&!o.border&&!o.domAtom?o.domFromPos(o.size,e):{node:this.contentDOM,offset:o?pt(o.dom)+1:0}}else{let o,s=!0;for(;o=r<this.children.length?this.children[r]:null,!(!o||o.dom.parentNode==this.contentDOM);r++,s=!1);return o&&s&&!o.border&&!o.domAtom?o.domFromPos(0,e):{node:this.contentDOM,offset:o?pt(o.dom):this.contentDOM.childNodes.length}}}parseRange(t,e,r=0){if(this.children.length==0)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,o=-1;for(let s=r,a=0;;a++){let l=this.children[a],c=s+l.size;if(i==-1&&t<=c){let d=s+l.border;if(t>=d&&e<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(t,e,d);t=s;for(let h=a;h>0;h--){let u=this.children[h-1];if(u.size&&u.dom.parentNode==this.contentDOM&&!u.emptyChildAt(1)){i=pt(u.dom)+1;break}t-=u.size}i==-1&&(i=0)}if(i>-1&&(c>e||a==this.children.length-1)){e=c;for(let d=a+1;d<this.children.length;d++){let h=this.children[d];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(-1)){o=pt(h.dom);break}e+=h.size}o==-1&&(o=this.contentDOM.childNodes.length);break}s=c}return{node:this.contentDOM,from:t,to:e,fromOffset:i,toOffset:o}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let e=this.children[t<0?0:this.children.length-1];return e.size==0||e.emptyChildAt(t)}domAfterPos(t){let{node:e,offset:r}=this.domFromPos(t,0);if(e.nodeType!=1||r==e.childNodes.length)throw new RangeError("No node after pos "+t);return e.childNodes[r]}setSelection(t,e,r,i=!1){let o=Math.min(t,e),s=Math.max(t,e);for(let p=0,f=0;p<this.children.length;p++){let m=this.children[p],g=f+m.size;if(o>f&&s<g)return m.setSelection(t-f-m.border,e-f-m.border,r,i);f=g}let a=this.domFromPos(t,t?-1:1),l=e==t?a:this.domFromPos(e,e?-1:1),c=r.root.getSelection(),d=r.domSelectionRange(),h=!1;if((ie||Ct)&&t==e){let{node:p,offset:f}=a;if(p.nodeType==3){if(h=!!(f&&p.nodeValue[f-1]==`
`),h&&f==p.nodeValue.length)for(let m=p,g;m;m=m.parentNode){if(g=m.nextSibling){g.nodeName=="BR"&&(a=l={node:g.parentNode,offset:pt(g)+1});break}let y=m.pmViewDesc;if(y&&y.node&&y.node.isBlock)break}}else{let m=p.childNodes[f-1];h=m&&(m.nodeName=="BR"||m.contentEditable=="false")}}if(ie&&d.focusNode&&d.focusNode!=l.node&&d.focusNode.nodeType==1){let p=d.focusNode.childNodes[d.focusOffset];p&&p.contentEditable=="false"&&(i=!0)}if(!(i||h&&Ct)&&Nn(a.node,a.offset,d.anchorNode,d.anchorOffset)&&Nn(l.node,l.offset,d.focusNode,d.focusOffset))return;let u=!1;if((c.extend||t==e)&&!h){c.collapse(a.node,a.offset);try{t!=e&&c.extend(l.node,l.offset),u=!0}catch{}}if(!u){if(t>e){let f=a;a=l,l=f}let p=document.createRange();p.setEnd(l.node,l.offset),p.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(p)}}ignoreMutation(t){return!this.contentDOM&&t.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,e){for(let r=0,i=0;i<this.children.length;i++){let o=this.children[i],s=r+o.size;if(r==s?t<=s&&e>=r:t<s&&e>r){let a=r+o.border,l=s-o.border;if(t>=a&&e<=l){this.dirty=t==r||e==s?yn:uc,t==a&&e==l&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=Se:o.markDirty(t-a,e-a);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?yn:Se}r=s}this.dirty=yn}markParentsDirty(){let t=1;for(let e=this.parent;e;e=e.parent,t++){let r=t==1?yn:uc;e.dirty<r&&(e.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(t){return!1}}class qh extends si{constructor(t,e,r,i){let o,s=e.type.toDOM;if(typeof s=="function"&&(s=s(r,()=>{if(!o)return i;if(o.parent)return o.parent.posBeforeChild(o)})),!e.type.spec.raw){if(s.nodeType!=1){let a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(t,[],s,null),this.widget=e,this.widget=e,o=this}matchesWidget(t){return this.dirty==Kt&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let e=this.widget.spec.stopEvent;return e?e(t):!1}ignoreMutation(t){return t.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class SS extends si{constructor(t,e,r,i){super(t,[],e,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return t.type==="characterData"&&t.target.nodeValue==t.oldValue}}class In extends si{constructor(t,e,r,i,o){super(t,[],r,i),this.mark=e,this.spec=o}static create(t,e,r,i){let o=i.nodeViews[e.type.name],s=o&&o(e,i,r);return(!s||!s.dom)&&(s=zn.renderSpec(document,e.type.spec.toDOM(e,r),null,e.attrs)),new In(t,e,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&Se||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(t){return this.dirty!=Se&&this.mark.eq(t)}markDirty(t,e){if(super.markDirty(t,e),this.dirty!=Kt){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Kt}}slice(t,e,r){let i=In.create(this.parent,this.mark,!0,r),o=this.children,s=this.size;e<s&&(o=qs(o,e,s,r)),t>0&&(o=qs(o,0,t,r));for(let a=0;a<o.length;a++)o[a].parent=i;return i.children=o,i}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Ze extends si{constructor(t,e,r,i,o,s,a,l,c){super(t,[],o,s),this.node=e,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=a}static create(t,e,r,i,o,s){let a=o.nodeViews[e.type.name],l,c=a&&a(e,o,()=>{if(!l)return s;if(l.parent)return l.parent.posBeforeChild(l)},r,i),d=c&&c.dom,h=c&&c.contentDOM;if(e.isText){if(!d)d=document.createTextNode(e.text);else if(d.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else d||({dom:d,contentDOM:h}=zn.renderSpec(document,e.type.spec.toDOM(e),null,e.attrs));!h&&!e.isText&&d.nodeName!="BR"&&(d.hasAttribute("contenteditable")||(d.contentEditable="false"),e.type.spec.draggable&&(d.draggable=!0));let u=d;return d=Jh(d,r,e),c?l=new CS(t,e,r,i,d,h||null,u,c,o,s+1):e.isText?new vo(t,e,r,i,d,u,o):new Ze(t,e,r,i,d,h||null,u,o,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(t.preserveWhitespace="full"),!this.contentDOM)t.getContent=()=>this.node.content;else if(!this.contentLost)t.contentElement=this.contentDOM;else{for(let e=this.children.length-1;e>=0;e--){let r=this.children[e];if(this.dom.contains(r.dom.parentNode)){t.contentElement=r.dom.parentNode;break}}t.contentElement||(t.getContent=()=>x.empty)}return t}matchesNode(t,e,r){return this.dirty==Kt&&t.eq(this.node)&&qi(e,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,e){let r=this.node.inlineContent,i=e,o=t.composing?this.localCompositionInfo(t,e):null,s=o&&o.pos>-1?o:null,a=o&&o.pos<0,l=new OS(this,s&&s.node,t);AS(this.node,this.innerDeco,(c,d,h)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,t):c.type.side>=0&&!h&&l.syncToMarks(d==this.node.childCount?W.none:this.node.child(d).marks,r,t),l.placeWidget(c,t,i)},(c,d,h,u)=>{l.syncToMarks(c.marks,r,t);let p;l.findNodeMatch(c,d,h,u)||a&&t.state.selection.from>i&&t.state.selection.to<i+c.nodeSize&&(p=l.findIndexWithChild(o.node))>-1&&l.updateNodeAt(c,d,h,p,t)||l.updateNextNode(c,d,h,t,u,i)||l.addNode(c,d,h,t,i),i+=c.nodeSize}),l.syncToMarks([],r,t),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==yn)&&(s&&this.protectLocalComposition(t,s),Kh(this.contentDOM,this.children,t),or&&_S(this.dom))}localCompositionInfo(t,e){let{from:r,to:i}=t.state.selection;if(!(t.state.selection instanceof B)||r<e||i>e+this.node.content.size)return null;let o=t.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let s=o.nodeValue,a=DS(this.node.content,s,r-e,i-e);return a<0?null:{node:o,pos:a,text:s}}else return{node:o,pos:-1,text:""}}protectLocalComposition(t,{node:e,pos:r,text:i}){if(this.getDesc(e))return;let o=e;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let s=new SS(this,o,e,i);t.input.compositionNodes.push(s),this.children=qs(this.children,r,r+i.length,t,s)}update(t,e,r,i){return this.dirty==Se||!t.sameMarkup(this.node)?!1:(this.updateInner(t,e,r,i),!0)}updateInner(t,e,r,i){this.updateOuterDeco(e),this.node=t,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=Kt}updateOuterDeco(t){if(qi(t,this.outerDeco))return;let e=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=Gh(this.dom,this.nodeDOM,Ws(this.outerDeco,this.node,e),Ws(t,this.node,e)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function pc(n,t,e,r,i){Jh(r,t,n);let o=new Ze(void 0,n,t,e,r,r,r,i,0);return o.contentDOM&&o.updateChildren(i,0),o}class vo extends Ze{constructor(t,e,r,i,o,s,a){super(t,e,r,i,o,null,s,a,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,e,r,i){return this.dirty==Se||this.dirty!=Kt&&!this.inParent()||!t.sameMarkup(this.node)?!1:(this.updateOuterDeco(e),(this.dirty!=Kt||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=t,this.dirty=Kt,!0)}inParent(){let t=this.parent.contentDOM;for(let e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,e,r){return t==this.nodeDOM?this.posAtStart+Math.min(e,this.node.text.length):super.localPosFromDOM(t,e,r)}ignoreMutation(t){return t.type!="characterData"&&t.type!="selection"}slice(t,e,r){let i=this.node.cut(t,e),o=document.createTextNode(i.text);return new vo(this.parent,i,this.outerDeco,this.innerDeco,o,o,r)}markDirty(t,e){super.markDirty(t,e),this.dom!=this.nodeDOM&&(t==0||e==this.nodeDOM.nodeValue.length)&&(this.dirty=Se)}get domAtom(){return!1}isText(t){return this.node.text==t}}class Uh extends si{parseRule(){return{ignore:!0}}matchesHack(t){return this.dirty==Kt&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class CS extends Ze{constructor(t,e,r,i,o,s,a,l,c,d){super(t,e,r,i,o,s,a,c,d),this.spec=l}update(t,e,r,i){if(this.dirty==Se)return!1;if(this.spec.update&&(this.node.type==t.type||this.spec.multiType)){let o=this.spec.update(t,e,r);return o&&this.updateInner(t,e,r,i),o}else return!this.contentDOM&&!t.isLeaf?!1:super.update(t,e,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,e,r,i){this.spec.setSelection?this.spec.setSelection(t,e,r.root):super.setSelection(t,e,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return this.spec.stopEvent?this.spec.stopEvent(t):!1}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function Kh(n,t,e){let r=n.firstChild,i=!1;for(let o=0;o<t.length;o++){let s=t[o],a=s.dom;if(a.parentNode==n){for(;a!=r;)r=fc(r),i=!0;r=r.nextSibling}else i=!0,n.insertBefore(a,r);if(s instanceof In){let l=r?r.previousSibling:n.lastChild;Kh(s.contentDOM,s.children,e),r=l?l.nextSibling:n.firstChild}}for(;r;)r=fc(r),i=!0;i&&e.trackWrites==n&&(e.trackWrites=null)}const Fr=function(n){n&&(this.nodeName=n)};Fr.prototype=Object.create(null);const vn=[new Fr];function Ws(n,t,e){if(n.length==0)return vn;let r=e?vn[0]:new Fr,i=[r];for(let o=0;o<n.length;o++){let s=n[o].type.attrs;if(s){s.nodeName&&i.push(r=new Fr(s.nodeName));for(let a in s){let l=s[a];l!=null&&(e&&i.length==1&&i.push(r=new Fr(t.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return i}function Gh(n,t,e,r){if(e==vn&&r==vn)return t;let i=t;for(let o=0;o<r.length;o++){let s=r[o],a=e[o];if(o){let l;a&&a.nodeName==s.nodeName&&i!=n&&(l=i.parentNode)&&l.nodeName.toLowerCase()==s.nodeName||(l=document.createElement(s.nodeName),l.pmIsDeco=!0,l.appendChild(i),a=vn[0]),i=l}ES(i,a||vn[0],s)}return i}function ES(n,t,e){for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&!(r in e)&&n.removeAttribute(r);for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&e[r]!=t[r]&&n.setAttribute(r,e[r]);if(t.class!=e.class){let r=t.class?t.class.split(" ").filter(Boolean):[],i=e.class?e.class.split(" ").filter(Boolean):[];for(let o=0;o<r.length;o++)i.indexOf(r[o])==-1&&n.classList.remove(r[o]);for(let o=0;o<i.length;o++)r.indexOf(i[o])==-1&&n.classList.add(i[o]);n.classList.length==0&&n.removeAttribute("class")}if(t.style!=e.style){if(t.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(t.style);)n.style.removeProperty(i[1])}e.style&&(n.style.cssText+=e.style)}}function Jh(n,t,e){return Gh(n,n,vn,Ws(t,e,n.nodeType!=1))}function qi(n,t){if(n.length!=t.length)return!1;for(let e=0;e<n.length;e++)if(!n[e].type.eq(t[e].type))return!1;return!0}function fc(n){let t=n.nextSibling;return n.parentNode.removeChild(n),t}class OS{constructor(t,e,r){this.lock=e,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=MS(t.node.content,t)}destroyBetween(t,e){if(t!=e){for(let r=t;r<e;r++)this.top.children[r].destroy();this.top.children.splice(t,e-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,e,r){let i=0,o=this.stack.length>>1,s=Math.min(o,t.length);for(;i<s&&(i==o-1?this.top:this.stack[i+1<<1]).matchesMark(t[i])&&t[i].type.spec.spanning!==!1;)i++;for(;i<o;)this.destroyRest(),this.top.dirty=Kt,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<t.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(t[o])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=In.create(this.top,t[o],e,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,o++}}findNodeMatch(t,e,r,i){let o=-1,s;if(i>=this.preMatch.index&&(s=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&s.matchesNode(t,e,r))o=this.top.children.indexOf(s,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(t,e,r)&&!this.preMatch.matched.has(c)){o=a;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(t,e,r,i,o){let s=this.top.children[i];return s.dirty==Se&&s.dom==s.contentDOM&&(s.dirty=yn),s.update(t,e,r,o)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(t){for(;;){let e=t.parentNode;if(!e)return-1;if(e==this.top.contentDOM){let r=t.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}t=e}}updateNextNode(t,e,r,i,o,s){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof Ze){let c=this.preMatch.matched.get(l);if(c!=null&&c!=o)return!1;let d=l.dom,h,u=this.isLocked(d)&&!(t.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==t.text&&l.dirty!=Se&&qi(e,l.outerDeco));if(!u&&l.update(t,e,r,i))return this.destroyBetween(this.index,a),l.dom!=d&&(this.changed=!0),this.index++,!0;if(!u&&(h=this.recreateWrapper(l,t,e,r,i,s)))return this.destroyBetween(this.index,a),this.top.children[this.index]=h,h.contentDOM&&(h.dirty=yn,h.updateChildren(i,s+1),h.dirty=Kt),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(t,e,r,i,o,s){if(t.dirty||e.isAtom||!t.children.length||!t.node.content.eq(e.content)||!qi(r,t.outerDeco)||!i.eq(t.innerDeco))return null;let a=Ze.create(this.top,e,r,i,o,s);if(a.contentDOM){a.children=t.children,t.children=[];for(let l of a.children)l.parent=a}return t.destroy(),a}addNode(t,e,r,i,o){let s=Ze.create(this.top,t,e,r,i,o);s.contentDOM&&s.updateChildren(i,o+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(t,e,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(t)&&(t==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let o=new qh(this.top,t,e,r);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let t=this.top.children[this.index-1],e=this.top;for(;t instanceof In;)e=t,t=e.children[e.children.length-1];(!t||!(t instanceof vo)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((Ct||vt)&&t&&t.dom.contentEditable=="false"&&this.addHackNode("IMG",e),this.addHackNode("BR",this.top))}addHackNode(t,e){if(e==this.top&&this.index<e.children.length&&e.children[this.index].matchesHack(t))this.index++;else{let r=document.createElement(t);t=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),t=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new Uh(this.top,[],r,null);e!=this.top?e.children.push(i):e.children.splice(this.index++,0,i),this.changed=!0}}isLocked(t){return this.lock&&(t==this.lock||t.nodeType==1&&t.contains(this.lock.parentNode))}}function MS(n,t){let e=t,r=e.children.length,i=n.childCount,o=new Map,s=[];t:for(;i>0;){let a;for(;;)if(r){let c=e.children[r-1];if(c instanceof In)e=c,r=c.children.length;else{a=c,r--;break}}else{if(e==t)break t;r=e.parent.children.indexOf(e),e=e.parent}let l=a.node;if(l){if(l!=n.child(i-1))break;--i,o.set(a,i),s.push(a)}}return{index:i,matched:o,matches:s.reverse()}}function TS(n,t){return n.type.side-t.type.side}function AS(n,t,e,r){let i=t.locals(n),o=0;if(i.length==0){for(let c=0;c<n.childCount;c++){let d=n.child(c);r(d,i,t.forChild(o,d),c),o+=d.nodeSize}return}let s=0,a=[],l=null;for(let c=0;;){let d,h;for(;s<i.length&&i[s].to==o;){let g=i[s++];g.widget&&(d?(h||(h=[d])).push(g):d=g)}if(d)if(h){h.sort(TS);for(let g=0;g<h.length;g++)e(h[g],c,!!l)}else e(d,c,!!l);let u,p;if(l)p=-1,u=l,l=null;else if(c<n.childCount)p=c,u=n.child(c++);else break;for(let g=0;g<a.length;g++)a[g].to<=o&&a.splice(g--,1);for(;s<i.length&&i[s].from<=o&&i[s].to>o;)a.push(i[s++]);let f=o+u.nodeSize;if(u.isText){let g=f;s<i.length&&i[s].from<g&&(g=i[s].from);for(let y=0;y<a.length;y++)a[y].to<g&&(g=a[y].to);g<f&&(l=u.cut(g-o),u=u.cut(0,g-o),f=g,p=-1)}else for(;s<i.length&&i[s].to<f;)s++;let m=u.isInline&&!u.isLeaf?a.filter(g=>!g.inline):a.slice();r(u,m,t.forChild(o,u),p),o=f}}function _S(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let t=n.style.cssText;n.style.cssText=t+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=t}}function DS(n,t,e,r){for(let i=0,o=0;i<n.childCount&&o<=r;){let s=n.child(i++),a=o;if(o+=s.nodeSize,!s.isText)continue;let l=s.text;for(;i<n.childCount;){let c=n.child(i++);if(o+=c.nodeSize,!c.isText)break;l+=c.text}if(o>=e){if(o>=r&&l.slice(r-t.length-a,r-a)==t)return r-t.length;let c=a<r?l.lastIndexOf(t,r-a-1):-1;if(c>=0&&c+t.length+a>=e)return a+c;if(e==r&&l.length>=r+t.length-a&&l.slice(r-a,r-a+t.length)==t)return r}}return-1}function qs(n,t,e,r,i){let o=[];for(let s=0,a=0;s<n.length;s++){let l=n[s],c=a,d=a+=l.size;c>=e||d<=t?o.push(l):(c<t&&o.push(l.slice(0,t-c,r)),i&&(o.push(i),i=void 0),d>e&&o.push(l.slice(e-c,l.size,r)))}return o}function _a(n,t=null){let e=n.domSelectionRange(),r=n.state.doc;if(!e.focusNode)return null;let i=n.docView.nearestDesc(e.focusNode),o=i&&i.size==0,s=n.docView.posFromDOM(e.focusNode,e.focusOffset,1);if(s<0)return null;let a=r.resolve(s),l,c;if(yo(e)){for(l=s;i&&!i.node;)i=i.parent;let h=i.node;if(i&&h.isAtom&&_.isSelectable(h)&&i.parent&&!(h.isInline&&rS(e.focusNode,e.focusOffset,i.dom))){let u=i.posBefore;c=new _(s==u?a:r.resolve(u))}}else{if(e instanceof n.dom.ownerDocument.defaultView.Selection&&e.rangeCount>1){let h=s,u=s;for(let p=0;p<e.rangeCount;p++){let f=e.getRangeAt(p);h=Math.min(h,n.docView.posFromDOM(f.startContainer,f.startOffset,1)),u=Math.max(u,n.docView.posFromDOM(f.endContainer,f.endOffset,-1))}if(h<0)return null;[l,s]=u==n.state.selection.anchor?[u,h]:[h,u],a=r.resolve(s)}else l=n.docView.posFromDOM(e.anchorNode,e.anchorOffset,1);if(l<0)return null}let d=r.resolve(l);if(!c){let h=t=="pointer"||n.state.selection.head<a.pos&&!o?1:-1;c=Da(n,d,a,h)}return c}function Yh(n){return n.editable?n.hasFocus():Zh(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function Ie(n,t=!1){let e=n.state.selection;if(Xh(n,e),!!Yh(n)){if(!t&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&vt){let r=n.domSelectionRange(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&Nn(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)NS(n);else{let{anchor:r,head:i}=e,o,s;mc&&!(e instanceof B)&&(e.$from.parent.inlineContent||(o=gc(n,e.from)),!e.empty&&!e.$from.parent.inlineContent&&(s=gc(n,e.to))),n.docView.setSelection(r,i,n,t),mc&&(o&&bc(o),s&&bc(s)),e.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&$S(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const mc=Ct||vt&&zh<63;function gc(n,t){let{node:e,offset:r}=n.docView.domFromPos(t,0),i=r<e.childNodes.length?e.childNodes[r]:null,o=r?e.childNodes[r-1]:null;if(Ct&&i&&i.contentEditable=="false")return Qo(i);if((!i||i.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(i)return Qo(i);if(o)return Qo(o)}}function Qo(n){return n.contentEditable="true",Ct&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function bc(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function $S(n){let t=n.dom.ownerDocument;t.removeEventListener("selectionchange",n.input.hideSelectionGuard);let e=n.domSelectionRange(),r=e.anchorNode,i=e.anchorOffset;t.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(e.anchorNode!=r||e.anchorOffset!=i)&&(t.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!Yh(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function NS(n){let t=n.domSelection(),e=document.createRange();if(!t)return;let r=n.cursorWrapper.dom,i=r.nodeName=="IMG";i?e.setStart(r.parentNode,pt(r)+1):e.setStart(r,0),e.collapse(!0),t.removeAllRanges(),t.addRange(e),!i&&!n.state.selection.visible&&At&&Xe<=11&&(r.disabled=!0,r.disabled=!1)}function Xh(n,t){if(t instanceof _){let e=n.docView.descAt(t.from);e!=n.lastSelectedViewDesc&&(yc(n),e&&e.selectNode(),n.lastSelectedViewDesc=e)}else yc(n)}function yc(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function Da(n,t,e,r){return n.someProp("createSelectionBetween",i=>i(n,t,e))||B.between(t,e,r)}function vc(n){return n.editable&&!n.hasFocus()?!1:Zh(n)}function Zh(n){let t=n.domSelectionRange();if(!t.anchorNode)return!1;try{return n.dom.contains(t.anchorNode.nodeType==3?t.anchorNode.parentNode:t.anchorNode)&&(n.editable||n.dom.contains(t.focusNode.nodeType==3?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function IS(n){let t=n.docView.domFromPos(n.state.selection.anchor,0),e=n.domSelectionRange();return Nn(t.node,t.offset,e.anchorNode,e.anchorOffset)}function Us(n,t){let{$anchor:e,$head:r}=n.selection,i=t>0?e.max(r):e.min(r),o=i.parent.inlineContent?i.depth?n.doc.resolve(t>0?i.after():i.before()):null:i;return o&&L.findFrom(o,t)}function Ve(n,t){return n.dispatch(n.state.tr.setSelection(t).scrollIntoView()),!0}function wc(n,t,e){let r=n.state.selection;if(r instanceof B)if(e.indexOf("s")>-1){let{$head:i}=r,o=i.textOffset?null:t<0?i.nodeBefore:i.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let s=n.state.doc.resolve(i.pos+o.nodeSize*(t<0?-1:1));return Ve(n,new B(r.$anchor,s))}else if(r.empty){if(n.endOfTextblock(t>0?"forward":"backward")){let i=Us(n.state,t);return i&&i instanceof _?Ve(n,i):!1}else if(!(Ht&&e.indexOf("m")>-1)){let i=r.$head,o=i.textOffset?null:t<0?i.nodeBefore:i.nodeAfter,s;if(!o||o.isText)return!1;let a=t<0?i.pos-o.nodeSize:i.pos;return o.isAtom||(s=n.docView.descAt(a))&&!s.contentDOM?_.isSelectable(o)?Ve(n,new _(t<0?n.state.doc.resolve(i.pos-o.nodeSize):i)):oi?Ve(n,new B(n.state.doc.resolve(t<0?a:a+o.nodeSize))):!1:!1}}else return!1;else{if(r instanceof _&&r.node.isInline)return Ve(n,new B(t>0?r.$to:r.$from));{let i=Us(n.state,t);return i?Ve(n,i):!1}}}function Ui(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function jr(n,t){let e=n.pmViewDesc;return e&&e.size==0&&(t<0||n.nextSibling||n.nodeName!="BR")}function Vn(n,t){return t<0?PS(n):RS(n)}function PS(n){let t=n.domSelectionRange(),e=t.focusNode,r=t.focusOffset;if(!e)return;let i,o,s=!1;for(ie&&e.nodeType==1&&r<Ui(e)&&jr(e.childNodes[r],-1)&&(s=!0);;)if(r>0){if(e.nodeType!=1)break;{let a=e.childNodes[r-1];if(jr(a,-1))i=e,o=--r;else if(a.nodeType==3)e=a,r=e.nodeValue.length;else break}}else{if(Qh(e))break;{let a=e.previousSibling;for(;a&&jr(a,-1);)i=e.parentNode,o=pt(a),a=a.previousSibling;if(a)e=a,r=Ui(e);else{if(e=e.parentNode,e==n.dom)break;r=0}}}s?Ks(n,e,r):i&&Ks(n,i,o)}function RS(n){let t=n.domSelectionRange(),e=t.focusNode,r=t.focusOffset;if(!e)return;let i=Ui(e),o,s;for(;;)if(r<i){if(e.nodeType!=1)break;let a=e.childNodes[r];if(jr(a,1))o=e,s=++r;else break}else{if(Qh(e))break;{let a=e.nextSibling;for(;a&&jr(a,1);)o=a.parentNode,s=pt(a)+1,a=a.nextSibling;if(a)e=a,r=0,i=Ui(e);else{if(e=e.parentNode,e==n.dom)break;r=i=0}}}o&&Ks(n,o,s)}function Qh(n){let t=n.pmViewDesc;return t&&t.node&&t.node.isBlock}function LS(n,t){for(;n&&t==n.childNodes.length&&!ii(n);)t=pt(n)+1,n=n.parentNode;for(;n&&t<n.childNodes.length;){let e=n.childNodes[t];if(e.nodeType==3)return e;if(e.nodeType==1&&e.contentEditable=="false")break;n=e,t=0}}function zS(n,t){for(;n&&!t&&!ii(n);)t=pt(n),n=n.parentNode;for(;n&&t;){let e=n.childNodes[t-1];if(e.nodeType==3)return e;if(e.nodeType==1&&e.contentEditable=="false")break;n=e,t=n.childNodes.length}}function Ks(n,t,e){if(t.nodeType!=3){let o,s;(s=LS(t,e))?(t=s,e=0):(o=zS(t,e))&&(t=o,e=o.nodeValue.length)}let r=n.domSelection();if(!r)return;if(yo(r)){let o=document.createRange();o.setEnd(t,e),o.setStart(t,e),r.removeAllRanges(),r.addRange(o)}else r.extend&&r.extend(t,e);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&Ie(n)},50)}function xc(n,t){let e=n.state.doc.resolve(t);if(!(vt||sS)&&e.parent.inlineContent){let i=n.coordsAtPos(t);if(t>e.start()){let o=n.coordsAtPos(t-1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left<i.left?"ltr":"rtl"}if(t<e.end()){let o=n.coordsAtPos(t+1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left>i.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function kc(n,t,e){let r=n.state.selection;if(r instanceof B&&!r.empty||e.indexOf("s")>-1||Ht&&e.indexOf("m")>-1)return!1;let{$from:i,$to:o}=r;if(!i.parent.inlineContent||n.endOfTextblock(t<0?"up":"down")){let s=Us(n.state,t);if(s&&s instanceof _)return Ve(n,s)}if(!i.parent.inlineContent){let s=t<0?i:o,a=r instanceof ee?L.near(s,t):L.findFrom(s,t);return a?Ve(n,a):!1}return!1}function Sc(n,t){if(!(n.state.selection instanceof B))return!0;let{$head:e,$anchor:r,empty:i}=n.state.selection;if(!e.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(t>0?"forward":"backward"))return!0;let o=!e.textOffset&&(t<0?e.nodeBefore:e.nodeAfter);if(o&&!o.isText){let s=n.state.tr;return t<0?s.delete(e.pos-o.nodeSize,e.pos):s.delete(e.pos,e.pos+o.nodeSize),n.dispatch(s),!0}return!1}function Cc(n,t,e){n.domObserver.stop(),t.contentEditable=e,n.domObserver.start()}function BS(n){if(!Ct||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:e}=n.domSelectionRange();if(t&&t.nodeType==1&&e==0&&t.firstChild&&t.firstChild.contentEditable=="false"){let r=t.firstChild;Cc(n,r,"true"),setTimeout(()=>Cc(n,r,"false"),20)}return!1}function FS(n){let t="";return n.ctrlKey&&(t+="c"),n.metaKey&&(t+="m"),n.altKey&&(t+="a"),n.shiftKey&&(t+="s"),t}function jS(n,t){let e=t.keyCode,r=FS(t);if(e==8||Ht&&e==72&&r=="c")return Sc(n,-1)||Vn(n,-1);if(e==46&&!t.shiftKey||Ht&&e==68&&r=="c")return Sc(n,1)||Vn(n,1);if(e==13||e==27)return!0;if(e==37||Ht&&e==66&&r=="c"){let i=e==37?xc(n,n.state.selection.from)=="ltr"?-1:1:-1;return wc(n,i,r)||Vn(n,i)}else if(e==39||Ht&&e==70&&r=="c"){let i=e==39?xc(n,n.state.selection.from)=="ltr"?1:-1:1;return wc(n,i,r)||Vn(n,i)}else{if(e==38||Ht&&e==80&&r=="c")return kc(n,-1,r)||Vn(n,-1);if(e==40||Ht&&e==78&&r=="c")return BS(n)||kc(n,1,r)||Vn(n,1);if(r==(Ht?"m":"c")&&(e==66||e==73||e==89||e==90))return!0}return!1}function tu(n,t){n.someProp("transformCopied",p=>{t=p(t,n)});let e=[],{content:r,openStart:i,openEnd:o}=t;for(;i>1&&o>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,o--;let p=r.firstChild;e.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),r=p.content}let s=n.someProp("clipboardSerializer")||zn.fromSchema(n.state.schema),a=su(),l=a.createElement("div");l.appendChild(s.serializeFragment(r,{document:a}));let c=l.firstChild,d,h=0;for(;c&&c.nodeType==1&&(d=ou[c.nodeName.toLowerCase()]);){for(let p=d.length-1;p>=0;p--){let f=a.createElement(d[p]);for(;l.firstChild;)f.appendChild(l.firstChild);l.appendChild(f),h++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${i} ${o}${h?` -${h}`:""} ${JSON.stringify(e)}`);let u=n.someProp("clipboardTextSerializer",p=>p(t,n))||t.content.textBetween(0,t.content.size,`

`);return{dom:l,text:u,slice:t}}function eu(n,t,e,r,i){let o=i.parent.type.spec.code,s,a;if(!e&&!t)return null;let l=t&&(r||o||!e);if(l){if(n.someProp("transformPastedText",u=>{t=u(t,o||r,n)}),o)return t?new E(x.from(n.state.schema.text(t.replace(/\r\n?/g,`
`))),0,0):E.empty;let h=n.someProp("clipboardTextParser",u=>u(t,i,r,n));if(h)a=h;else{let u=i.marks(),{schema:p}=n.state,f=zn.fromSchema(p);s=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(m=>{let g=s.appendChild(document.createElement("p"));m&&g.appendChild(f.serializeNode(p.text(m,u)))})}}else n.someProp("transformPastedHTML",h=>{e=h(e,n)}),s=qS(e),oi&&US(s);let c=s&&s.querySelector("[data-pm-slice]"),d=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(d&&d[3])for(let h=+d[3];h>0;h--){let u=s.firstChild;for(;u&&u.nodeType!=1;)u=u.nextSibling;if(!u)break;s=u}if(a||(a=(n.someProp("clipboardParser")||n.someProp("domParser")||Sa.fromSchema(n.state.schema)).parseSlice(s,{preserveWhitespace:!!(l||d),context:i,ruleFromNode(u){return u.nodeName=="BR"&&!u.nextSibling&&u.parentNode&&!VS.test(u.parentNode.nodeName)?{ignore:!0}:null}})),d)a=KS(Ec(a,+d[1],+d[2]),d[4]);else if(a=E.maxOpen(HS(a.content,i),!0),a.openStart||a.openEnd){let h=0,u=0;for(let p=a.content.firstChild;h<a.openStart&&!p.type.spec.isolating;h++,p=p.firstChild);for(let p=a.content.lastChild;u<a.openEnd&&!p.type.spec.isolating;u++,p=p.lastChild);a=Ec(a,h,u)}return n.someProp("transformPasted",h=>{a=h(a,n)}),a}const VS=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function HS(n,t){if(n.childCount<2)return n;for(let e=t.depth;e>=0;e--){let i=t.node(e).contentMatchAt(t.index(e)),o,s=[];if(n.forEach(a=>{if(!s)return;let l=i.findWrapping(a.type),c;if(!l)return s=null;if(c=s.length&&o.length&&ru(l,o,a,s[s.length-1],0))s[s.length-1]=c;else{s.length&&(s[s.length-1]=iu(s[s.length-1],o.length));let d=nu(a,l);s.push(d),i=i.matchType(d.type),o=l}}),s)return x.from(s)}return n}function nu(n,t,e=0){for(let r=t.length-1;r>=e;r--)n=t[r].create(null,x.from(n));return n}function ru(n,t,e,r,i){if(i<n.length&&i<t.length&&n[i]==t[i]){let o=ru(n,t,e,r.lastChild,i+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?e.type:n[i+1]))return r.copy(r.content.append(x.from(nu(e,n,i+1))))}}function iu(n,t){if(t==0)return n;let e=n.content.replaceChild(n.childCount-1,iu(n.lastChild,t-1)),r=n.contentMatchAt(n.childCount).fillBefore(x.empty,!0);return n.copy(e.append(r))}function Gs(n,t,e,r,i,o){let s=t<0?n.firstChild:n.lastChild,a=s.content;return n.childCount>1&&(o=0),i<r-1&&(a=Gs(a,t,e,r,i+1,o)),i>=e&&(a=t<0?s.contentMatchAt(0).fillBefore(a,o<=i).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(x.empty,!0))),n.replaceChild(t<0?0:n.childCount-1,s.copy(a))}function Ec(n,t,e){return t<n.openStart&&(n=new E(Gs(n.content,-1,t,n.openStart,0,n.openEnd),t,n.openEnd)),e<n.openEnd&&(n=new E(Gs(n.content,1,e,n.openEnd,0,0),n.openStart,e)),n}const ou={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Oc=null;function su(){return Oc||(Oc=document.implementation.createHTMLDocument("title"))}let ts=null;function WS(n){let t=window.trustedTypes;return t?(ts||(ts=t.createPolicy("ProseMirrorClipboard",{createHTML:e=>e})),ts.createHTML(n)):n}function qS(n){let t=/^(\s*<meta [^>]*>)*/.exec(n);t&&(n=n.slice(t[0].length));let e=su().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),i;if((i=r&&ou[r[1].toLowerCase()])&&(n=i.map(o=>"<"+o+">").join("")+n+i.map(o=>"</"+o+">").reverse().join("")),e.innerHTML=WS(n),i)for(let o=0;o<i.length;o++)e=e.querySelector(i[o])||e;return e}function US(n){let t=n.querySelectorAll(vt?"span:not([class]):not([style])":"span.Apple-converted-space");for(let e=0;e<t.length;e++){let r=t[e];r.childNodes.length==1&&r.textContent=="ย"&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function KS(n,t){if(!n.size)return n;let e=n.content.firstChild.type.schema,r;try{r=JSON.parse(t)}catch{return n}let{content:i,openStart:o,openEnd:s}=n;for(let a=r.length-2;a>=0;a-=2){let l=e.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;i=x.from(l.create(r[a+1],i)),o++,s++}return new E(i,o,s)}const Et={},Ot={},GS={touchstart:!0,touchmove:!0};class JS{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function YS(n){for(let t in Et){let e=Et[t];n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>{ZS(n,r)&&!$a(n,r)&&(n.editable||!(r.type in Ot))&&e(n,r)},GS[t]?{passive:!0}:void 0)}Ct&&n.dom.addEventListener("input",()=>null),Js(n)}function Ye(n,t){n.input.lastSelectionOrigin=t,n.input.lastSelectionTime=Date.now()}function XS(n){n.domObserver.stop();for(let t in n.input.eventHandlers)n.dom.removeEventListener(t,n.input.eventHandlers[t]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function Js(n){n.someProp("handleDOMEvents",t=>{for(let e in t)n.input.eventHandlers[e]||n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>$a(n,r))})}function $a(n,t){return n.someProp("handleDOMEvents",e=>{let r=e[t.type];return r?r(n,t)||t.defaultPrevented:!1})}function ZS(n,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target;e!=n.dom;e=e.parentNode)if(!e||e.nodeType==11||e.pmViewDesc&&e.pmViewDesc.stopEvent(t))return!1;return!0}function QS(n,t){!$a(n,t)&&Et[t.type]&&(n.editable||!(t.type in Ot))&&Et[t.type](n,t)}Ot.keydown=(n,t)=>{let e=t;if(n.input.shiftKey=e.keyCode==16||e.shiftKey,!lu(n,e)&&(n.input.lastKeyCode=e.keyCode,n.input.lastKeyCodeTime=Date.now(),!(Ne&&vt&&e.keyCode==13)))if(e.keyCode!=229&&n.domObserver.forceFlush(),or&&e.keyCode==13&&!e.ctrlKey&&!e.altKey&&!e.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,bn(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,e))||jS(n,e)?e.preventDefault():Ye(n,"key")};Ot.keyup=(n,t)=>{t.keyCode==16&&(n.input.shiftKey=!1)};Ot.keypress=(n,t)=>{let e=t;if(lu(n,e)||!e.charCode||e.ctrlKey&&!e.altKey||Ht&&e.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,e))){e.preventDefault();return}let r=n.state.selection;if(!(r instanceof B)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(e.charCode);!/[\r\n]/.test(i)&&!n.someProp("handleTextInput",o=>o(n,r.$from.pos,r.$to.pos,i))&&n.dispatch(n.state.tr.insertText(i).scrollIntoView()),e.preventDefault()}};function wo(n){return{left:n.clientX,top:n.clientY}}function tC(n,t){let e=t.x-n.clientX,r=t.y-n.clientY;return e*e+r*r<100}function Na(n,t,e,r,i){if(r==-1)return!1;let o=n.state.doc.resolve(r);for(let s=o.depth+1;s>0;s--)if(n.someProp(t,a=>s>o.depth?a(n,e,o.nodeAfter,o.before(s),i,!0):a(n,e,o.node(s),o.before(s),i,!1)))return!0;return!1}function Zn(n,t,e){if(n.focused||n.focus(),n.state.selection.eq(t))return;let r=n.state.tr.setSelection(t);e=="pointer"&&r.setMeta("pointer",!0),n.dispatch(r)}function eC(n,t){if(t==-1)return!1;let e=n.state.doc.resolve(t),r=e.nodeAfter;return r&&r.isAtom&&_.isSelectable(r)?(Zn(n,new _(e),"pointer"),!0):!1}function nC(n,t){if(t==-1)return!1;let e=n.state.selection,r,i;e instanceof _&&(r=e.node);let o=n.state.doc.resolve(t);for(let s=o.depth+1;s>0;s--){let a=s>o.depth?o.nodeAfter:o.node(s);if(_.isSelectable(a)){r&&e.$from.depth>0&&s>=e.$from.depth&&o.before(e.$from.depth+1)==e.$from.pos?i=o.before(e.$from.depth):i=o.before(s);break}}return i!=null?(Zn(n,_.create(n.state.doc,i),"pointer"),!0):!1}function rC(n,t,e,r,i){return Na(n,"handleClickOn",t,e,r)||n.someProp("handleClick",o=>o(n,t,r))||(i?nC(n,e):eC(n,e))}function iC(n,t,e,r){return Na(n,"handleDoubleClickOn",t,e,r)||n.someProp("handleDoubleClick",i=>i(n,t,r))}function oC(n,t,e,r){return Na(n,"handleTripleClickOn",t,e,r)||n.someProp("handleTripleClick",i=>i(n,t,r))||sC(n,e,r)}function sC(n,t,e){if(e.button!=0)return!1;let r=n.state.doc;if(t==-1)return r.inlineContent?(Zn(n,B.create(r,0,r.content.size),"pointer"),!0):!1;let i=r.resolve(t);for(let o=i.depth+1;o>0;o--){let s=o>i.depth?i.nodeAfter:i.node(o),a=i.before(o);if(s.inlineContent)Zn(n,B.create(r,a+1,a+1+s.content.size),"pointer");else if(_.isSelectable(s))Zn(n,_.create(r,a),"pointer");else continue;return!0}}function Ia(n){return Ki(n)}const au=Ht?"metaKey":"ctrlKey";Et.mousedown=(n,t)=>{let e=t;n.input.shiftKey=e.shiftKey;let r=Ia(n),i=Date.now(),o="singleClick";i-n.input.lastClick.time<500&&tC(e,n.input.lastClick)&&!e[au]&&(n.input.lastClick.type=="singleClick"?o="doubleClick":n.input.lastClick.type=="doubleClick"&&(o="tripleClick")),n.input.lastClick={time:i,x:e.clientX,y:e.clientY,type:o};let s=n.posAtCoords(wo(e));s&&(o=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new aC(n,s,e,!!r)):(o=="doubleClick"?iC:oC)(n,s.pos,s.inside,e)?e.preventDefault():Ye(n,"pointer"))};class aC{constructor(t,e,r,i){this.view=t,this.pos=e,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!r[au],this.allowDefault=r.shiftKey;let o,s;if(e.inside>-1)o=t.state.doc.nodeAt(e.inside),s=e.inside;else{let d=t.state.doc.resolve(e.pos);o=d.parent,s=d.depth?d.before():0}const a=i?null:r.target,l=a?t.docView.nearestDesc(a,!0):null;this.target=l&&l.dom.nodeType==1?l.dom:null;let{selection:c}=t.state;(r.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||c instanceof _&&c.from<=s&&c.to>s)&&(this.mightDrag={node:o,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&ie&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),Ye(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Ie(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(wo(t))),this.updateAllowDefault(t),this.allowDefault||!e?Ye(this.view,"pointer"):rC(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():t.button==0&&(this.flushed||Ct&&this.mightDrag&&!this.mightDrag.node.isAtom||vt&&!this.view.state.selection.visible&&Math.min(Math.abs(e.pos-this.view.state.selection.from),Math.abs(e.pos-this.view.state.selection.to))<=2)?(Zn(this.view,L.near(this.view.state.doc.resolve(e.pos)),"pointer"),t.preventDefault()):Ye(this.view,"pointer")}move(t){this.updateAllowDefault(t),Ye(this.view,"pointer"),t.buttons==0&&this.done()}updateAllowDefault(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}}Et.touchstart=n=>{n.input.lastTouch=Date.now(),Ia(n),Ye(n,"pointer")};Et.touchmove=n=>{n.input.lastTouch=Date.now(),Ye(n,"pointer")};Et.contextmenu=n=>Ia(n);function lu(n,t){return n.composing?!0:Ct&&Math.abs(t.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const lC=Ne?5e3:-1;Ot.compositionstart=Ot.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:t}=n,e=t.selection.$to;if(t.selection instanceof B&&(t.storedMarks||!e.textOffset&&e.parentOffset&&e.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||e.marks(),Ki(n,!0),n.markCursor=null;else if(Ki(n,!t.selection.empty),ie&&t.selection.empty&&e.parentOffset&&!e.textOffset&&e.nodeBefore.marks.length){let r=n.domSelectionRange();for(let i=r.focusNode,o=r.focusOffset;i&&i.nodeType==1&&o!=0;){let s=o<0?i.lastChild:i.childNodes[o-1];if(!s)break;if(s.nodeType==3){let a=n.domSelection();a&&a.collapse(s,s.nodeValue.length);break}else i=s,o=-1}}n.input.composing=!0}cu(n,lC)};Ot.compositionend=(n,t)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=t.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,cu(n,20))};function cu(n,t){clearTimeout(n.input.composingTimeout),t>-1&&(n.input.composingTimeout=setTimeout(()=>Ki(n),t))}function du(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=dC());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function cC(n){let t=n.domSelectionRange();if(!t.focusNode)return null;let e=eS(t.focusNode,t.focusOffset),r=nS(t.focusNode,t.focusOffset);if(e&&r&&e!=r){let i=r.pmViewDesc,o=n.domObserver.lastChangedTextNode;if(e==o||r==o)return o;if(!i||!i.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let s=e.pmViewDesc;if(!(!s||!s.isText(e.nodeValue)))return r}}return e||r}function dC(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function Ki(n,t=!1){if(!(Ne&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),du(n),t||n.docView&&n.docView.dirty){let e=_a(n);return e&&!e.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(e)):(n.markCursor||t)&&!n.state.selection.empty?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function hC(n,t){if(!n.dom.parentNode)return;let e=n.dom.parentNode.appendChild(document.createElement("div"));e.appendChild(t),e.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(t),n.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e),n.focus()},50)}const Yr=At&&Xe<15||or&&aS<604;Et.copy=Ot.cut=(n,t)=>{let e=t,r=n.state.selection,i=e.type=="cut";if(r.empty)return;let o=Yr?null:e.clipboardData,s=r.content(),{dom:a,text:l}=tu(n,s);o?(e.preventDefault(),o.clearData(),o.setData("text/html",a.innerHTML),o.setData("text/plain",l)):hC(n,a),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function uC(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function pC(n,t){if(!n.dom.parentNode)return;let e=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(e?"textarea":"div"));e||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),e?Xr(n,r.value,null,i,t):Xr(n,r.textContent,r.innerHTML,i,t)},50)}function Xr(n,t,e,r,i){let o=eu(n,t,e,r,n.state.selection.$from);if(n.someProp("handlePaste",l=>l(n,i,o||E.empty)))return!0;if(!o)return!1;let s=uC(o),a=s?n.state.tr.replaceSelectionWith(s,r):n.state.tr.replaceSelection(o);return n.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function hu(n){let t=n.getData("text/plain")||n.getData("Text");if(t)return t;let e=n.getData("text/uri-list");return e?e.replace(/\r?\n/g," "):""}Ot.paste=(n,t)=>{let e=t;if(n.composing&&!Ne)return;let r=Yr?null:e.clipboardData,i=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&Xr(n,hu(r),r.getData("text/html"),i,e)?e.preventDefault():pC(n,e)};class uu{constructor(t,e,r){this.slice=t,this.move=e,this.node=r}}const pu=Ht?"altKey":"ctrlKey";Et.dragstart=(n,t)=>{let e=t,r=n.input.mouseDown;if(r&&r.done(),!e.dataTransfer)return;let i=n.state.selection,o=i.empty?null:n.posAtCoords(wo(e)),s;if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof _?i.to-1:i.to))){if(r&&r.mightDrag)s=_.create(n.state.doc,r.mightDrag.pos);else if(e.target&&e.target.nodeType==1){let h=n.docView.nearestDesc(e.target,!0);h&&h.node.type.spec.draggable&&h!=n.docView&&(s=_.create(n.state.doc,h.posBefore))}}let a=(s||n.state.selection).content(),{dom:l,text:c,slice:d}=tu(n,a);(!e.dataTransfer.files.length||!vt||zh>120)&&e.dataTransfer.clearData(),e.dataTransfer.setData(Yr?"Text":"text/html",l.innerHTML),e.dataTransfer.effectAllowed="copyMove",Yr||e.dataTransfer.setData("text/plain",c),n.dragging=new uu(d,!e[pu],s)};Et.dragend=n=>{let t=n.dragging;window.setTimeout(()=>{n.dragging==t&&(n.dragging=null)},50)};Ot.dragover=Ot.dragenter=(n,t)=>t.preventDefault();Ot.drop=(n,t)=>{let e=t,r=n.dragging;if(n.dragging=null,!e.dataTransfer)return;let i=n.posAtCoords(wo(e));if(!i)return;let o=n.state.doc.resolve(i.pos),s=r&&r.slice;s?n.someProp("transformPasted",f=>{s=f(s,n)}):s=eu(n,hu(e.dataTransfer),Yr?null:e.dataTransfer.getData("text/html"),!1,o);let a=!!(r&&!e[pu]);if(n.someProp("handleDrop",f=>f(n,e,s||E.empty,a))){e.preventDefault();return}if(!s)return;e.preventDefault();let l=s?jk(n.state.doc,o.pos,s):o.pos;l==null&&(l=o.pos);let c=n.state.tr;if(a){let{node:f}=r;f?f.replace(c):c.deleteSelection()}let d=c.mapping.map(l),h=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,u=c.doc;if(h?c.replaceRangeWith(d,d,s.content.firstChild):c.replaceRange(d,d,s),c.doc.eq(u))return;let p=c.doc.resolve(d);if(h&&_.isSelectable(s.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(s.content.firstChild))c.setSelection(new _(p));else{let f=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((m,g,y,w)=>f=w),c.setSelection(Da(n,p,c.doc.resolve(f)))}n.focus(),n.dispatch(c.setMeta("uiEvent","drop"))};Et.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&Ie(n)},20))};Et.blur=(n,t)=>{let e=t;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),e.relatedTarget&&n.dom.contains(e.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};Et.beforeinput=(n,t)=>{if(vt&&Ne&&t.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",o=>o(n,bn(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in Ot)Et[n]=Ot[n];function Zr(n,t){if(n==t)return!0;for(let e in n)if(n[e]!==t[e])return!1;for(let e in t)if(!(e in n))return!1;return!0}class Gi{constructor(t,e){this.toDOM=t,this.spec=e||Cn,this.side=this.spec.side||0}map(t,e,r,i){let{pos:o,deleted:s}=t.mapResult(e.from+i,this.side<0?-1:1);return s?null:new qt(o-r,o-r,this)}valid(){return!0}eq(t){return this==t||t instanceof Gi&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&Zr(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class Qe{constructor(t,e){this.attrs=t,this.spec=e||Cn}map(t,e,r,i){let o=t.map(e.from+i,this.spec.inclusiveStart?-1:1)-r,s=t.map(e.to+i,this.spec.inclusiveEnd?1:-1)-r;return o>=s?null:new qt(o,s,this)}valid(t,e){return e.from<e.to}eq(t){return this==t||t instanceof Qe&&Zr(this.attrs,t.attrs)&&Zr(this.spec,t.spec)}static is(t){return t.type instanceof Qe}destroy(){}}class Pa{constructor(t,e){this.attrs=t,this.spec=e||Cn}map(t,e,r,i){let o=t.mapResult(e.from+i,1);if(o.deleted)return null;let s=t.mapResult(e.to+i,-1);return s.deleted||s.pos<=o.pos?null:new qt(o.pos-r,s.pos-r,this)}valid(t,e){let{index:r,offset:i}=t.content.findIndex(e.from),o;return i==e.from&&!(o=t.child(r)).isText&&i+o.nodeSize==e.to}eq(t){return this==t||t instanceof Pa&&Zr(this.attrs,t.attrs)&&Zr(this.spec,t.spec)}destroy(){}}class qt{constructor(t,e,r){this.from=t,this.to=e,this.type=r}copy(t,e){return new qt(t,e,this.type)}eq(t,e=0){return this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to}map(t,e,r){return this.type.map(t,this,e,r)}static widget(t,e,r){return new qt(t,t,new Gi(e,r))}static inline(t,e,r,i){return new qt(t,e,new Qe(r,i))}static node(t,e,r,i){return new qt(t,e,new Pa(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Qe}get widget(){return this.type instanceof Gi}}const Wn=[],Cn={};class rt{constructor(t,e){this.local=t.length?t:Wn,this.children=e.length?e:Wn}static create(t,e){return e.length?Ji(e,t,0,Cn):yt}find(t,e,r){let i=[];return this.findInner(t??0,e??1e9,i,0,r),i}findInner(t,e,r,i,o){for(let s=0;s<this.local.length;s++){let a=this.local[s];a.from<=e&&a.to>=t&&(!o||o(a.spec))&&r.push(a.copy(a.from+i,a.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<e&&this.children[s+1]>t){let a=this.children[s]+1;this.children[s+2].findInner(t-a,e-a,r,i+a,o)}}map(t,e,r){return this==yt||t.maps.length==0?this:this.mapInner(t,e,0,0,r||Cn)}mapInner(t,e,r,i,o){let s;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(t,r,i);l&&l.type.valid(e,l)?(s||(s=[])).push(l):o.onRemove&&o.onRemove(this.local[a].spec)}return this.children.length?fC(this.children,s||[],t,e,r,i,o):s?new rt(s.sort(En),Wn):yt}add(t,e){return e.length?this==yt?rt.create(t,e):this.addInner(t,e,0):this}addInner(t,e,r){let i,o=0;t.forEach((a,l)=>{let c=l+r,d;if(d=mu(e,a,c)){for(i||(i=this.children.slice());o<i.length&&i[o]<l;)o+=3;i[o]==l?i[o+2]=i[o+2].addInner(a,d,c+1):i.splice(o,0,l,l+a.nodeSize,Ji(d,a,c+1,Cn)),o+=3}});let s=fu(o?gu(e):e,-r);for(let a=0;a<s.length;a++)s[a].type.valid(t,s[a])||s.splice(a--,1);return new rt(s.length?this.local.concat(s).sort(En):this.local,i||this.children)}remove(t){return t.length==0||this==yt?this:this.removeInner(t,0)}removeInner(t,e){let r=this.children,i=this.local;for(let o=0;o<r.length;o+=3){let s,a=r[o]+e,l=r[o+1]+e;for(let d=0,h;d<t.length;d++)(h=t[d])&&h.from>a&&h.to<l&&(t[d]=null,(s||(s=[])).push(h));if(!s)continue;r==this.children&&(r=this.children.slice());let c=r[o+2].removeInner(s,a+1);c!=yt?r[o+2]=c:(r.splice(o,3),o-=3)}if(i.length){for(let o=0,s;o<t.length;o++)if(s=t[o])for(let a=0;a<i.length;a++)i[a].eq(s,e)&&(i==this.local&&(i=this.local.slice()),i.splice(a--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new rt(i,r):yt}forChild(t,e){if(this==yt)return this;if(e.isLeaf)return rt.empty;let r,i;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=t){this.children[a]==t&&(r=this.children[a+2]);break}let o=t+1,s=o+e.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<s&&l.to>o&&l.type instanceof Qe){let c=Math.max(o,l.from)-o,d=Math.min(s,l.to)-o;c<d&&(i||(i=[])).push(l.copy(c,d))}}if(i){let a=new rt(i.sort(En),Wn);return r?new We([a,r]):a}return r||yt}eq(t){if(this==t)return!0;if(!(t instanceof rt)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(let e=0;e<this.children.length;e+=3)if(this.children[e]!=t.children[e]||this.children[e+1]!=t.children[e+1]||!this.children[e+2].eq(t.children[e+2]))return!1;return!0}locals(t){return Ra(this.localsInner(t))}localsInner(t){if(this==yt)return Wn;if(t.inlineContent||!this.local.some(Qe.is))return this.local;let e=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Qe||e.push(this.local[r]);return e}forEachSet(t){t(this)}}rt.empty=new rt([],[]);rt.removeOverlap=Ra;const yt=rt.empty;class We{constructor(t){this.members=t}map(t,e){const r=this.members.map(i=>i.map(t,e,Cn));return We.from(r)}forChild(t,e){if(e.isLeaf)return rt.empty;let r=[];for(let i=0;i<this.members.length;i++){let o=this.members[i].forChild(t,e);o!=yt&&(o instanceof We?r=r.concat(o.members):r.push(o))}return We.from(r)}eq(t){if(!(t instanceof We)||t.members.length!=this.members.length)return!1;for(let e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0}locals(t){let e,r=!0;for(let i=0;i<this.members.length;i++){let o=this.members[i].localsInner(t);if(o.length)if(!e)e=o;else{r&&(e=e.slice(),r=!1);for(let s=0;s<o.length;s++)e.push(o[s])}}return e?Ra(r?e:e.sort(En)):Wn}static from(t){switch(t.length){case 0:return yt;case 1:return t[0];default:return new We(t.every(e=>e instanceof rt)?t:t.reduce((e,r)=>e.concat(r instanceof rt?r:r.members),[]))}}forEachSet(t){for(let e=0;e<this.members.length;e++)this.members[e].forEachSet(t)}}function fC(n,t,e,r,i,o,s){let a=n.slice();for(let c=0,d=o;c<e.maps.length;c++){let h=0;e.maps[c].forEach((u,p,f,m)=>{let g=m-f-(p-u);for(let y=0;y<a.length;y+=3){let w=a[y+1];if(w<0||u>w+d-h)continue;let k=a[y]+d-h;p>=k?a[y+1]=u<=k?-2:-1:u>=d&&g&&(a[y]+=g,a[y+1]+=g)}h+=g}),d=e.maps[c].map(d,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let d=e.map(n[c]+o),h=d-i;if(h<0||h>=r.content.size){l=!0;continue}let u=e.map(n[c+1]+o,-1),p=u-i,{index:f,offset:m}=r.content.findIndex(h),g=r.maybeChild(f);if(g&&m==h&&m+g.nodeSize==p){let y=a[c+2].mapInner(e,g,d+1,n[c]+o+1,s);y!=yt?(a[c]=h,a[c+1]=p,a[c+2]=y):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=mC(a,n,t,e,i,o,s),d=Ji(c,r,0,s);t=d.local;for(let h=0;h<a.length;h+=3)a[h+1]<0&&(a.splice(h,3),h-=3);for(let h=0,u=0;h<d.children.length;h+=3){let p=d.children[h];for(;u<a.length&&a[u]<p;)u+=3;a.splice(u,0,d.children[h],d.children[h+1],d.children[h+2])}}return new rt(t.sort(En),a)}function fu(n,t){if(!t||!n.length)return n;let e=[];for(let r=0;r<n.length;r++){let i=n[r];e.push(new qt(i.from+t,i.to+t,i.type))}return e}function mC(n,t,e,r,i,o,s){function a(l,c){for(let d=0;d<l.local.length;d++){let h=l.local[d].map(r,i,c);h?e.push(h):s.onRemove&&s.onRemove(l.local[d].spec)}for(let d=0;d<l.children.length;d+=3)a(l.children[d+2],l.children[d]+c+1)}for(let l=0;l<n.length;l+=3)n[l+1]==-1&&a(n[l+2],t[l]+o+1);return e}function mu(n,t,e){if(t.isLeaf)return null;let r=e+t.nodeSize,i=null;for(let o=0,s;o<n.length;o++)(s=n[o])&&s.from>e&&s.to<r&&((i||(i=[])).push(s),n[o]=null);return i}function gu(n){let t=[];for(let e=0;e<n.length;e++)n[e]!=null&&t.push(n[e]);return t}function Ji(n,t,e,r){let i=[],o=!1;t.forEach((a,l)=>{let c=mu(n,a,l+e);if(c){o=!0;let d=Ji(c,a,e+l+1,r);d!=yt&&i.push(l,l+a.nodeSize,d)}});let s=fu(o?gu(n):n,-e).sort(En);for(let a=0;a<s.length;a++)s[a].type.valid(t,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||i.length?new rt(s,i):yt}function En(n,t){return n.from-t.from||n.to-t.to}function Ra(n){let t=n;for(let e=0;e<t.length-1;e++){let r=t[e];if(r.from!=r.to)for(let i=e+1;i<t.length;i++){let o=t[i];if(o.from==r.from){o.to!=r.to&&(t==n&&(t=n.slice()),t[i]=o.copy(o.from,r.to),Mc(t,i+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(t==n&&(t=n.slice()),t[e]=r.copy(r.from,o.from),Mc(t,i,r.copy(o.from,r.to)));break}}}return t}function Mc(n,t,e){for(;t<n.length&&En(e,n[t])>0;)t++;n.splice(t,0,e)}function es(n){let t=[];return n.someProp("decorations",e=>{let r=e(n.state);r&&r!=yt&&t.push(r)}),n.cursorWrapper&&t.push(rt.create(n.state.doc,[n.cursorWrapper.deco])),We.from(t)}const gC={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},bC=At&&Xe<=11;class yC{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class vC{constructor(t,e){this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new yC,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);At&&Xe<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),bC&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,gC)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let e=0;e<t.length;e++)this.queue.push(t[e]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(vc(this.view)){if(this.suppressingSelectionUpdates)return Ie(this.view);if(At&&Xe<=11&&!this.view.state.selection.empty){let t=this.view.domSelectionRange();if(t.focusNode&&Nn(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(t){if(!t.focusNode)return!0;let e=new Set,r;for(let o=t.focusNode;o;o=Jr(o))e.add(o);for(let o=t.anchorNode;o;o=Jr(o))if(e.has(o)){r=o;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}flush(){let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let e=this.pendingRecords();e.length&&(this.queue=[]);let r=t.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&vc(t)&&!this.ignoreSelectionChange(r),o=-1,s=-1,a=!1,l=[];if(t.editable)for(let d=0;d<e.length;d++){let h=this.registerMutation(e[d],l);h&&(o=o<0?h.from:Math.min(h.from,o),s=s<0?h.to:Math.max(h.to,s),h.typeOver&&(a=!0))}if(ie&&l.length){let d=l.filter(h=>h.nodeName=="BR");if(d.length==2){let[h,u]=d;h.parentNode&&h.parentNode.parentNode==u.parentNode?u.remove():h.remove()}else{let{focusNode:h}=this.currentSelection;for(let u of d){let p=u.parentNode;p&&p.nodeName=="LI"&&(!h||kC(t,h)!=p)&&u.remove()}}}let c=null;o<0&&i&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&yo(r)&&(c=_a(t))&&c.eq(L.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,Ie(t),this.currentSelection.set(r),t.scrollToSelection()):(o>-1||i)&&(o>-1&&(t.docView.markDirty(o,s),wC(t)),this.handleDOMChange(o,s,a,l),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(r)||Ie(t),this.currentSelection.set(r))}registerMutation(t,e){if(e.indexOf(t.target)>-1)return null;let r=this.view.docView.nearestDesc(t.target);if(t.type=="attributes"&&(r==this.view.docView||t.attributeName=="contenteditable"||t.attributeName=="style"&&!t.oldValue&&!t.target.getAttribute("style"))||!r||r.ignoreMutation(t))return null;if(t.type=="childList"){for(let d=0;d<t.addedNodes.length;d++){let h=t.addedNodes[d];e.push(h),h.nodeType==3&&(this.lastChangedTextNode=h)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(t.target))return{from:r.posBefore,to:r.posAfter};let i=t.previousSibling,o=t.nextSibling;if(At&&Xe<=11&&t.addedNodes.length)for(let d=0;d<t.addedNodes.length;d++){let{previousSibling:h,nextSibling:u}=t.addedNodes[d];(!h||Array.prototype.indexOf.call(t.addedNodes,h)<0)&&(i=h),(!u||Array.prototype.indexOf.call(t.addedNodes,u)<0)&&(o=u)}let s=i&&i.parentNode==t.target?pt(i)+1:0,a=r.localPosFromDOM(t.target,s,-1),l=o&&o.parentNode==t.target?pt(o):t.target.childNodes.length,c=r.localPosFromDOM(t.target,l,1);return{from:a,to:c}}else return t.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=t.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:t.target.nodeValue==t.oldValue})}}let Tc=new WeakMap,Ac=!1;function wC(n){if(!Tc.has(n)&&(Tc.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=ie,Ac)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Ac=!0}}function _c(n,t){let e=t.startContainer,r=t.startOffset,i=t.endContainer,o=t.endOffset,s=n.domAtPos(n.state.selection.anchor);return Nn(s.node,s.offset,i,o)&&([e,r,i,o]=[i,o,e,r]),{anchorNode:e,anchorOffset:r,focusNode:i,focusOffset:o}}function xC(n,t){if(t.getComposedRanges){let i=t.getComposedRanges(n.root)[0];if(i)return _c(n,i)}let e;function r(i){i.preventDefault(),i.stopImmediatePropagation(),e=i.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),e?_c(n,e):null}function kC(n,t){for(let e=t.parentNode;e&&e!=n.dom;e=e.parentNode){let r=n.docView.nearestDesc(e,!0);if(r&&r.node.isBlock)return e}return null}function SC(n,t,e){let{node:r,fromOffset:i,toOffset:o,from:s,to:a}=n.docView.parseRange(t,e),l=n.domSelectionRange(),c,d=l.anchorNode;if(d&&n.dom.contains(d.nodeType==1?d:d.parentNode)&&(c=[{node:d,offset:l.anchorOffset}],yo(l)||c.push({node:l.focusNode,offset:l.focusOffset})),vt&&n.input.lastKeyCode===8)for(let g=o;g>i;g--){let y=r.childNodes[g-1],w=y.pmViewDesc;if(y.nodeName=="BR"&&!w){o=g;break}if(!w||w.size)break}let h=n.state.doc,u=n.someProp("domParser")||Sa.fromSchema(n.state.schema),p=h.resolve(s),f=null,m=u.parse(r,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:i,to:o,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:CC,context:p});if(c&&c[0].pos!=null){let g=c[0].pos,y=c[1]&&c[1].pos;y==null&&(y=g),f={anchor:g+s,head:y+s}}return{doc:m,sel:f,from:s,to:a}}function CC(n){let t=n.pmViewDesc;if(t)return t.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(Ct&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}else if(n.parentNode.lastChild==n||Ct&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const EC=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function OC(n,t,e,r,i){let o=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,t<0){let A=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,U=_a(n,A);if(U&&!n.state.selection.eq(U)){if(vt&&Ne&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",X=>X(n,bn(13,"Enter"))))return;let et=n.state.tr.setSelection(U);A=="pointer"?et.setMeta("pointer",!0):A=="key"&&et.scrollIntoView(),o&&et.setMeta("composition",o),n.dispatch(et)}return}let s=n.state.doc.resolve(t),a=s.sharedDepth(e);t=s.before(a+1),e=n.state.doc.resolve(e).after(a+1);let l=n.state.selection,c=SC(n,t,e),d=n.state.doc,h=d.slice(c.from,c.to),u,p;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(u=n.state.selection.to,p="end"):(u=n.state.selection.from,p="start"),n.input.lastKeyCode=null;let f=AC(h.content,c.doc.content,c.from,u,p);if(f&&n.input.domChangeCount++,(or&&n.input.lastIOSEnter>Date.now()-225||Ne)&&i.some(A=>A.nodeType==1&&!EC.test(A.nodeName))&&(!f||f.endA>=f.endB)&&n.someProp("handleKeyDown",A=>A(n,bn(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!f)if(r&&l instanceof B&&!l.empty&&l.$head.sameParent(l.$anchor)&&!n.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))f={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let A=Dc(n,n.state.doc,c.sel);if(A&&!A.eq(n.state.selection)){let U=n.state.tr.setSelection(A);o&&U.setMeta("composition",o),n.dispatch(U)}}return}n.state.selection.from<n.state.selection.to&&f.start==f.endB&&n.state.selection instanceof B&&(f.start>n.state.selection.from&&f.start<=n.state.selection.from+2&&n.state.selection.from>=c.from?f.start=n.state.selection.from:f.endA<n.state.selection.to&&f.endA>=n.state.selection.to-2&&n.state.selection.to<=c.to&&(f.endB+=n.state.selection.to-f.endA,f.endA=n.state.selection.to)),At&&Xe<=11&&f.endB==f.start+1&&f.endA==f.start&&f.start>c.from&&c.doc.textBetween(f.start-c.from-1,f.start-c.from+1)==" ย"&&(f.start--,f.endA--,f.endB--);let m=c.doc.resolveNoCache(f.start-c.from),g=c.doc.resolveNoCache(f.endB-c.from),y=d.resolve(f.start),w=m.sameParent(g)&&m.parent.inlineContent&&y.end()>=f.endA,k;if((or&&n.input.lastIOSEnter>Date.now()-225&&(!w||i.some(A=>A.nodeName=="DIV"||A.nodeName=="P"))||!w&&m.pos<c.doc.content.size&&!m.sameParent(g)&&(k=L.findFrom(c.doc.resolve(m.pos+1),1,!0))&&k.head==g.pos)&&n.someProp("handleKeyDown",A=>A(n,bn(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>f.start&&TC(d,f.start,f.endA,m,g)&&n.someProp("handleKeyDown",A=>A(n,bn(8,"Backspace")))){Ne&&vt&&n.domObserver.suppressSelectionUpdates();return}vt&&f.endB==f.start&&(n.input.lastChromeDelete=Date.now()),Ne&&!w&&m.start()!=g.start()&&g.parentOffset==0&&m.depth==g.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==f.endA&&(f.endB-=2,g=c.doc.resolveNoCache(f.endB-c.from),setTimeout(()=>{n.someProp("handleKeyDown",function(A){return A(n,bn(13,"Enter"))})},20));let M=f.start,T=f.endA,I,$,H;if(w){if(m.pos==g.pos)At&&Xe<=11&&m.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>Ie(n),20)),I=n.state.tr.delete(M,T),$=d.resolve(f.start).marksAcross(d.resolve(f.endA));else if(f.endA==f.endB&&(H=MC(m.parent.content.cut(m.parentOffset,g.parentOffset),y.parent.content.cut(y.parentOffset,f.endA-y.start()))))I=n.state.tr,H.type=="add"?I.addMark(M,T,H.mark):I.removeMark(M,T,H.mark);else if(m.parent.child(m.index()).isText&&m.index()==g.index()-(g.textOffset?0:1)){let A=m.parent.textBetween(m.parentOffset,g.parentOffset);if(n.someProp("handleTextInput",U=>U(n,M,T,A)))return;I=n.state.tr.insertText(A,M,T)}}if(I||(I=n.state.tr.replace(M,T,c.doc.slice(f.start-c.from,f.endB-c.from))),c.sel){let A=Dc(n,I.doc,c.sel);A&&!(vt&&n.composing&&A.empty&&(f.start!=f.endB||n.input.lastChromeDelete<Date.now()-100)&&(A.head==M||A.head==I.mapping.map(T)-1)||At&&A.empty&&A.head==M)&&I.setSelection(A)}$&&I.ensureMarks($),o&&I.setMeta("composition",o),n.dispatch(I.scrollIntoView())}function Dc(n,t,e){return Math.max(e.anchor,e.head)>t.content.size?null:Da(n,t.resolve(e.anchor),t.resolve(e.head))}function MC(n,t){let e=n.firstChild.marks,r=t.firstChild.marks,i=e,o=r,s,a,l;for(let d=0;d<r.length;d++)i=r[d].removeFromSet(i);for(let d=0;d<e.length;d++)o=e[d].removeFromSet(o);if(i.length==1&&o.length==0)a=i[0],s="add",l=d=>d.mark(a.addToSet(d.marks));else if(i.length==0&&o.length==1)a=o[0],s="remove",l=d=>d.mark(a.removeFromSet(d.marks));else return null;let c=[];for(let d=0;d<t.childCount;d++)c.push(l(t.child(d)));if(x.from(c).eq(n))return{mark:a,type:s}}function TC(n,t,e,r,i){if(e-t<=i.pos-r.pos||ns(r,!0,!1)<i.pos)return!1;let o=n.resolve(t);if(!r.parent.isTextblock){let a=o.nodeAfter;return a!=null&&e==t+a.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let s=n.resolve(ns(o,!0,!0));return!s.parent.isTextblock||s.pos>e||ns(s,!0,!1)<e?!1:r.parent.content.cut(r.parentOffset).eq(s.parent.content)}function ns(n,t,e){let r=n.depth,i=t?n.end():n.pos;for(;r>0&&(t||n.indexAfter(r)==n.node(r).childCount);)r--,i++,t=!1;if(e){let o=n.node(r).maybeChild(n.indexAfter(r));for(;o&&!o.isLeaf;)o=o.firstChild,i++}return i}function AC(n,t,e,r,i){let o=n.findDiffStart(t,e);if(o==null)return null;let{a:s,b:a}=n.findDiffEnd(t,e+n.size,e+t.size);if(i=="end"){let l=Math.max(0,o-Math.min(s,a));r-=s+l-o}if(s<o&&n.size<t.size){let l=r<=o&&r>=s?o-r:0;o-=l,o&&o<t.size&&$c(t.textBetween(o-1,o+1))&&(o+=l?1:-1),a=o+(a-s),s=o}else if(a<o){let l=r<=o&&r>=a?o-r:0;o-=l,o&&o<n.size&&$c(n.textBetween(o-1,o+1))&&(o+=l?1:-1),s=o+(s-a),a=o}return{start:o,endA:s,endB:a}}function $c(n){if(n.length!=2)return!1;let t=n.charCodeAt(0),e=n.charCodeAt(1);return t>=56320&&t<=57343&&e>=55296&&e<=56319}class _C{constructor(t,e){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new JS,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=e,this.state=e.state,this.directPlugins=e.plugins||[],this.directPlugins.forEach(Lc),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):typeof t=="function"?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=Pc(this),Ic(this),this.nodeViews=Rc(this),this.docView=pc(this.state.doc,Nc(this),es(this),this.dom,this),this.domObserver=new vC(this,(r,i,o,s)=>OC(this,r,i,o,s)),this.domObserver.start(),YS(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let e in t)this._props[e]=t[e];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&Js(this);let e=this._props;this._props=t,t.plugins&&(t.plugins.forEach(Lc),this.directPlugins=t.plugins),this.updateStateInner(t.state,e)}setProps(t){let e={};for(let r in this._props)e[r]=this._props[r];e.state=this.state;for(let r in t)e[r]=t[r];this.update(e)}updateState(t){this.updateStateInner(t,this._props)}updateStateInner(t,e){var r;let i=this.state,o=!1,s=!1;t.storedMarks&&this.composing&&(du(this),s=!0),this.state=t;let a=i.plugins!=t.plugins||this._props.plugins!=e.plugins;if(a||this._props.plugins!=e.plugins||this._props.nodeViews!=e.nodeViews){let p=Rc(this);$C(p,this.nodeViews)&&(this.nodeViews=p,o=!0)}(a||e.handleDOMEvents!=this._props.handleDOMEvents)&&Js(this),this.editable=Pc(this),Ic(this);let l=es(this),c=Nc(this),d=i.plugins!=t.plugins&&!i.doc.eq(t.doc)?"reset":t.scrollToSelection>i.scrollToSelection?"to selection":"preserve",h=o||!this.docView.matchesNode(t.doc,c,l);(h||!t.selection.eq(i.selection))&&(s=!0);let u=d=="preserve"&&s&&this.dom.style.overflowAnchor==null&&dS(this);if(s){this.domObserver.stop();let p=h&&(At||vt)&&!this.composing&&!i.selection.empty&&!t.selection.empty&&DC(i.selection,t.selection);if(h){let f=vt?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=cC(this)),(o||!this.docView.update(t.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=pc(t.doc,c,l,this.dom,this)),f&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&IS(this))?Ie(this,p):(Xh(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(t.doc)&&this.updateDraggedNode(this.dragging,i),d=="reset"?this.dom.scrollTop=0:d=="to selection"?this.scrollToSelection():u&&hS(u)}scrollToSelection(){let t=this.domSelectionRange().focusNode;if(!(!t||!this.dom.contains(t.nodeType==1?t:t.parentNode))){if(!this.someProp("handleScrollToSelection",e=>e(this)))if(this.state.selection instanceof _){let e=this.docView.domAfterPos(this.state.selection.from);e.nodeType==1&&ac(this,e.getBoundingClientRect(),t)}else ac(this,this.coordsAtPos(this.state.selection.head,1),t)}}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(!t||t.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let r=this.directPlugins[e];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let r=this.state.plugins[e];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let e=0;e<this.pluginViews.length;e++){let r=this.pluginViews[e];r.update&&r.update(this,t)}}updateDraggedNode(t,e){let r=t.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let o=r.from+(this.state.doc.content.size-e.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==r.node&&(i=o)}this.dragging=new uu(t.slice,t.move,i<0?void 0:_.create(this.state.doc,i))}someProp(t,e){let r=this._props&&this._props[t],i;if(r!=null&&(i=e?e(r):r))return i;for(let s=0;s<this.directPlugins.length;s++){let a=this.directPlugins[s].props[t];if(a!=null&&(i=e?e(a):a))return i}let o=this.state.plugins;if(o)for(let s=0;s<o.length;s++){let a=o[s].props[t];if(a!=null&&(i=e?e(a):a))return i}}hasFocus(){if(At){let t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if(t.contentEditable=="false")return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&uS(this.dom),Ie(this),this.domObserver.start()}get root(){let t=this._root;if(t==null){for(let e=this.dom.parentNode;e;e=e.parentNode)if(e.nodeType==9||e.nodeType==11&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=()=>e.ownerDocument.getSelection()),this._root=e}return t||document}updateRoot(){this._root=null}posAtCoords(t){return bS(this,t)}coordsAtPos(t,e=1){return Hh(this,t,e)}domAtPos(t,e=0){return this.docView.domFromPos(t,e)}nodeDOM(t){let e=this.docView.descAt(t);return e?e.nodeDOM:null}posAtDOM(t,e,r=-1){let i=this.docView.posFromDOM(t,e,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(t,e){return kS(this,e||this.state,t)}pasteHTML(t,e){return Xr(this,"",t,!1,e||new ClipboardEvent("paste"))}pasteText(t,e){return Xr(this,t,null,!0,e||new ClipboardEvent("paste"))}destroy(){this.docView&&(XS(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],es(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,Qk())}get isDestroyed(){return this.docView==null}dispatchEvent(t){return QS(this,t)}dispatch(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))}domSelectionRange(){let t=this.domSelection();return t?Ct&&this.root.nodeType===11&&iS(this.dom.ownerDocument)==this.dom&&xC(this,t)||t:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function Nc(n){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(n.editable),n.someProp("attributes",e=>{if(typeof e=="function"&&(e=e(n.state)),e)for(let r in e)r=="class"?t.class+=" "+e[r]:r=="style"?t.style=(t.style?t.style+";":"")+e[r]:!t[r]&&r!="contenteditable"&&r!="nodeName"&&(t[r]=String(e[r]))}),t.translate||(t.translate="no"),[qt.node(0,n.state.doc.content.size,t)]}function Ic(n){if(n.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),n.cursorWrapper={dom:t,deco:qt.widget(n.state.selection.from,t,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function Pc(n){return!n.someProp("editable",t=>t(n.state)===!1)}function DC(n,t){let e=Math.min(n.$anchor.sharedDepth(n.head),t.$anchor.sharedDepth(t.head));return n.$anchor.start(e)!=t.$anchor.start(e)}function Rc(n){let t=Object.create(null);function e(r){for(let i in r)Object.prototype.hasOwnProperty.call(t,i)||(t[i]=r[i])}return n.someProp("nodeViews",e),n.someProp("markViews",e),t}function $C(n,t){let e=0,r=0;for(let i in n){if(n[i]!=t[i])return!0;e++}for(let i in t)r++;return e!=r}function Lc(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var rn={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Yi={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},NC=typeof navigator<"u"&&/Mac/.test(navigator.platform),IC=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var ft=0;ft<10;ft++)rn[48+ft]=rn[96+ft]=String(ft);for(var ft=1;ft<=24;ft++)rn[ft+111]="F"+ft;for(var ft=65;ft<=90;ft++)rn[ft]=String.fromCharCode(ft+32),Yi[ft]=String.fromCharCode(ft);for(var rs in rn)Yi.hasOwnProperty(rs)||(Yi[rs]=rn[rs]);function PC(n){var t=NC&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||IC&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",e=!t&&n.key||(n.shiftKey?Yi:rn)[n.keyCode]||n.key||"Unidentified";return e=="Esc"&&(e="Escape"),e=="Del"&&(e="Delete"),e=="Left"&&(e="ArrowLeft"),e=="Up"&&(e="ArrowUp"),e=="Right"&&(e="ArrowRight"),e=="Down"&&(e="ArrowDown"),e}const RC=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function LC(n){let t=n.split(/-(?!$)/),e=t[t.length-1];e=="Space"&&(e=" ");let r,i,o,s;for(let a=0;a<t.length-1;a++){let l=t[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))RC?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(e="Alt-"+e),i&&(e="Ctrl-"+e),s&&(e="Meta-"+e),o&&(e="Shift-"+e),e}function zC(n){let t=Object.create(null);for(let e in n)t[LC(e)]=n[e];return t}function is(n,t,e=!0){return t.altKey&&(n="Alt-"+n),t.ctrlKey&&(n="Ctrl-"+n),t.metaKey&&(n="Meta-"+n),e&&t.shiftKey&&(n="Shift-"+n),n}function BC(n){return new Me({props:{handleKeyDown:FC(n)}})}function FC(n){let t=zC(n);return function(e,r){let i=PC(r),o,s=t[is(i,r)];if(s&&s(e.state,e.dispatch,e))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let a=t[is(i,r,!1)];if(a&&a(e.state,e.dispatch,e))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(o=rn[r.keyCode])&&o!=i){let a=t[is(o,r)];if(a&&a(e.state,e.dispatch,e))return!0}}return!1}}const jC=(n,t)=>n.selection.empty?!1:(t&&t(n.tr.deleteSelection().scrollIntoView()),!0);function VC(n,t){let{$cursor:e}=n.selection;return!e||(t?!t.endOfTextblock("backward",n):e.parentOffset>0)?null:e}const HC=(n,t,e)=>{let r=VC(n,e);if(!r)return!1;let i=bu(r);if(!i){let s=r.blockRange(),a=s&&Sr(s);return a==null?!1:(t&&t(n.tr.lift(s,a).scrollIntoView()),!0)}let o=i.nodeBefore;if(wu(n,i,t,-1))return!0;if(r.parent.content.size==0&&(sr(o,"end")||_.isSelectable(o)))for(let s=r.depth;;s--){let a=Ma(n.doc,r.before(s),r.after(s),E.empty);if(a&&a.slice.size<a.to-a.from){if(t){let l=n.tr.step(a);l.setSelection(sr(o,"end")?L.findFrom(l.doc.resolve(l.mapping.map(i.pos,-1)),-1):_.create(l.doc,i.pos-o.nodeSize)),t(l.scrollIntoView())}return!0}if(s==1||r.node(s-1).childCount>1)break}return o.isAtom&&i.depth==r.depth-1?(t&&t(n.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0):!1};function sr(n,t,e=!1){for(let r=n;r;r=t=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(e&&r.childCount!=1)return!1}return!1}const WC=(n,t,e)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(e?!e.endOfTextblock("backward",n):r.parentOffset>0)return!1;o=bu(r)}let s=o&&o.nodeBefore;return!s||!_.isSelectable(s)?!1:(t&&t(n.tr.setSelection(_.create(n.doc,o.pos-s.nodeSize)).scrollIntoView()),!0)};function bu(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){if(n.index(t)>0)return n.doc.resolve(n.before(t+1));if(n.node(t).type.spec.isolating)break}return null}function qC(n,t){let{$cursor:e}=n.selection;return!e||(t?!t.endOfTextblock("forward",n):e.parentOffset<e.parent.content.size)?null:e}const UC=(n,t,e)=>{let r=qC(n,e);if(!r)return!1;let i=yu(r);if(!i)return!1;let o=i.nodeAfter;if(wu(n,i,t,1))return!0;if(r.parent.content.size==0&&(sr(o,"start")||_.isSelectable(o))){let s=Ma(n.doc,r.before(),r.after(),E.empty);if(s&&s.slice.size<s.to-s.from){if(t){let a=n.tr.step(s);a.setSelection(sr(o,"start")?L.findFrom(a.doc.resolve(a.mapping.map(i.pos)),1):_.create(a.doc,a.mapping.map(i.pos))),t(a.scrollIntoView())}return!0}}return o.isAtom&&i.depth==r.depth-1?(t&&t(n.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0):!1},KC=(n,t,e)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(e?!e.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;o=yu(r)}let s=o&&o.nodeAfter;return!s||!_.isSelectable(s)?!1:(t&&t(n.tr.setSelection(_.create(n.doc,o.pos)).scrollIntoView()),!0)};function yu(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){let e=n.node(t);if(n.index(t)+1<e.childCount)return n.doc.resolve(n.after(t+1));if(e.type.spec.isolating)break}return null}const GC=(n,t)=>{let e=n.selection,r=e instanceof _,i;if(r){if(e.node.isTextblock||!hn(n.doc,e.from))return!1;i=e.from}else if(i=_h(n.doc,e.from,-1),i==null)return!1;if(t){let o=n.tr.join(i);r&&o.setSelection(_.create(o.doc,i-n.doc.resolve(i).nodeBefore.nodeSize)),t(o.scrollIntoView())}return!0},JC=(n,t)=>{let e=n.selection,r;if(e instanceof _){if(e.node.isTextblock||!hn(n.doc,e.to))return!1;r=e.to}else if(r=_h(n.doc,e.to,1),r==null)return!1;return t&&t(n.tr.join(r).scrollIntoView()),!0},YC=(n,t)=>{let{$from:e,$to:r}=n.selection,i=e.blockRange(r),o=i&&Sr(i);return o==null?!1:(t&&t(n.tr.lift(i,o).scrollIntoView()),!0)},XC=(n,t)=>{let{$head:e,$anchor:r}=n.selection;return!e.parent.type.spec.code||!e.sameParent(r)?!1:(t&&t(n.tr.insertText(`
`).scrollIntoView()),!0)};function vu(n){for(let t=0;t<n.edgeCount;t++){let{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}const ZC=(n,t)=>{let{$head:e,$anchor:r}=n.selection;if(!e.parent.type.spec.code||!e.sameParent(r))return!1;let i=e.node(-1),o=e.indexAfter(-1),s=vu(i.contentMatchAt(o));if(!s||!i.canReplaceWith(o,o,s))return!1;if(t){let a=e.after(),l=n.tr.replaceWith(a,a,s.createAndFill());l.setSelection(L.near(l.doc.resolve(a),1)),t(l.scrollIntoView())}return!0},QC=(n,t)=>{let e=n.selection,{$from:r,$to:i}=e;if(e instanceof ee||r.parent.inlineContent||i.parent.inlineContent)return!1;let o=vu(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(t){let s=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,a=n.tr.insert(s,o.createAndFill());a.setSelection(B.create(a.doc,s+1)),t(a.scrollIntoView())}return!0},tE=(n,t)=>{let{$cursor:e}=n.selection;if(!e||e.parent.content.size)return!1;if(e.depth>1&&e.after()!=e.end(-1)){let o=e.before();if(Yn(n.doc,o))return t&&t(n.tr.split(o).scrollIntoView()),!0}let r=e.blockRange(),i=r&&Sr(r);return i==null?!1:(t&&t(n.tr.lift(r,i).scrollIntoView()),!0)},eE=(n,t)=>{let{$from:e,to:r}=n.selection,i,o=e.sharedDepth(r);return o==0?!1:(i=e.before(o),t&&t(n.tr.setSelection(_.create(n.doc,i))),!0)};function nE(n,t,e){let r=t.nodeBefore,i=t.nodeAfter,o=t.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&t.parent.canReplace(o-1,o)?(e&&e(n.tr.delete(t.pos-r.nodeSize,t.pos).scrollIntoView()),!0):!t.parent.canReplace(o,o+1)||!(i.isTextblock||hn(n.doc,t.pos))?!1:(e&&e(n.tr.join(t.pos).scrollIntoView()),!0)}function wu(n,t,e,r){let i=t.nodeBefore,o=t.nodeAfter,s,a,l=i.type.spec.isolating||o.type.spec.isolating;if(!l&&nE(n,t,e))return!0;let c=!l&&t.parent.canReplace(t.index(),t.index()+1);if(c&&(s=(a=i.contentMatchAt(i.childCount)).findWrapping(o.type))&&a.matchType(s[0]||o.type).validEnd){if(e){let p=t.pos+o.nodeSize,f=x.empty;for(let y=s.length-1;y>=0;y--)f=x.from(s[y].create(null,f));f=x.from(i.copy(f));let m=n.tr.step(new st(t.pos-1,p,t.pos,p,new E(f,1,0),s.length,!0)),g=m.doc.resolve(p+2*s.length);g.nodeAfter&&g.nodeAfter.type==i.type&&hn(m.doc,g.pos)&&m.join(g.pos),e(m.scrollIntoView())}return!0}let d=o.type.spec.isolating||r>0&&l?null:L.findFrom(t,1),h=d&&d.$from.blockRange(d.$to),u=h&&Sr(h);if(u!=null&&u>=t.depth)return e&&e(n.tr.lift(h,u).scrollIntoView()),!0;if(c&&sr(o,"start",!0)&&sr(i,"end")){let p=i,f=[];for(;f.push(p),!p.isTextblock;)p=p.lastChild;let m=o,g=1;for(;!m.isTextblock;m=m.firstChild)g++;if(p.canReplace(p.childCount,p.childCount,m.content)){if(e){let y=x.empty;for(let k=f.length-1;k>=0;k--)y=x.from(f[k].copy(y));let w=n.tr.step(new st(t.pos-f.length,t.pos+o.nodeSize,t.pos+g,t.pos+o.nodeSize-g,new E(y,f.length,0),0,!0));e(w.scrollIntoView())}return!0}}return!1}function xu(n){return function(t,e){let r=t.selection,i=n<0?r.$from:r.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return i.node(o).isTextblock?(e&&e(t.tr.setSelection(B.create(t.doc,n<0?i.start(o):i.end(o)))),!0):!1}}const rE=xu(-1),iE=xu(1);function oE(n,t=null){return function(e,r){let{$from:i,$to:o}=e.selection,s=i.blockRange(o),a=s&&Oa(s,n,t);return a?(r&&r(e.tr.wrap(s,a).scrollIntoView()),!0):!1}}function zc(n,t=null){return function(e,r){let i=!1;for(let o=0;o<e.selection.ranges.length&&!i;o++){let{$from:{pos:s},$to:{pos:a}}=e.selection.ranges[o];e.doc.nodesBetween(s,a,(l,c)=>{if(i)return!1;if(!(!l.isTextblock||l.hasMarkup(n,t)))if(l.type==n)i=!0;else{let d=e.doc.resolve(c),h=d.index();i=d.parent.canReplaceWith(h,h+1,n)}})}if(!i)return!1;if(r){let o=e.tr;for(let s=0;s<e.selection.ranges.length;s++){let{$from:{pos:a},$to:{pos:l}}=e.selection.ranges[s];o.setBlockType(a,l,n,t)}r(o.scrollIntoView())}return!0}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function sE(n,t=null){return function(e,r){let{$from:i,$to:o}=e.selection,s=i.blockRange(o);if(!s)return!1;let a=r?e.tr:null;return aE(a,s,n,t)?(r&&r(a.scrollIntoView()),!0):!1}}function aE(n,t,e,r=null){let i=!1,o=t,s=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(e)&&t.startIndex==0){if(t.$from.index(t.depth-1)==0)return!1;let l=s.resolve(t.start-2);o=new Hi(l,l,t.depth),t.endIndex<t.parent.childCount&&(t=new Hi(t.$from,s.resolve(t.$to.end(t.depth)),t.depth)),i=!0}let a=Oa(o,e,r,t);return a?(n&&lE(n,t,a,i,e),!0):!1}function lE(n,t,e,r,i){let o=x.empty;for(let d=e.length-1;d>=0;d--)o=x.from(e[d].type.create(e[d].attrs,o));n.step(new st(t.start-(r?2:0),t.end,t.start,t.end,new E(o,0,0),e.length,!0));let s=0;for(let d=0;d<e.length;d++)e[d].type==i&&(s=d+1);let a=e.length-s,l=t.start+e.length-(r?2:0),c=t.parent;for(let d=t.startIndex,h=t.endIndex,u=!0;d<h;d++,u=!1)!u&&Yn(n.doc,l,a)&&(n.split(l,a),l+=2*a),l+=c.child(d).nodeSize;return n}function cE(n){return function(t,e){let{$from:r,$to:i}=t.selection,o=r.blockRange(i,s=>s.childCount>0&&s.firstChild.type==n);return o?e?r.node(o.depth-1).type==n?dE(t,e,n,o):hE(t,e,o):!0:!1}}function dE(n,t,e,r){let i=n.tr,o=r.end,s=r.$to.end(r.depth);o<s&&(i.step(new st(o-1,s,o,s,new E(x.from(e.create(null,r.parent.copy())),1,0),1,!0)),r=new Hi(i.doc.resolve(r.$from.pos),i.doc.resolve(s),r.depth));const a=Sr(r);if(a==null)return!1;i.lift(r,a);let l=i.mapping.map(o,-1)-1;return hn(i.doc,l)&&i.join(l),t(i.scrollIntoView()),!0}function hE(n,t,e){let r=n.tr,i=e.parent;for(let p=e.end,f=e.endIndex-1,m=e.startIndex;f>m;f--)p-=i.child(f).nodeSize,r.delete(p-1,p+1);let o=r.doc.resolve(e.start),s=o.nodeAfter;if(r.mapping.map(e.end)!=e.start+o.nodeAfter.nodeSize)return!1;let a=e.startIndex==0,l=e.endIndex==i.childCount,c=o.node(-1),d=o.index(-1);if(!c.canReplace(d+(a?0:1),d+1,s.content.append(l?x.empty:x.from(i))))return!1;let h=o.pos,u=h+s.nodeSize;return r.step(new st(h-(a?1:0),u+(l?1:0),h+1,u-1,new E((a?x.empty:x.from(i.copy(x.empty))).append(l?x.empty:x.from(i.copy(x.empty))),a?0:1,l?0:1),a?0:1)),t(r.scrollIntoView()),!0}function uE(n){return function(t,e){let{$from:r,$to:i}=t.selection,o=r.blockRange(i,c=>c.childCount>0&&c.firstChild.type==n);if(!o)return!1;let s=o.startIndex;if(s==0)return!1;let a=o.parent,l=a.child(s-1);if(l.type!=n)return!1;if(e){let c=l.lastChild&&l.lastChild.type==a.type,d=x.from(c?n.create():null),h=new E(x.from(n.create(null,x.from(a.type.create(null,d)))),c?3:1,0),u=o.start,p=o.end;e(t.tr.step(new st(u-(c?3:1),p,u,p,h,1,!0)).scrollIntoView())}return!0}}function xo(n){const{state:t,transaction:e}=n;let{selection:r}=e,{doc:i}=e,{storedMarks:o}=e;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),filterTransaction:t.filterTransaction,plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return o},get selection(){return r},get doc(){return i},get tr(){return r=e.selection,i=e.doc,o=e.storedMarks,e}}}class ko{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:r}=this,{view:i}=e,{tr:o}=r,s=this.buildProps(o);return Object.fromEntries(Object.entries(t).map(([a,l])=>[a,(...d)=>{const h=l(...d)(s);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(o),h}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i,a=[],l=!!t,c=t||o.tr,d=()=>(!l&&e&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(c),a.every(u=>u===!0)),h={...Object.fromEntries(Object.entries(r).map(([u,p])=>[u,(...m)=>{const g=this.buildProps(c,e),y=p(...m)(g);return a.push(y),h}])),run:d};return h}createCan(t){const{rawCommands:e,state:r}=this,i=!1,o=t||r.tr,s=this.buildProps(o,i);return{...Object.fromEntries(Object.entries(e).map(([l,c])=>[l,(...d)=>c(...d)({...s,dispatch:void 0})])),chain:()=>this.createChain(o,i)}}buildProps(t,e=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i;o.storedMarks&&t.setStoredMarks(o.storedMarks);const a={tr:t,editor:i,view:s,state:xo({state:o,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...d)=>c(...d)(a)]))}};return a}}class pE{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const r=this.callbacks[t];return r&&r.forEach(i=>i.apply(this,e)),this}off(t,e){const r=this.callbacks[t];return r&&(e?this.callbacks[t]=r.filter(i=>i!==e):delete this.callbacks[t]),this}removeAllListeners(){this.callbacks={}}}function O(n,t,e){return n.config[t]===void 0&&n.parent?O(n.parent,t,e):typeof n.config[t]=="function"?n.config[t].bind({...e,parent:n.parent?O(n.parent,t,e):null}):n.config[t]}function So(n){const t=n.filter(i=>i.type==="extension"),e=n.filter(i=>i.type==="node"),r=n.filter(i=>i.type==="mark");return{baseExtensions:t,nodeExtensions:e,markExtensions:r}}function ku(n){const t=[],{nodeExtensions:e,markExtensions:r}=So(n),i=[...e,...r],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage},l=O(s,"addGlobalAttributes",a);if(!l)return;l().forEach(d=>{d.types.forEach(h=>{Object.entries(d.attributes).forEach(([u,p])=>{t.push({type:h,name:u,attribute:{...o,...p}})})})})}),i.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage},l=O(s,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([d,h])=>{const u={...o,...h};h!=null&&h.isRequired&&(h==null?void 0:h.default)===void 0&&delete u.default,t.push({type:s.name,name:d,attribute:u})})}),t}function lt(n,t){if(typeof n=="string"){if(!t.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return t.nodes[n]}return n}function oe(...n){return n.filter(t=>!!t).reduce((t,e)=>{const r={...t};return Object.entries(e).forEach(([i,o])=>{if(!r[i]){r[i]=o;return}i==="class"?r[i]=[r[i],o].join(" "):i==="style"?r[i]=[r[i],o].join("; "):r[i]=o}),r},{})}function Ys(n,t){return t.filter(e=>e.attribute.rendered).map(e=>e.attribute.renderHTML?e.attribute.renderHTML(n.attrs)||{}:{[e.name]:n.attrs[e.name]}).reduce((e,r)=>oe(e,r),{})}function Su(n){return typeof n=="function"}function P(n,t=void 0,...e){return Su(n)?t?n.bind(t)(...e):n(...e):n}function fE(n={}){return Object.keys(n).length===0&&n.constructor===Object}function mE(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function Bc(n,t){return n.style?n:{...n,getAttrs:e=>{const r=n.getAttrs?n.getAttrs(e):n.attrs;if(r===!1)return!1;const i=t.reduce((o,s)=>{const a=s.attribute.parseHTML?s.attribute.parseHTML(e):mE(e.getAttribute(s.name));return a==null?o:{...o,[s.name]:a}},{});return{...r,...i}}}}function Fc(n){return Object.fromEntries(Object.entries(n).filter(([t,e])=>t==="attrs"&&fE(e)?!1:e!=null))}function gE(n){var t;const e=ku(n),{nodeExtensions:r,markExtensions:i}=So(n),o=(t=r.find(l=>O(l,"topNode")))===null||t===void 0?void 0:t.name,s=Object.fromEntries(r.map(l=>{const c=e.filter(g=>g.type===l.name),d={name:l.name,options:l.options,storage:l.storage},h=n.reduce((g,y)=>{const w=O(y,"extendNodeSchema",d);return{...g,...w?w(l):{}}},{}),u=Fc({...h,content:P(O(l,"content",d)),marks:P(O(l,"marks",d)),group:P(O(l,"group",d)),inline:P(O(l,"inline",d)),atom:P(O(l,"atom",d)),selectable:P(O(l,"selectable",d)),draggable:P(O(l,"draggable",d)),code:P(O(l,"code",d)),defining:P(O(l,"defining",d)),isolating:P(O(l,"isolating",d)),attrs:Object.fromEntries(c.map(g=>{var y;return[g.name,{default:(y=g==null?void 0:g.attribute)===null||y===void 0?void 0:y.default}]}))}),p=P(O(l,"parseHTML",d));p&&(u.parseDOM=p.map(g=>Bc(g,c)));const f=O(l,"renderHTML",d);f&&(u.toDOM=g=>f({node:g,HTMLAttributes:Ys(g,c)}));const m=O(l,"renderText",d);return m&&(u.toText=m),[l.name,u]})),a=Object.fromEntries(i.map(l=>{const c=e.filter(m=>m.type===l.name),d={name:l.name,options:l.options,storage:l.storage},h=n.reduce((m,g)=>{const y=O(g,"extendMarkSchema",d);return{...m,...y?y(l):{}}},{}),u=Fc({...h,inclusive:P(O(l,"inclusive",d)),excludes:P(O(l,"excludes",d)),group:P(O(l,"group",d)),spanning:P(O(l,"spanning",d)),code:P(O(l,"code",d)),attrs:Object.fromEntries(c.map(m=>{var g;return[m.name,{default:(g=m==null?void 0:m.attribute)===null||g===void 0?void 0:g.default}]}))}),p=P(O(l,"parseHTML",d));p&&(u.parseDOM=p.map(m=>Bc(m,c)));const f=O(l,"renderHTML",d);return f&&(u.toDOM=m=>f({mark:m,HTMLAttributes:Ys(m,c)})),[l.name,u]}));return new bk({topNode:o,nodes:s,marks:a})}function ss(n,t){return t.nodes[n]||t.marks[n]||null}function jc(n,t){return Array.isArray(t)?t.some(e=>(typeof e=="string"?e:e.name)===n.name):t}const bE=(n,t=500)=>{let e="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-t),r,(i,o,s,a)=>{var l,c;const d=((c=(l=i.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:i,pos:o,parent:s,index:a}))||i.textContent||"%leaf%";e+=d.slice(0,Math.max(0,r-o))}),e};function La(n){return Object.prototype.toString.call(n)==="[object RegExp]"}class Cu{constructor(t){this.find=t.find,this.handler=t.handler}}const yE=(n,t)=>{if(La(t))return t.exec(n);const e=t(n);if(!e)return null;const r=[];return r.push(e.text),r.index=e.index,r.input=n,r.data=e.data,e.replaceWith&&(e.text.includes(e.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(e.replaceWith)),r};function as(n){var t;const{editor:e,from:r,to:i,text:o,rules:s,plugin:a}=n,{view:l}=e;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||!((t=c.nodeBefore||c.nodeAfter)===null||t===void 0)&&t.marks.find(u=>u.type.spec.code))return!1;let d=!1;const h=bE(c)+o;return s.forEach(u=>{if(d)return;const p=yE(h,u.find);if(!p)return;const f=l.state.tr,m=xo({state:l.state,transaction:f}),g={from:r-(p[0].length-o.length),to:i},{commands:y,chain:w,can:k}=new ko({editor:e,state:m});u.handler({state:m,range:g,match:p,commands:y,chain:w,can:k})===null||!f.steps.length||(f.setMeta(a,{transform:f,from:r,to:i,text:o}),l.dispatch(f),d=!0)}),d}function vE(n){const{editor:t,rules:e}=n,r=new Me({state:{init(){return null},apply(i,o){const s=i.getMeta(r);return s||(i.selectionSet||i.docChanged?null:o)}},props:{handleTextInput(i,o,s,a){return as({editor:t,from:o,to:s,text:a,rules:e,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:o}=i.state.selection;o&&as({editor:t,from:o.pos,to:o.pos,text:"",rules:e,plugin:r})}),!1)},handleKeyDown(i,o){if(o.key!=="Enter")return!1;const{$cursor:s}=i.state.selection;return s?as({editor:t,from:s.pos,to:s.pos,text:`
`,rules:e,plugin:r}):!1}},isInputRules:!0});return r}function wE(n){return typeof n=="number"}class xE{constructor(t){this.find=t.find,this.handler=t.handler}}const kE=(n,t)=>{if(La(t))return[...n.matchAll(t)];const e=t(n);return e?e.map(r=>{const i=[];return i.push(r.text),i.index=r.index,i.input=n,i.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(r.replaceWith)),i}):[]};function SE(n){const{editor:t,state:e,from:r,to:i,rule:o}=n,{commands:s,chain:a,can:l}=new ko({editor:t,state:e}),c=[];return e.doc.nodesBetween(r,i,(h,u)=>{if(!h.isTextblock||h.type.spec.code)return;const p=Math.max(r,u),f=Math.min(i,u+h.content.size),m=h.textBetween(p-u,f-u,void 0,"๏ฟผ");kE(m,o.find).forEach(y=>{if(y.index===void 0)return;const w=p+y.index+1,k=w+y[0].length,M={from:e.tr.mapping.map(w),to:e.tr.mapping.map(k)},T=o.handler({state:e,range:M,match:y,commands:s,chain:a,can:l});c.push(T)})}),c.every(h=>h!==null)}function CE(n){const{editor:t,rules:e}=n;let r=null,i=!1,o=!1;return e.map(a=>new Me({view(l){const c=d=>{var h;r=!((h=l.dom.parentElement)===null||h===void 0)&&h.contains(d.target)?l.dom.parentElement:null};return window.addEventListener("dragstart",c),{destroy(){window.removeEventListener("dragstart",c)}}},props:{handleDOMEvents:{drop:l=>(o=r===l.dom.parentElement,!1),paste:(l,c)=>{var d;const h=(d=c.clipboardData)===null||d===void 0?void 0:d.getData("text/html");return i=!!(h!=null&&h.includes("data-pm-slice")),!1}}},appendTransaction:(l,c,d)=>{const h=l[0],u=h.getMeta("uiEvent")==="paste"&&!i,p=h.getMeta("uiEvent")==="drop"&&!o;if(!u&&!p)return;const f=c.doc.content.findDiffStart(d.doc.content),m=c.doc.content.findDiffEnd(d.doc.content);if(!wE(f)||!m||f===m.b)return;const g=d.tr,y=xo({state:d,transaction:g});if(!(!SE({editor:t,state:y,from:Math.max(f-1,0),to:m.b-1,rule:a})||!g.steps.length))return g}}))}function EE(n){const t=n.filter((e,r)=>n.indexOf(e)!==r);return[...new Set(t)]}class Un{constructor(t,e){this.splittableMarks=[],this.editor=e,this.extensions=Un.resolve(t),this.schema=gE(this.extensions),this.extensions.forEach(r=>{var i;this.editor.extensionStorage[r.name]=r.storage;const o={name:r.name,options:r.options,storage:r.storage,editor:this.editor,type:ss(r.name,this.schema)};r.type==="mark"&&(!((i=P(O(r,"keepOnSplit",o)))!==null&&i!==void 0)||i)&&this.splittableMarks.push(r.name);const s=O(r,"onBeforeCreate",o);s&&this.editor.on("beforeCreate",s);const a=O(r,"onCreate",o);a&&this.editor.on("create",a);const l=O(r,"onUpdate",o);l&&this.editor.on("update",l);const c=O(r,"onSelectionUpdate",o);c&&this.editor.on("selectionUpdate",c);const d=O(r,"onTransaction",o);d&&this.editor.on("transaction",d);const h=O(r,"onFocus",o);h&&this.editor.on("focus",h);const u=O(r,"onBlur",o);u&&this.editor.on("blur",u);const p=O(r,"onDestroy",o);p&&this.editor.on("destroy",p)})}static resolve(t){const e=Un.sort(Un.flatten(t)),r=EE(e.map(i=>i.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),e}static flatten(t){return t.map(e=>{const r={name:e.name,options:e.options,storage:e.storage},i=O(e,"addExtensions",r);return i?[e,...this.flatten(i())]:e}).flat(10)}static sort(t){return t.sort((r,i)=>{const o=O(r,"priority")||100,s=O(i,"priority")||100;return o>s?-1:o<s?1:0})}get commands(){return this.extensions.reduce((t,e)=>{const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:ss(e.name,this.schema)},i=O(e,"addCommands",r);return i?{...t,...i()}:t},{})}get plugins(){const{editor:t}=this,e=Un.sort([...this.extensions].reverse()),r=[],i=[],o=e.map(s=>{const a={name:s.name,options:s.options,storage:s.storage,editor:t,type:ss(s.name,this.schema)},l=[],c=O(s,"addKeyboardShortcuts",a);let d={};if(s.type==="mark"&&s.config.exitable&&(d.ArrowRight=()=>on.handleExit({editor:t,mark:s})),c){const m=Object.fromEntries(Object.entries(c()).map(([g,y])=>[g,()=>y({editor:t})]));d={...d,...m}}const h=BC(d);l.push(h);const u=O(s,"addInputRules",a);jc(s,t.options.enableInputRules)&&u&&r.push(...u());const p=O(s,"addPasteRules",a);jc(s,t.options.enablePasteRules)&&p&&i.push(...p());const f=O(s,"addProseMirrorPlugins",a);if(f){const m=f();l.push(...m)}return l}).flat();return[vE({editor:t,rules:r}),...CE({editor:t,rules:i}),...o]}get attributes(){return ku(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=So(this.extensions);return Object.fromEntries(e.filter(r=>!!O(r,"addNodeView")).map(r=>{const i=this.attributes.filter(l=>l.type===r.name),o={name:r.name,options:r.options,storage:r.storage,editor:t,type:lt(r.name,this.schema)},s=O(r,"addNodeView",o);if(!s)return[];const a=(l,c,d,h)=>{const u=Ys(l,i);return s()({editor:t,node:l,getPos:d,decorations:h,HTMLAttributes:u,extension:r})};return[r.name,a]}))}}function OE(n){return Object.prototype.toString.call(n).slice(8,-1)}function ls(n){return OE(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function Co(n,t){const e={...n};return ls(n)&&ls(t)&&Object.keys(t).forEach(r=>{ls(t[r])?r in n?e[r]=Co(n[r],t[r]):Object.assign(e,{[r]:t[r]}):Object.assign(e,{[r]:t[r]})}),e}class se{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=P(O(this,"addOptions",{name:this.name}))),this.storage=P(O(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new se(t)}configure(t={}){const e=this.extend();return e.options=Co(this.options,t),e.storage=P(O(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new se(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=P(O(e,"addOptions",{name:e.name})),e.storage=P(O(e,"addStorage",{name:e.name,options:e.options})),e}}function Eu(n,t,e){const{from:r,to:i}=t,{blockSeparator:o=`

`,textSerializers:s={}}=e||{};let a="",l=!0;return n.nodesBetween(r,i,(c,d,h,u)=>{var p;const f=s==null?void 0:s[c.type.name];f?(c.isBlock&&!l&&(a+=o,l=!0),h&&(a+=f({node:c,pos:d,parent:h,index:u,range:t}))):c.isText?(a+=(p=c==null?void 0:c.text)===null||p===void 0?void 0:p.slice(Math.max(r,d)-d,i-d),l=!1):c.isBlock&&!l&&(a+=o,l=!0)}),a}function Ou(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,t])=>t.spec.toText).map(([t,e])=>[t,e.spec.toText]))}const ME=se.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new Me({key:new Bn("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:t,schema:e}=n,{doc:r,selection:i}=t,{ranges:o}=i,s=Math.min(...o.map(d=>d.$from.pos)),a=Math.max(...o.map(d=>d.$to.pos)),l=Ou(e);return Eu(r,{from:s,to:a},{textSerializers:l})}}})]}}),TE=()=>({editor:n,view:t})=>(requestAnimationFrame(()=>{var e;n.isDestroyed||(t.dom.blur(),(e=window==null?void 0:window.getSelection())===null||e===void 0||e.removeAllRanges())}),!0),AE=(n=!1)=>({commands:t})=>t.setContent("",n),_E=()=>({state:n,tr:t,dispatch:e})=>{const{selection:r}=t,{ranges:i}=r;return e&&i.forEach(({$from:o,$to:s})=>{n.doc.nodesBetween(o.pos,s.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:d}=t,h=c.resolve(d.map(l)),u=c.resolve(d.map(l+a.nodeSize)),p=h.blockRange(u);if(!p)return;const f=Sr(p);if(a.type.isTextblock){const{defaultType:m}=h.parent.contentMatchAt(h.index());t.setNodeMarkup(p.start,m)}(f||f===0)&&t.lift(p,f)})}),!0},DE=n=>t=>n(t),$E=()=>({state:n,dispatch:t})=>QC(n,t),NE=()=>({tr:n,dispatch:t})=>{const{selection:e}=n,r=e.$anchor.node();if(r.content.size>0)return!1;const i=n.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===r.type){if(t){const a=i.before(o),l=i.after(o);n.delete(a,l).scrollIntoView()}return!0}return!1},IE=n=>({tr:t,state:e,dispatch:r})=>{const i=lt(n,e.schema),o=t.selection.$anchor;for(let s=o.depth;s>0;s-=1)if(o.node(s).type===i){if(r){const l=o.before(s),c=o.after(s);t.delete(l,c).scrollIntoView()}return!0}return!1},PE=n=>({tr:t,dispatch:e})=>{const{from:r,to:i}=n;return e&&t.delete(r,i),!0},RE=()=>({state:n,dispatch:t})=>jC(n,t),LE=()=>({commands:n})=>n.keyboardShortcut("Enter"),zE=()=>({state:n,dispatch:t})=>ZC(n,t);function Xi(n,t,e={strict:!0}){const r=Object.keys(t);return r.length?r.every(i=>e.strict?t[i]===n[i]:La(t[i])?t[i].test(n[i]):t[i]===n[i]):!0}function Xs(n,t,e={}){return n.find(r=>r.type===t&&Xi(r.attrs,e))}function BE(n,t,e={}){return!!Xs(n,t,e)}function za(n,t,e={}){if(!n||!t)return;let r=n.parent.childAfter(n.parentOffset);if(n.parentOffset===r.offset&&r.offset!==0&&(r=n.parent.childBefore(n.parentOffset)),!r.node)return;const i=Xs([...r.node.marks],t,e);if(!i)return;let o=r.index,s=n.start()+r.offset,a=o+1,l=s+r.node.nodeSize;for(Xs([...r.node.marks],t,e);o>0&&i.isInSet(n.parent.child(o-1).marks);)o-=1,s-=n.parent.child(o).nodeSize;for(;a<n.parent.childCount&&BE([...n.parent.child(a).marks],t,e);)l+=n.parent.child(a).nodeSize,a+=1;return{from:s,to:l}}function pn(n,t){if(typeof n=="string"){if(!t.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return t.marks[n]}return n}const FE=(n,t={})=>({tr:e,state:r,dispatch:i})=>{const o=pn(n,r.schema),{doc:s,selection:a}=e,{$from:l,from:c,to:d}=a;if(i){const h=za(l,o,t);if(h&&h.from<=c&&h.to>=d){const u=B.create(s,h.from,h.to);e.setSelection(u)}}return!0},jE=n=>t=>{const e=typeof n=="function"?n(t):n;for(let r=0;r<e.length;r+=1)if(e[r](t))return!0;return!1};function Mu(n){return n instanceof B}function wn(n=0,t=0,e=0){return Math.min(Math.max(n,t),e)}function Tu(n,t=null){if(!t)return null;const e=L.atStart(n),r=L.atEnd(n);if(t==="start"||t===!0)return e;if(t==="end")return r;const i=e.from,o=r.to;return t==="all"?B.create(n,wn(0,i,o),wn(n.content.size,i,o)):B.create(n,wn(t,i,o),wn(t,i,o))}function Ba(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const VE=(n=null,t={})=>({editor:e,view:r,tr:i,dispatch:o})=>{t={scrollIntoView:!0,...t};const s=()=>{Ba()&&r.dom.focus(),requestAnimationFrame(()=>{e.isDestroyed||(r.focus(),t!=null&&t.scrollIntoView&&e.commands.scrollIntoView())})};if(r.hasFocus()&&n===null||n===!1)return!0;if(o&&n===null&&!Mu(e.state.selection))return s(),!0;const a=Tu(i.doc,n)||e.state.selection,l=e.state.selection.eq(a);return o&&(l||i.setSelection(a),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0},HE=(n,t)=>e=>n.every((r,i)=>t(r,{...e,index:i})),WE=(n,t)=>({tr:e,commands:r})=>r.insertContentAt({from:e.selection.from,to:e.selection.to},n,t);function Vc(n){const t=`<body>${n}</body>`;return new window.DOMParser().parseFromString(t,"text/html").body}function Zi(n,t,e){if(e={slice:!0,parseOptions:{},...e},typeof n=="object"&&n!==null)try{return Array.isArray(n)?x.fromArray(n.map(r=>t.nodeFromJSON(r))):t.nodeFromJSON(n)}catch(r){return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",r),Zi("",t,e)}if(typeof n=="string"){const r=Sa.fromSchema(t);return e.slice?r.parseSlice(Vc(n),e.parseOptions).content:r.parse(Vc(n),e.parseOptions)}return Zi("",t,e)}function qE(n,t,e){const r=n.steps.length-1;if(r<t)return;const i=n.steps[r];if(!(i instanceof ut||i instanceof st))return;const o=n.mapping.maps[r];let s=0;o.forEach((a,l,c,d)=>{s===0&&(s=d)}),n.setSelection(L.near(n.doc.resolve(s),e))}const UE=n=>n.toString().startsWith("<"),KE=(n,t,e)=>({tr:r,dispatch:i,editor:o})=>{if(i){e={parseOptions:{},updateSelection:!0,...e};const s=Zi(t,o.schema,{parseOptions:{preserveWhitespace:"full",...e.parseOptions}});if(s.toString()==="<>")return!0;let{from:a,to:l}=typeof n=="number"?{from:n,to:n}:n,c=!0,d=!0;if((UE(s)?s:[s]).forEach(u=>{u.check(),c=c?u.isText&&u.marks.length===0:!1,d=d?u.isBlock:!1}),a===l&&d){const{parent:u}=r.doc.resolve(a);u.isTextblock&&!u.type.spec.code&&!u.childCount&&(a-=1,l+=1)}c?r.insertText(t,a,l):r.replaceWith(a,l,s),e.updateSelection&&qE(r,r.steps.length-1,-1)}return!0},GE=()=>({state:n,dispatch:t})=>GC(n,t),JE=()=>({state:n,dispatch:t})=>JC(n,t),YE=()=>({state:n,dispatch:t})=>HC(n,t),XE=()=>({state:n,dispatch:t})=>UC(n,t);function Au(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function ZE(n){const t=n.split(/-(?!$)/);let e=t[t.length-1];e==="Space"&&(e=" ");let r,i,o,s;for(let a=0;a<t.length-1;a+=1){const l=t[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))Ba()||Au()?s=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(e=`Alt-${e}`),i&&(e=`Ctrl-${e}`),s&&(e=`Meta-${e}`),o&&(e=`Shift-${e}`),e}const QE=n=>({editor:t,view:e,tr:r,dispatch:i})=>{const o=ZE(n).split(/-(?!$)/),s=o.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction(()=>{e.someProp("handleKeyDown",c=>c(e,a))});return l==null||l.steps.forEach(c=>{const d=c.map(r.mapping);d&&i&&r.maybeStep(d)}),!0};function Qr(n,t,e={}){const{from:r,to:i,empty:o}=n.selection,s=t?lt(t,n.schema):null,a=[];n.doc.nodesBetween(r,i,(h,u)=>{if(h.isText)return;const p=Math.max(r,u),f=Math.min(i,u+h.nodeSize);a.push({node:h,from:p,to:f})});const l=i-r,c=a.filter(h=>s?s.name===h.node.type.name:!0).filter(h=>Xi(h.node.attrs,e,{strict:!1}));return o?!!c.length:c.reduce((h,u)=>h+u.to-u.from,0)>=l}const t2=(n,t={})=>({state:e,dispatch:r})=>{const i=lt(n,e.schema);return Qr(e,i,t)?YC(e,r):!1},e2=()=>({state:n,dispatch:t})=>tE(n,t),n2=n=>({state:t,dispatch:e})=>{const r=lt(n,t.schema);return cE(r)(t,e)},r2=()=>({state:n,dispatch:t})=>XC(n,t);function Eo(n,t){return t.nodes[n]?"node":t.marks[n]?"mark":null}function Hc(n,t){const e=typeof t=="string"?[t]:t;return Object.keys(n).reduce((r,i)=>(e.includes(i)||(r[i]=n[i]),r),{})}const i2=(n,t)=>({tr:e,state:r,dispatch:i})=>{let o=null,s=null;const a=Eo(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(o=lt(n,r.schema)),a==="mark"&&(s=pn(n,r.schema)),i&&e.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,d)=>{o&&o===c.type&&e.setNodeMarkup(d,void 0,Hc(c.attrs,t)),s&&c.marks.length&&c.marks.forEach(h=>{s===h.type&&e.addMark(d,d+c.nodeSize,s.create(Hc(h.attrs,t)))})})}),!0):!1},o2=()=>({tr:n,dispatch:t})=>(t&&n.scrollIntoView(),!0),s2=()=>({tr:n,commands:t})=>t.setTextSelection({from:0,to:n.doc.content.size}),a2=()=>({state:n,dispatch:t})=>WC(n,t),l2=()=>({state:n,dispatch:t})=>KC(n,t),c2=()=>({state:n,dispatch:t})=>eE(n,t),d2=()=>({state:n,dispatch:t})=>iE(n,t),h2=()=>({state:n,dispatch:t})=>rE(n,t);function _u(n,t,e={}){return Zi(n,t,{slice:!1,parseOptions:e})}const u2=(n,t=!1,e={})=>({tr:r,editor:i,dispatch:o})=>{const{doc:s}=r,a=_u(n,i.schema,e);return o&&r.replaceWith(0,s.content.size,a).setMeta("preventUpdate",!t),!0};function p2(n){for(let t=0;t<n.edgeCount;t+=1){const{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}function f2(n,t){for(let e=n.depth;e>0;e-=1){const r=n.node(e);if(t(r))return{pos:e>0?n.before(e):0,start:n.start(e),depth:e,node:r}}}function Fa(n){return t=>f2(t.$from,n)}function m2(n,t){const e=zn.fromSchema(t).serializeFragment(n),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(e),i.innerHTML}function g2(n,t){const e={from:0,to:n.content.size};return Eu(n,e,t)}function ja(n,t){const e=pn(t,n.schema),{from:r,to:i,empty:o}=n.selection,s=[];o?(n.storedMarks&&s.push(...n.storedMarks),s.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,i,l=>{s.push(...l.marks)});const a=s.find(l=>l.type.name===e.name);return a?{...a.attrs}:{}}function b2(n,t){const e=lt(t,n.schema),{from:r,to:i}=n.selection,o=[];n.doc.nodesBetween(r,i,a=>{o.push(a)});const s=o.reverse().find(a=>a.type.name===e.name);return s?{...s.attrs}:{}}function y2(n,t){const e=Eo(typeof t=="string"?t:t.name,n.schema);return e==="node"?b2(n,t):e==="mark"?ja(n,t):{}}function Du(n,t,e){const r=[];return n===t?e.resolve(n).marks().forEach(i=>{const o=e.resolve(n-1),s=za(o,i.type);s&&r.push({mark:i,...s})}):e.nodesBetween(n,t,(i,o)=>{r.push(...i.marks.map(s=>({from:o,to:o+i.nodeSize,mark:s})))}),r}function Zs(n,t,e={}){const{empty:r,ranges:i}=n.selection,o=t?pn(t,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(h=>o?o.name===h.type.name:!0).find(h=>Xi(h.attrs,e,{strict:!1}));let s=0;const a=[];if(i.forEach(({$from:h,$to:u})=>{const p=h.pos,f=u.pos;n.doc.nodesBetween(p,f,(m,g)=>{if(!m.isText&&!m.marks.length)return;const y=Math.max(p,g),w=Math.min(f,g+m.nodeSize),k=w-y;s+=k,a.push(...m.marks.map(M=>({mark:M,from:y,to:w})))})}),s===0)return!1;const l=a.filter(h=>o?o.name===h.mark.type.name:!0).filter(h=>Xi(h.mark.attrs,e,{strict:!1})).reduce((h,u)=>h+u.to-u.from,0),c=a.filter(h=>o?h.mark.type!==o&&h.mark.type.excludes(o):!0).reduce((h,u)=>h+u.to-u.from,0);return(l>0?l+c:l)>=s}function v2(n,t,e={}){if(!t)return Qr(n,null,e)||Zs(n,null,e);const r=Eo(t,n.schema);return r==="node"?Qr(n,t,e):r==="mark"?Zs(n,t,e):!1}function Wc(n,t){const{nodeExtensions:e}=So(t),r=e.find(s=>s.name===n);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},o=P(O(r,"group",i));return typeof o!="string"?!1:o.split(" ").includes("list")}function w2(n){var t;const e=(t=n.type.createAndFill())===null||t===void 0?void 0:t.toJSON(),r=n.toJSON();return JSON.stringify(e)===JSON.stringify(r)}function x2(n,t,e){var r;const{selection:i}=t;let o=null;if(Mu(i)&&(o=i.$cursor),o){const a=(r=n.storedMarks)!==null&&r!==void 0?r:o.marks();return!!e.isInSet(a)||!a.some(l=>l.type.excludes(e))}const{ranges:s}=i;return s.some(({$from:a,$to:l})=>{let c=a.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(e):!1;return n.doc.nodesBetween(a.pos,l.pos,(d,h,u)=>{if(c)return!1;if(d.isInline){const p=!u||u.type.allowsMarkType(e),f=!!e.isInSet(d.marks)||!d.marks.some(m=>m.type.excludes(e));c=p&&f}return!c}),c})}const k2=(n,t={})=>({tr:e,state:r,dispatch:i})=>{const{selection:o}=e,{empty:s,ranges:a}=o,l=pn(n,r.schema);if(i)if(s){const c=ja(r,l);e.addStoredMark(l.create({...c,...t}))}else a.forEach(c=>{const d=c.$from.pos,h=c.$to.pos;r.doc.nodesBetween(d,h,(u,p)=>{const f=Math.max(p,d),m=Math.min(p+u.nodeSize,h);u.marks.find(y=>y.type===l)?u.marks.forEach(y=>{l===y.type&&e.addMark(f,m,l.create({...y.attrs,...t}))}):e.addMark(f,m,l.create(t))})});return x2(r,e,l)},S2=(n,t)=>({tr:e})=>(e.setMeta(n,t),!0),C2=(n,t={})=>({state:e,dispatch:r,chain:i})=>{const o=lt(n,e.schema);return o.isTextblock?i().command(({commands:s})=>zc(o,t)(e)?!0:s.clearNodes()).command(({state:s})=>zc(o,t)(s,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},E2=n=>({tr:t,dispatch:e})=>{if(e){const{doc:r}=t,i=wn(n,0,r.content.size),o=_.create(r,i);t.setSelection(o)}return!0},O2=n=>({tr:t,dispatch:e})=>{if(e){const{doc:r}=t,{from:i,to:o}=typeof n=="number"?{from:n,to:n}:n,s=B.atStart(r).from,a=B.atEnd(r).to,l=wn(i,s,a),c=wn(o,s,a),d=B.create(r,l,c);t.setSelection(d)}return!0},M2=n=>({state:t,dispatch:e})=>{const r=lt(n,t.schema);return uE(r)(t,e)};function Ci(n,t,e){return Object.fromEntries(Object.entries(e).filter(([r])=>{const i=n.find(o=>o.type===t&&o.name===r);return i?i.attribute.keepOnSplit:!1}))}function qc(n,t){const e=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(e){const r=e.filter(i=>t==null?void 0:t.includes(i.type.name));n.tr.ensureMarks(r)}}const T2=({keepMarks:n=!0}={})=>({tr:t,state:e,dispatch:r,editor:i})=>{const{selection:o,doc:s}=t,{$from:a,$to:l}=o,c=i.extensionManager.attributes,d=Ci(c,a.node().type.name,a.node().attrs);if(o instanceof _&&o.node.isBlock)return!a.parentOffset||!Yn(s,a.pos)?!1:(r&&(n&&qc(e,i.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;if(r){const h=l.parentOffset===l.parent.content.size;o instanceof B&&t.deleteSelection();const u=a.depth===0?void 0:p2(a.node(-1).contentMatchAt(a.indexAfter(-1)));let p=h&&u?[{type:u,attrs:d}]:void 0,f=Yn(t.doc,t.mapping.map(a.pos),1,p);if(!p&&!f&&Yn(t.doc,t.mapping.map(a.pos),1,u?[{type:u}]:void 0)&&(f=!0,p=u?[{type:u,attrs:d}]:void 0),f&&(t.split(t.mapping.map(a.pos),1,p),u&&!h&&!a.parentOffset&&a.parent.type!==u)){const m=t.mapping.map(a.before()),g=t.doc.resolve(m);a.node(-1).canReplaceWith(g.index(),g.index()+1,u)&&t.setNodeMarkup(t.mapping.map(a.before()),u)}n&&qc(e,i.extensionManager.splittableMarks),t.scrollIntoView()}return!0},A2=n=>({tr:t,state:e,dispatch:r,editor:i})=>{var o;const s=lt(n,e.schema),{$from:a,$to:l}=e.selection,c=e.selection.node;if(c&&c.isBlock||a.depth<2||!a.sameParent(l))return!1;const d=a.node(-1);if(d.type!==s)return!1;const h=i.extensionManager.attributes;if(a.parent.content.size===0&&a.node(-1).childCount===a.indexAfter(-1)){if(a.depth===2||a.node(-3).type!==s||a.index(-2)!==a.node(-2).childCount-1)return!1;if(r){let g=x.empty;const y=a.index(-1)?1:a.index(-2)?2:3;for(let $=a.depth-y;$>=a.depth-3;$-=1)g=x.from(a.node($).copy(g));const w=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,k=Ci(h,a.node().type.name,a.node().attrs),M=((o=s.contentMatch.defaultType)===null||o===void 0?void 0:o.createAndFill(k))||void 0;g=g.append(x.from(s.createAndFill(null,M)||void 0));const T=a.before(a.depth-(y-1));t.replace(T,a.after(-w),new E(g,4-y,0));let I=-1;t.doc.nodesBetween(T,t.doc.content.size,($,H)=>{if(I>-1)return!1;$.isTextblock&&$.content.size===0&&(I=H+1)}),I>-1&&t.setSelection(B.near(t.doc.resolve(I))),t.scrollIntoView()}return!0}const u=l.pos===a.end()?d.contentMatchAt(0).defaultType:null,p=Ci(h,d.type.name,d.attrs),f=Ci(h,a.node().type.name,a.node().attrs);t.delete(a.pos,l.pos);const m=u?[{type:s,attrs:p},{type:u,attrs:f}]:[{type:s,attrs:p}];return Yn(t.doc,a.pos,2)?(r&&t.split(a.pos,2,m).scrollIntoView(),!0):!1},Uc=(n,t)=>{const e=Fa(s=>s.type===t)(n.selection);if(!e)return!0;const r=n.doc.resolve(Math.max(0,e.pos-1)).before(e.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return e.node.type===(i==null?void 0:i.type)&&hn(n.doc,e.pos)&&n.join(e.pos),!0},Kc=(n,t)=>{const e=Fa(s=>s.type===t)(n.selection);if(!e)return!0;const r=n.doc.resolve(e.start).after(e.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return e.node.type===(i==null?void 0:i.type)&&hn(n.doc,r)&&n.join(r),!0},_2=(n,t)=>({editor:e,tr:r,state:i,dispatch:o,chain:s,commands:a,can:l})=>{const{extensions:c}=e.extensionManager,d=lt(n,i.schema),h=lt(t,i.schema),{selection:u}=i,{$from:p,$to:f}=u,m=p.blockRange(f);if(!m)return!1;const g=Fa(y=>Wc(y.type.name,c))(u);if(m.depth>=1&&g&&m.depth-g.depth<=1){if(g.node.type===d)return a.liftListItem(h);if(Wc(g.node.type.name,c)&&d.validContent(g.node.content)&&o)return s().command(()=>(r.setNodeMarkup(g.pos,d),!0)).command(()=>Uc(r,d)).command(()=>Kc(r,d)).run()}return s().command(()=>l().wrapInList(d)?!0:a.clearNodes()).wrapInList(d).command(()=>Uc(r,d)).command(()=>Kc(r,d)).run()},D2=(n,t={},e={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:o=!1}=e,s=pn(n,r.schema);return Zs(r,s,t)?i.unsetMark(s,{extendEmptyMarkRange:o}):i.setMark(s,t)},$2=(n,t,e={})=>({state:r,commands:i})=>{const o=lt(n,r.schema),s=lt(t,r.schema);return Qr(r,o,e)?i.setNode(s):i.setNode(o,e)},N2=(n,t={})=>({state:e,commands:r})=>{const i=lt(n,e.schema);return Qr(e,i,t)?r.lift(i):r.wrapIn(i,t)},I2=()=>({state:n,dispatch:t})=>{const e=n.plugins;for(let r=0;r<e.length;r+=1){const i=e[r];let o;if(i.spec.isInputRules&&(o=i.getState(n))){if(t){const s=n.tr,a=o.transform;for(let l=a.steps.length-1;l>=0;l-=1)s.step(a.steps[l].invert(a.docs[l]));if(o.text){const l=s.doc.resolve(o.from).marks();s.replaceWith(o.from,o.to,n.schema.text(o.text,l))}else s.delete(o.from,o.to)}return!0}}return!1},P2=()=>({tr:n,dispatch:t})=>{const{selection:e}=n,{empty:r,ranges:i}=e;return r||t&&i.forEach(o=>{n.removeMark(o.$from.pos,o.$to.pos)}),!0},R2=(n,t={})=>({tr:e,state:r,dispatch:i})=>{var o;const{extendEmptyMarkRange:s=!1}=t,{selection:a}=e,l=pn(n,r.schema),{$from:c,empty:d,ranges:h}=a;if(!i)return!0;if(d&&s){let{from:u,to:p}=a;const f=(o=c.marks().find(g=>g.type===l))===null||o===void 0?void 0:o.attrs,m=za(c,l,f);m&&(u=m.from,p=m.to),e.removeMark(u,p,l)}else h.forEach(u=>{e.removeMark(u.$from.pos,u.$to.pos,l)});return e.removeStoredMark(l),!0},L2=(n,t={})=>({tr:e,state:r,dispatch:i})=>{let o=null,s=null;const a=Eo(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(o=lt(n,r.schema)),a==="mark"&&(s=pn(n,r.schema)),i&&e.selection.ranges.forEach(l=>{const c=l.$from.pos,d=l.$to.pos;r.doc.nodesBetween(c,d,(h,u)=>{o&&o===h.type&&e.setNodeMarkup(u,void 0,{...h.attrs,...t}),s&&h.marks.length&&h.marks.forEach(p=>{if(s===p.type){const f=Math.max(u,c),m=Math.min(u+h.nodeSize,d);e.addMark(f,m,s.create({...p.attrs,...t}))}})})}),!0):!1},z2=(n,t={})=>({state:e,dispatch:r})=>{const i=lt(n,e.schema);return oE(i,t)(e,r)},B2=(n,t={})=>({state:e,dispatch:r})=>{const i=lt(n,e.schema);return sE(i,t)(e,r)};var F2=Object.freeze({__proto__:null,blur:TE,clearContent:AE,clearNodes:_E,command:DE,createParagraphNear:$E,deleteCurrentNode:NE,deleteNode:IE,deleteRange:PE,deleteSelection:RE,enter:LE,exitCode:zE,extendMarkRange:FE,first:jE,focus:VE,forEach:HE,insertContent:WE,insertContentAt:KE,joinUp:GE,joinDown:JE,joinBackward:YE,joinForward:XE,keyboardShortcut:QE,lift:t2,liftEmptyBlock:e2,liftListItem:n2,newlineInCode:r2,resetAttributes:i2,scrollIntoView:o2,selectAll:s2,selectNodeBackward:a2,selectNodeForward:l2,selectParentNode:c2,selectTextblockEnd:d2,selectTextblockStart:h2,setContent:u2,setMark:k2,setMeta:S2,setNode:C2,setNodeSelection:E2,setTextSelection:O2,sinkListItem:M2,splitBlock:T2,splitListItem:A2,toggleList:_2,toggleMark:D2,toggleNode:$2,toggleWrap:N2,undoInputRule:I2,unsetAllMarks:P2,unsetMark:R2,updateAttributes:L2,wrapIn:z2,wrapInList:B2});const j2=se.create({name:"commands",addCommands(){return{...F2}}}),V2=se.create({name:"editable",addProseMirrorPlugins(){return[new Me({key:new Bn("editable"),props:{editable:()=>this.editor.options.editable}})]}}),H2=se.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new Me({key:new Bn("focusEvents"),props:{handleDOMEvents:{focus:(t,e)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:e}).setMeta("addToHistory",!1);return t.dispatch(r),!1},blur:(t,e)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:e}).setMeta("addToHistory",!1);return t.dispatch(r),!1}}}})]}}),W2=se.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:d,$anchor:h}=l,{pos:u,parent:p}=h,f=L.atStart(c).from===u;return!d||!f||!p.type.isTextblock||p.textContent.length?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},o={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Ba()||Au()?o:i},addProseMirrorPlugins(){return[new Me({key:new Bn("clearDocument"),appendTransaction:(n,t,e)=>{if(!(n.some(f=>f.docChanged)&&!t.doc.eq(e.doc)))return;const{empty:i,from:o,to:s}=t.selection,a=L.atStart(t.doc).from,l=L.atEnd(t.doc).to,c=o===a&&s===l,d=e.doc.textBetween(0,e.doc.content.size," "," ").length===0;if(i||!c||!d)return;const h=e.tr,u=xo({state:e,transaction:h}),{commands:p}=new ko({editor:this.editor,state:u});if(p.clearNodes(),!!h.steps.length)return h}})]}}),q2=se.create({name:"tabindex",addProseMirrorPlugins(){return[new Me({key:new Bn("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var U2=Object.freeze({__proto__:null,ClipboardTextSerializer:ME,Commands:j2,Editable:V2,FocusEvents:H2,Keymap:W2,Tabindex:q2});const K2=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 1px !important;
  height: 1px !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function G2(n,t){const e=document.querySelector("style[data-tiptap-style]");if(e!==null)return e;const r=document.createElement("style");return t&&r.setAttribute("nonce",t),r.setAttribute("data-tiptap-style",""),r.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(r),r}class J2 extends pE{constructor(t={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=G2(K2,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t){this.setOptions({editable:t}),this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,e){const r=Su(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],i=this.state.reconfigure({plugins:r});this.view.updateState(i)}unregisterPlugin(t){if(this.isDestroyed)return;const e=typeof t=="string"?`${t}$`:t.key,r=this.state.reconfigure({plugins:this.state.plugins.filter(i=>!i.key.startsWith(e))});this.view.updateState(r)}createExtensionManager(){const e=[...this.options.enableCoreExtensions?Object.values(U2):[],...this.options.extensions].filter(r=>["extension","node","mark"].includes(r==null?void 0:r.type));this.extensionManager=new Un(e,this)}createCommandManager(){this.commandManager=new ko({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const t=_u(this.options.content,this.schema,this.options.parseOptions),e=Tu(t,this.options.autofocus);this.view=new _C(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:qn.create({doc:t,selection:e||void 0})});const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews();const i=this.view.dom;i.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(s=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(s)});return}const e=this.state.apply(t),r=!this.state.selection.eq(e.selection);this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t}),r&&this.emit("selectionUpdate",{editor:this,transaction:t});const i=t.getMeta("focus"),o=t.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:t}),o&&this.emit("blur",{editor:this,event:o.event,transaction:t}),!(!t.docChanged||t.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return y2(this.state,t)}isActive(t,e){const r=typeof t=="string"?t:null,i=typeof t=="string"?e:t;return v2(this.state,r,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return m2(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e=`

`,textSerializers:r={}}=t||{};return g2(this.state.doc,{blockSeparator:e,textSerializers:{...r,...Ou(this.schema)}})}get isEmpty(){return w2(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var t;return!(!((t=this.view)===null||t===void 0)&&t.docView)}}function Qi(n){return new Cu({find:n.find,handler:({state:t,range:e,match:r})=>{const i=P(n.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:o}=t,s=r[r.length-1],a=r[0];let l=e.to;if(s){const c=a.search(/\S/),d=e.from+a.indexOf(s),h=d+s.length;if(Du(e.from,e.to,t.doc).filter(p=>p.mark.type.excluded.find(m=>m===n.type&&m!==p.mark.type)).filter(p=>p.to>d).length)return null;h<e.to&&o.delete(h,e.to),d>e.from&&o.delete(e.from+c,d),l=e.from+c+s.length,o.addMark(e.from+c,l,n.type.create(i||{})),o.removeStoredMark(n.type)}}})}function Qs(n){return new Cu({find:n.find,handler:({state:t,range:e,match:r})=>{const i=P(n.getAttributes,void 0,r)||{},o=t.tr.delete(e.from,e.to),a=o.doc.resolve(e.from).blockRange(),l=a&&Oa(a,n.type,i);if(!l)return null;o.wrap(a,l);const c=o.doc.resolve(e.from-1).nodeBefore;c&&c.type===n.type&&hn(o.doc,e.from-1)&&(!n.joinPredicate||n.joinPredicate(r,c))&&o.join(e.from-1)}})}class on{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=P(O(this,"addOptions",{name:this.name}))),this.storage=P(O(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new on(t)}configure(t={}){const e=this.extend();return e.options=Co(this.options,t),e.storage=P(O(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new on(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=P(O(e,"addOptions",{name:e.name})),e.storage=P(O(e,"addStorage",{name:e.name,options:e.options})),e}static handleExit({editor:t,mark:e}){const{tr:r}=t.state,i=t.state.selection.$from;if(i.pos===i.end()){const s=i.marks();if(!!!s.find(c=>(c==null?void 0:c.type.name)===e.name))return!1;const l=s.find(c=>(c==null?void 0:c.type.name)===e.name);return l&&r.removeStoredMark(l),r.insertText(" ",i.pos),t.view.dispatch(r),!0}return!1}}let Fn=class ta{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=P(O(this,"addOptions",{name:this.name}))),this.storage=P(O(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new ta(t)}configure(t={}){const e=this.extend();return e.options=Co(this.options,t),e.storage=P(O(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new ta(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=P(O(e,"addOptions",{name:e.name})),e.storage=P(O(e,"addStorage",{name:e.name,options:e.options})),e}};function to(n){return new xE({find:n.find,handler:({state:t,range:e,match:r})=>{const i=P(n.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:o}=t,s=r[r.length-1],a=r[0];let l=e.to;if(s){const c=a.search(/\S/),d=e.from+a.indexOf(s),h=d+s.length;if(Du(e.from,e.to,t.doc).filter(p=>p.mark.type.excluded.find(m=>m===n.type&&m!==p.mark.type)).filter(p=>p.to>d).length)return null;h<e.to&&o.delete(h,e.to),d>e.from&&o.delete(e.from+c,d),l=e.from+c+s.length,o.addMark(e.from+c,l,n.type.create(i||{})),o.removeStoredMark(n.type)}}})}const Y2=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,X2=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,Z2=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,Q2=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,tO=on.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return["strong",oe(this.options.HTMLAttributes,n),0]},addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Qi({find:Y2,type:this.type}),Qi({find:Z2,type:this.type})]},addPasteRules(){return[to({find:X2,type:this.type}),to({find:Q2,type:this.type})]}}),eO=Fn.create({name:"listItem",addOptions(){return{HTMLAttributes:{}}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",oe(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Gc=on.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:n=>n.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["span",oe(this.options.HTMLAttributes,n),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:n,commands:t})=>{const e=ja(n,this.type);return Object.entries(e).some(([,i])=>!!i)?!0:t.unsetMark(this.name)}}}}),Jc=/^\s*([-+*])\s$/,nO=Fn.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",oe(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleBulletList:()=>({commands:n,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(eO.name,this.editor.getAttributes(Gc.name)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=Qs({find:Jc,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=Qs({find:Jc,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Gc.name),editor:this.editor})),[n]}}),rO=Fn.create({name:"doc",topNode:!0,content:"block+"});var eo=200,at=function(){};at.prototype.append=function(t){return t.length?(t=at.from(t),!this.length&&t||t.length<eo&&this.leafAppend(t)||this.length<eo&&t.leafPrepend(this)||this.appendInner(t)):this};at.prototype.prepend=function(t){return t.length?at.from(t).append(this):this};at.prototype.appendInner=function(t){return new iO(this,t)};at.prototype.slice=function(t,e){return t===void 0&&(t=0),e===void 0&&(e=this.length),t>=e?at.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,e))};at.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)};at.prototype.forEach=function(t,e,r){e===void 0&&(e=0),r===void 0&&(r=this.length),e<=r?this.forEachInner(t,e,r,0):this.forEachInvertedInner(t,e,r,0)};at.prototype.map=function(t,e,r){e===void 0&&(e=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(o,s){return i.push(t(o,s))},e,r),i};at.from=function(t){return t instanceof at?t:t&&t.length?new $u(t):at.empty};var $u=function(n){function t(r){n.call(this),this.values=r}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(i,o){return i==0&&o==this.length?this:new t(this.values.slice(i,o))},t.prototype.getInner=function(i){return this.values[i]},t.prototype.forEachInner=function(i,o,s,a){for(var l=o;l<s;l++)if(i(this.values[l],a+l)===!1)return!1},t.prototype.forEachInvertedInner=function(i,o,s,a){for(var l=o-1;l>=s;l--)if(i(this.values[l],a+l)===!1)return!1},t.prototype.leafAppend=function(i){if(this.length+i.length<=eo)return new t(this.values.concat(i.flatten()))},t.prototype.leafPrepend=function(i){if(this.length+i.length<=eo)return new t(i.flatten().concat(this.values))},e.length.get=function(){return this.values.length},e.depth.get=function(){return 0},Object.defineProperties(t.prototype,e),t}(at);at.empty=new $u([]);var iO=function(n){function t(e,r){n.call(this),this.left=e,this.right=r,this.length=e.length+r.length,this.depth=Math.max(e.depth,r.depth)+1}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},t.prototype.forEachInner=function(r,i,o,s){var a=this.left.length;if(i<a&&this.left.forEachInner(r,i,Math.min(o,a),s)===!1||o>a&&this.right.forEachInner(r,Math.max(i-a,0),Math.min(this.length,o)-a,s+a)===!1)return!1},t.prototype.forEachInvertedInner=function(r,i,o,s){var a=this.left.length;if(i>a&&this.right.forEachInvertedInner(r,i-a,Math.max(o,a)-a,s+a)===!1||o<a&&this.left.forEachInvertedInner(r,Math.min(i,a),o,s)===!1)return!1},t.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var o=this.left.length;return i<=o?this.left.slice(r,i):r>=o?this.right.slice(r-o,i-o):this.left.slice(r,o).append(this.right.slice(0,i-o))},t.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new t(this.left,i)},t.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new t(i,this.right)},t.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new t(this.left,new t(this.right,r)):new t(this,r)},t}(at);const oO=500;class te{constructor(t,e){this.items=t,this.eventCount=e}popEvent(t,e){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,o;e&&(i=this.remapping(r,this.items.length),o=i.maps.length);let s=t.tr,a,l,c=[],d=[];return this.items.forEach((h,u)=>{if(!h.step){i||(i=this.remapping(r,u+1),o=i.maps.length),o--,d.push(h);return}if(i){d.push(new me(h.map));let p=h.step.map(i.slice(o)),f;p&&s.maybeStep(p).doc&&(f=s.mapping.maps[s.mapping.maps.length-1],c.push(new me(f,void 0,void 0,c.length+d.length))),o--,f&&i.appendMap(f,o)}else s.maybeStep(h.step);if(h.selection)return a=i?h.selection.map(i.slice(o)):h.selection,l=new te(this.items.slice(0,r).append(d.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:s,selection:a}}addTransform(t,e,r,i){let o=[],s=this.eventCount,a=this.items,l=!i&&a.length?a.get(a.length-1):null;for(let d=0;d<t.steps.length;d++){let h=t.steps[d].invert(t.docs[d]),u=new me(t.mapping.maps[d],h,e),p;(p=l&&l.merge(u))&&(u=p,d?o.pop():a=a.slice(0,a.length-1)),o.push(u),e&&(s++,e=void 0),i||(l=u)}let c=s-r.depth;return c>aO&&(a=sO(a,c),s-=c),new te(a.append(o),s)}remapping(t,e){let r=new Jn;return this.items.forEach((i,o)=>{let s=i.mirrorOffset!=null&&o-i.mirrorOffset>=t?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,s)},t,e),r}addMaps(t){return this.eventCount==0?this:new te(this.items.append(t.map(e=>new me(e))),this.eventCount)}rebased(t,e){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-e),o=t.mapping,s=t.steps.length,a=this.eventCount;this.items.forEach(u=>{u.selection&&a--},i);let l=e;this.items.forEach(u=>{let p=o.getMirror(--l);if(p==null)return;s=Math.min(s,p);let f=o.maps[p];if(u.step){let m=t.steps[p].invert(t.docs[p]),g=u.selection&&u.selection.map(o.slice(l+1,p));g&&a++,r.push(new me(f,m,g))}else r.push(new me(f))},i);let c=[];for(let u=e;u<s;u++)c.push(new me(o.maps[u]));let d=this.items.slice(0,i).append(c).append(r),h=new te(d,a);return h.emptyItemCount()>oO&&(h=h.compress(this.items.length-r.length)),h}emptyItemCount(){let t=0;return this.items.forEach(e=>{e.step||t++}),t}compress(t=this.items.length){let e=this.remapping(0,t),r=e.maps.length,i=[],o=0;return this.items.forEach((s,a)=>{if(a>=t)i.push(s),s.selection&&o++;else if(s.step){let l=s.step.map(e.slice(r)),c=l&&l.getMap();if(r--,c&&e.appendMap(c,r),l){let d=s.selection&&s.selection.map(e.slice(r));d&&o++;let h=new me(c.invert(),l,d),u,p=i.length-1;(u=i.length&&i[p].merge(h))?i[p]=u:i.push(h)}}else s.map&&r--},this.items.length,0),new te(at.from(i.reverse()),o)}}te.empty=new te(at.empty,0);function sO(n,t){let e;return n.forEach((r,i)=>{if(r.selection&&t--==0)return e=i,!1}),n.slice(e)}class me{constructor(t,e,r,i){this.map=t,this.step=e,this.selection=r,this.mirrorOffset=i}merge(t){if(this.step&&t.step&&!t.selection){let e=t.step.merge(this.step);if(e)return new me(e.getMap().invert(),e,this.selection)}}}class He{constructor(t,e,r,i,o){this.done=t,this.undone=e,this.prevRanges=r,this.prevTime=i,this.prevComposition=o}}const aO=20;function lO(n,t,e,r){let i=e.getMeta(On),o;if(i)return i.historyState;e.getMeta(hO)&&(n=new He(n.done,n.undone,null,0,-1));let s=e.getMeta("appendedTransaction");if(e.steps.length==0)return n;if(s&&s.getMeta(On))return s.getMeta(On).redo?new He(n.done.addTransform(e,void 0,r,Ei(t)),n.undone,Yc(e.mapping.maps),n.prevTime,n.prevComposition):new He(n.done,n.undone.addTransform(e,void 0,r,Ei(t)),null,n.prevTime,n.prevComposition);if(e.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let a=e.getMeta("composition"),l=n.prevTime==0||!s&&n.prevComposition!=a&&(n.prevTime<(e.time||0)-r.newGroupDelay||!cO(e,n.prevRanges)),c=s?cs(n.prevRanges,e.mapping):Yc(e.mapping.maps);return new He(n.done.addTransform(e,l?t.selection.getBookmark():void 0,r,Ei(t)),te.empty,c,e.time,a??n.prevComposition)}else return(o=e.getMeta("rebased"))?new He(n.done.rebased(e,o),n.undone.rebased(e,o),cs(n.prevRanges,e.mapping),n.prevTime,n.prevComposition):new He(n.done.addMaps(e.mapping.maps),n.undone.addMaps(e.mapping.maps),cs(n.prevRanges,e.mapping),n.prevTime,n.prevComposition)}function cO(n,t){if(!t)return!1;if(!n.docChanged)return!0;let e=!1;return n.mapping.maps[0].forEach((r,i)=>{for(let o=0;o<t.length;o+=2)r<=t[o+1]&&i>=t[o]&&(e=!0)}),e}function Yc(n){let t=[];for(let e=n.length-1;e>=0&&t.length==0;e--)n[e].forEach((r,i,o,s)=>t.push(o,s));return t}function cs(n,t){if(!n)return null;let e=[];for(let r=0;r<n.length;r+=2){let i=t.map(n[r],1),o=t.map(n[r+1],-1);i<=o&&e.push(i,o)}return e}function dO(n,t,e){let r=Ei(t),i=On.get(t).spec.config,o=(e?n.undone:n.done).popEvent(t,r);if(!o)return null;let s=o.selection.resolve(o.transform.doc),a=(e?n.done:n.undone).addTransform(o.transform,t.selection.getBookmark(),i,r),l=new He(e?a:o.remaining,e?o.remaining:a,null,0,-1);return o.transform.setSelection(s).setMeta(On,{redo:e,historyState:l})}let ds=!1,Xc=null;function Ei(n){let t=n.plugins;if(Xc!=t){ds=!1,Xc=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){ds=!0;break}}return ds}const On=new Bn("history"),hO=new Bn("closeHistory");function uO(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new Me({key:On,state:{init(){return new He(te.empty,te.empty,null,0,-1)},apply(t,e,r){return lO(e,r,t,n)}},config:n,props:{handleDOMEvents:{beforeinput(t,e){let r=e.inputType,i=r=="historyUndo"?Iu:r=="historyRedo"?Pu:null;return i?(e.preventDefault(),i(t.state,t.dispatch)):!1}}}})}function Nu(n,t){return(e,r)=>{let i=On.getState(e);if(!i||(n?i.undone:i.done).eventCount==0)return!1;if(r){let o=dO(i,e,n);o&&r(t?o.scrollIntoView():o)}return!0}}const Iu=Nu(!1,!0),Pu=Nu(!0,!0),pO=se.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:t})=>Iu(n,t),redo:()=>({state:n,dispatch:t})=>Pu(n,t)}},addProseMirrorPlugins(){return[uO(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-ั":()=>this.editor.commands.undo(),"Shift-Mod-ั":()=>this.editor.commands.redo()}}}),fO=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,mO=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,gO=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,bO=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,yO=on.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",oe(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Qi({find:fO,type:this.type}),Qi({find:gO,type:this.type})]},addPasteRules(){return[to({find:mO,type:this.type}),to({find:bO,type:this.type})]}}),vO=Fn.create({name:"listItem",addOptions(){return{HTMLAttributes:{}}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",oe(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),wO=/^(\d+)\.\s$/,xO=Fn.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:t,...e}=n;return t===1?["ol",oe(this.options.HTMLAttributes,e),0]:["ol",oe(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleOrderedList:()=>({commands:n})=>n.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){return[Qs({find:wO,type:this.type,getAttributes:n=>({start:+n[1]}),joinPredicate:(n,t)=>t.childCount+t.attrs.start===+n[1]})]}}),kO=Fn.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",oe(this.options.HTMLAttributes,n),0]},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),SO=se.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something โฆ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new Me({props:{decorations:({doc:n,selection:t})=>{const e=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=t,i=[];if(!e)return null;const o=n.type.createAndFill(),s=(o==null?void 0:o.sameMarkup(n))&&o.content.findDiffStart(n.content)===null;return n.descendants((a,l)=>{const c=r>=l&&r<=l+a.nodeSize,d=!a.isLeaf&&!a.childCount;if((c||!this.options.showOnlyCurrent)&&d){const h=[this.options.emptyNodeClass];s&&h.push(this.options.emptyEditorClass);const u=qt.node(l,l+a.nodeSize,{class:h.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:a,pos:l,hasAnchor:c}):this.options.placeholder});i.push(u)}return this.options.includeChildren}),rt.create(n,i)}}})]}}),CO=Fn.create({name:"text",group:"inline"}),EO=on.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["u",oe(this.options.HTMLAttributes,n),0]},addCommands(){return{setUnderline:()=>({commands:n})=>n.setMark(this.name),toggleUnderline:()=>({commands:n})=>n.toggleMark(this.name),unsetUnderline:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});var OO=Object.defineProperty,MO=Object.getOwnPropertyDescriptor,Oo=(n,t,e,r)=>{for(var i=r>1?void 0:r?MO(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&OO(t,e,i),i};let ti=class extends G{constructor(){super(...arguments),this.richTextContainer=this.querySelector("drb-rich-text-content"),this.editor=null,this.form=this.closest("form"),this.name="",this.placeholder="",this.disabledActions=""}get value(){var n;return((n=this.editor)==null?void 0:n.getHTML())||""}set value(n){this.editor&&this.editor.commands.setContent(n,!0)}get textValue(){var n;return((n=this.richTextContainer)==null?void 0:n.textContent)||""}connectedCallback(){if(super.connectedCallback(),!this.richTextContainer)return;const n=this.richTextContainer.innerHTML;this.richTextContainer.innerHTML="";const t=[rO,kO,pO,CO];Object.entries({bold:tO,italic:yO,underline:EO,lists:[nO,vO,xO]}).forEach(([r,i])=>{this.disabledActions.includes(r)||t.push(...Array.isArray(i)?i:[i])}),this.editor=new J2({element:this.richTextContainer,extensions:[...t,SO.configure({placeholder:this.placeholder})],content:n}),this.bindEvents()}bindEvents(){var t,e;let n=!1;(t=this.editor)==null||t.on("update",()=>{n=!0,this.dispatchEvent(new CustomEvent("input",{bubbles:!0,composed:!0}))}),(e=this.editor)==null||e.on("blur",()=>{sn(()=>{!n||this.contains(document.activeElement)||(n=!1,this.dispatchEvent(new CustomEvent("change",{bubbles:!0,composed:!0})))})}),this.form&&this.name&&this.form.addEventListener("formdata",({formData:r})=>{r.append(this.name,this.value)}),this.richTextContainer.addEventListener("click",()=>{var r,i;(r=this.editor)!=null&&r.isFocused||(i=this.editor)==null||i.commands.focus()})}render(){return z`
      <slot></slot>
    `}};Oo([b()],ti.prototype,"name",2);Oo([b()],ti.prototype,"placeholder",2);Oo([b({attribute:"disabled-actions",converter:{fromAttribute:n=>n.split("|"),toAttribute:n=>n.join("|")}})],ti.prototype,"disabledActions",2);ti=Oo([J("drb-rich-text")],ti);const TO=`.rich-text-actions__action{display:inline-flex;align-items:center;justify-content:center;height:29px;height:var(--rich-text-action-height, 29px);margin:0;padding:0 4px;transition:background-color .15s ease;border:none;border-radius:4px;background-color:transparent;color:#060318;color:var(--rich-text-action-color, #060318);cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none}.rich-text-actions__action:hover{background-color:#ecebf0}[active].rich-text-actions__action{background-color:#d8d6d5}.rich-text-actions__action svg{width:20px!important;width:var(--rich-text-action-icon-size, 20px)!important;height:20px!important;height:var(--rich-text-action-icon-size, 20px)!important;color:inherit!important}.rich-text-actions__divider{display:inline-block;width:1px;height:29px;background-color:#beb9ca}.rich-text-actions{display:contents}
`,AO=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
  <path
    d="M6 12H14C16.2091 12 18 10.2091 18 8C18 5.79086 16.2091 4 14 4H6V12ZM6 12H15C17.2091 12 19 13.7909 19 16C19 18.2091 17.2091 20 15 20H6V12Z"
    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
</svg>`,_O=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
  <path d="M19 4H10M14 20H5M15 4L9 20" stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round" />
</svg>`,DO=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
  <path d="M18 4V11C18 14.3137 15.3137 17 12 17C8.68629 17 6 14.3137 6 11V4M4 21H20" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
</svg>`,$O=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
  <path
    d="M21 5L10 5M21 19L10 19M21 12L10 12M6 5C6 5.82843 5.32843 6.5 4.5 6.5C3.67157 6.5 3 5.82843 3 5C3 4.17157 3.67157 3.5 4.5 3.5C5.32843 3.5 6 4.17157 6 5ZM6 19C6 19.8284 5.32843 20.5 4.5 20.5C3.67157 20.5 3 19.8284 3 19C3 18.1716 3.67157 17.5 4.5 17.5C5.32843 17.5 6 18.1716 6 19ZM6 12C6 12.8284 5.32843 13.5 4.5 13.5C3.67157 13.5 3 12.8284 3 12C3 11.1716 3.67157 10.5 4.5 10.5C5.32843 10.5 6 11.1716 6 12Z"
    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
</svg>`,NO=`<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M17.5 4.16602L8.33337 4.16602M17.5 15.8327L8.33337 15.8327M17.5 9.99935L8.33337 9.99935"
    stroke="currentColor" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round" />
  <path
    d="M1.9017 12V11.429L3.41662 9.94389C3.5615 9.79759 3.68224 9.66761 3.77883 9.55398C3.87542 9.44034 3.94786 9.33026 3.99616 9.22372C4.04446 9.11719 4.0686 9.00355 4.0686 8.88281C4.0686 8.74503 4.03735 8.62713 3.97485 8.52912C3.91235 8.42969 3.82642 8.35298 3.71704 8.29901C3.60767 8.24503 3.48338 8.21804 3.34417 8.21804C3.20071 8.21804 3.075 8.24787 2.96704 8.30753C2.85909 8.36577 2.77528 8.44886 2.71562 8.55682C2.65738 8.66477 2.62826 8.79332 2.62826 8.94247H1.87613C1.87613 8.66548 1.93934 8.42472 2.06576 8.22017C2.19218 8.01562 2.36619 7.85724 2.58778 7.74503C2.81079 7.63281 3.06647 7.5767 3.35483 7.5767C3.64744 7.5767 3.90454 7.63139 4.12613 7.74077C4.34772 7.85014 4.5196 8 4.64176 8.19034C4.76534 8.38068 4.82713 8.59801 4.82713 8.84233C4.82713 9.00568 4.79588 9.16619 4.73338 9.32386C4.67088 9.48153 4.56079 9.65625 4.40312 9.84801C4.24687 10.0398 4.02741 10.272 3.74474 10.5447L2.99261 11.3097V11.3395H4.89318V12H1.9017Z"
    fill="currentColor" />
  <path
    d="M3.46775 18.0597C3.16093 18.0597 2.88821 18.0071 2.64957 17.902C2.41235 17.7969 2.22485 17.6506 2.08707 17.4631C1.94929 17.2756 1.87613 17.0589 1.86761 16.8132H2.66875C2.67585 16.9311 2.71491 17.0341 2.78593 17.1222C2.85696 17.2088 2.95142 17.2763 3.06931 17.3246C3.18721 17.3729 3.31931 17.397 3.46562 17.397C3.62187 17.397 3.76036 17.37 3.8811 17.3161C4.00184 17.2607 4.0963 17.1839 4.16448 17.0859C4.23267 16.9879 4.26605 16.875 4.26463 16.7472C4.26605 16.6151 4.23196 16.4986 4.16235 16.3977C4.09275 16.2969 3.9919 16.218 3.8598 16.1612C3.72911 16.1044 3.57144 16.076 3.38679 16.076H3.00113V15.4666H3.38679C3.53877 15.4666 3.67159 15.4403 3.78522 15.3878C3.90028 15.3352 3.99048 15.2614 4.05582 15.1662C4.12116 15.0696 4.15312 14.9581 4.1517 14.8317C4.15312 14.7081 4.12542 14.6009 4.0686 14.5099C4.01321 14.4176 3.93437 14.3459 3.8321 14.2947C3.73125 14.2436 3.61264 14.218 3.47627 14.218C3.34275 14.218 3.21917 14.2422 3.10554 14.2905C2.9919 14.3388 2.90028 14.4077 2.83068 14.4972C2.76108 14.5852 2.72414 14.6903 2.71988 14.8125H1.95923C1.96491 14.5682 2.03522 14.3537 2.17017 14.169C2.30653 13.983 2.48835 13.8381 2.71562 13.7344C2.94289 13.6293 3.19786 13.5767 3.48054 13.5767C3.77173 13.5767 4.02457 13.6314 4.23906 13.7408C4.45497 13.8487 4.62187 13.9943 4.73977 14.1776C4.85767 14.3608 4.91662 14.5632 4.91662 14.7848C4.91804 15.0305 4.84559 15.2365 4.69929 15.4027C4.5544 15.5689 4.36406 15.6776 4.12826 15.7287V15.7628C4.43508 15.8054 4.67017 15.919 4.83352 16.1037C4.99829 16.2869 5.07997 16.5149 5.07855 16.7876C5.07855 17.032 5.00894 17.2507 4.86974 17.4439C4.73196 17.6357 4.54162 17.7862 4.29872 17.8956C4.05724 18.005 3.78025 18.0597 3.46775 18.0597Z"
    fill="currentColor" />
  <path d="M3.67656 1.63636V6H2.88608V2.40554H2.86051L1.83991 3.05753V2.3331L2.92443 1.63636H3.67656Z"
    fill="currentColor" />
</svg>`;var IO=Object.defineProperty,PO=Object.getOwnPropertyDescriptor,RO=(n,t,e,r)=>{for(var i=r>1?void 0:r?PO(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&IO(t,e,i),i};let ea=class extends G{constructor(){var n,t,e,r,i,o;super(...arguments),this.drbRichText=this.closest("drb-rich-text"),this.editor=(n=this.drbRichText)==null?void 0:n.editor,this.defaultActionGroups=[[{title:"Bold",icon:AO,action:()=>{var s;return(s=this.editor)==null?void 0:s.chain().focus().toggleBold().run()},isActive:()=>{var s;return(s=this.editor)==null?void 0:s.isActive("bold")},enabled:!!((t=this.editor)!=null&&t.can().toggleBold)},{title:"Italic",icon:_O,action:()=>{var s;return(s=this.editor)==null?void 0:s.chain().focus().toggleItalic().run()},isActive:()=>{var s;return(s=this.editor)==null?void 0:s.isActive("italic")},enabled:!!((e=this.editor)!=null&&e.can().toggleItalic)},{title:"Underline",icon:DO,action:()=>{var s;return(s=this.editor)==null?void 0:s.chain().focus().toggleUnderline().run()},isActive:()=>{var s;return(s=this.editor)==null?void 0:s.isActive("underline")},enabled:!!((r=this.editor)!=null&&r.can().toggleUnderline)}],[{icon:$O,title:"Unordered List",action:()=>{var s;return(s=this.editor)==null?void 0:s.chain().focus().toggleBulletList().run()},isActive:()=>{var s;return(s=this.editor)==null?void 0:s.isActive("bulletList")},enabled:!!((i=this.editor)!=null&&i.can().toggleBulletList)},{icon:NO,title:"Ordered List",action:()=>{var s;return(s=this.editor)==null?void 0:s.chain().focus().toggleOrderedList().run()},isActive:()=>{var s;return(s=this.editor)==null?void 0:s.isActive("orderedList")},enabled:!!((o=this.editor)!=null&&o.can().toggleOrderedList)}]]}connectedCallback(){var n;super.connectedCallback(),(n=this.editor)==null||n.on("transaction",()=>{this.requestUpdate()})}getEnabledActionGroups(){return this.defaultActionGroups.map(n=>n.filter(t=>t.enabled)).filter(n=>n.length>0)}render(){return z`
      <div class="rich-text-actions">
        ${this.getEnabledActionGroups().map((n,t)=>z`
          ${t>0?z`<div class="rich-text-actions__divider"></div>`:""}

          ${n.map(e=>z`
            <button
              class="rich-text-actions__action"
              @click=${e.action}
              title=${e.title}
              ?active=${e.isActive()}
            >
              ${xt(e.icon)}
            </button>
          `)}
        `)}

        <slot name="custom-actions"></slot>
      </div>
    `}};ea.styles=Z(TO);ea=RO([J("drb-rich-text-actions")],ea);const LO=`.thumbnail{display:contents}.thumbnail__hover-media{visibility:hidden;position:absolute;z-index:1;top:0;left:0;width:100%;height:100%;opacity:0;background-color:transparent;pointer-events:none;-o-object-fit:cover;object-fit:cover}.thumbnail--show-hover-media .thumbnail__hover-media{visibility:visible;opacity:1}
`;var zO=Object.defineProperty,BO=Object.getOwnPropertyDescriptor,Te=(n,t,e,r)=>{for(var i=r>1?void 0:r?BO(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&zO(t,e,i),i};let Jt=class extends G{constructor(){super(...arguments),this.isTouchDevice=matchMedia("(hover: none)").matches,this.disableHoverMedia=!1,this.hoverMediaInitialized=!1,this.showHoverMedia=!1,this.targetHoverMediaSrc=""}connectedCallback(){super.connectedCallback(),!this.disableHoverMedia&&!this.isTouchDevice&&(this.addEventListener("mouseenter",()=>{this.playHoverMedia()}),this.addEventListener("mouseleave",()=>{this.pauseHoverMedia()}))}playHoverMedia(){var n,t;if(!(!this.hoverMediaType||!this.hoverMediaSrc||this.showHoverMedia)){if(!this.hoverMediaInitialized){const e=this.clientWidth;this.targetHoverMediaSrc=e>400&&this.hoverMediaSrcLarge?this.hoverMediaSrcLarge:this.hoverMediaSrc}this.hoverMediaInitialized=!0,this.hoverVideoEl&&(this.hoverVideoEl.currentTime=0,(n=this.hoverVideoEl)==null||n.play()),(t=this.hoverImageEl)==null||t.setAttribute("src",this.targetHoverMediaSrc),sn(()=>{this.showHoverMedia=!0})}}pauseHoverMedia(){var n;this.showHoverMedia=!1,(n=this.hoverVideoEl)==null||n.pause()}getHoverMediaHtml(){return this.hoverMediaInitialized?this.hoverMediaType==="video"?z`
        <video
          class="thumbnail__hover-media"
          src="${this.targetHoverMediaSrc}"
          autoplay
          muted
          loop
          playsinline
        ></video>
      `:z`
      <img
        class="thumbnail__hover-media"
        src="${this.targetHoverMediaSrc}"
      />
    `:z``}render(){return z`
      <div
        class="${kt({thumbnail:!0,"thumbnail--show-hover-media":this.showHoverMedia})}"
      >
        ${this.getHoverMediaHtml()}
        <slot></slot>
      </div>
    `}};Jt.styles=Z(LO);Te([ct("video")],Jt.prototype,"hoverVideoEl",2);Te([ct("img")],Jt.prototype,"hoverImageEl",2);Te([b({attribute:"hover-media-type",type:String})],Jt.prototype,"hoverMediaType",2);Te([b({attribute:"hover-media-src",type:String})],Jt.prototype,"hoverMediaSrc",2);Te([b({attribute:"hover-media-src-large",type:String})],Jt.prototype,"hoverMediaSrcLarge",2);Te([b({attribute:"disable-hover-media",type:Boolean})],Jt.prototype,"disableHoverMedia",2);Te([F()],Jt.prototype,"hoverMediaInitialized",2);Te([F()],Jt.prototype,"showHoverMedia",2);Te([F()],Jt.prototype,"targetHoverMediaSrc",2);Jt=Te([J("drb-thumbnail")],Jt);const FO=`<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M6.25 19.5V4.5M17.75 19.5V4.5" stroke="currentColor" stroke-width="5" stroke-linecap="round"
    stroke-linejoin="round" />
</svg>`,jO=`<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path
    d="M18.6795 13.4L7.77348 20.3964C6.42547 21.2626 4.5 20.4384 4.5 18.9964V5.00358C4.5 3.5616 6.42547 2.73736 7.77348 3.6036L18.6795 10.6C18.9311 10.7504 19.1381 10.9575 19.2815 11.2021C19.4248 11.4468 19.5 11.7211 19.5 12C19.5 12.2789 19.4248 12.5532 19.2815 12.7979C19.1381 13.0425 18.9311 13.2496 18.6795 13.4Z"
    fill="currentColor" />
</svg>`,VO=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
  <path fill-rule="evenodd" clip-rule="evenodd"
    d="M3 6C1.346 6 0 7.346 0 9V15C0 16.654 1.346 18 3 18H5.649L12 23V1L5.649 6H3ZM20 12C20 9.884 19.194 7.864 17.729 6.314C17.349 5.912 16.716 5.894 16.315 6.273C15.913 6.652 15.895 7.285 16.274 7.687C17.386 8.864 17.999 10.396 17.999 11.999C17.999 13.603 17.386 15.135 16.273 16.313C15.894 16.714 15.911 17.347 16.313 17.727C16.506 17.91 16.753 18 17 18C17.265 18 17.53 17.895 17.727 17.687C19.193 16.138 20 14.118 20 12ZM17.202 1.4C17.533 0.958 18.162 0.869 18.602 1.201C22.033 3.778 24 7.714 24 12C24 16.286 22.033 20.222 18.602 22.8C18.422 22.936 18.211 23.001 18.002 23.001C17.699 23.001 17.398 22.864 17.202 22.602C16.87 22.16 16.959 21.534 17.401 21.202C20.324 19.005 22 15.652 22 12.001C22 8.35 20.324 4.997 17.401 2.8C16.959 2.468 16.87 1.841 17.202 1.4Z"
    fill="currentColor" />
</svg>`,HO=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
  <path
    d="M21.414 12L23.707 9.707C23.8892 9.5184 23.99 9.2658 23.9877 9.0036C23.9854 8.7414 23.8802 8.49059 23.6948 8.30518C23.5094 8.11977 23.2586 8.0146 22.9964 8.01233C22.7342 8.01005 22.4816 8.11084 22.293 8.293L20 10.586L17.707 8.293C17.5184 8.11084 17.2658 8.01005 17.0036 8.01233C16.7414 8.0146 16.4906 8.11977 16.3052 8.30518C16.1198 8.49059 16.0146 8.7414 16.0123 9.0036C16.01 9.2658 16.1108 9.5184 16.293 9.707L18.586 12L16.293 14.293C16.1975 14.3852 16.1213 14.4956 16.0689 14.6176C16.0165 14.7396 15.9889 14.8708 15.9877 15.0036C15.9866 15.1364 16.0119 15.2681 16.0622 15.391C16.1125 15.5139 16.1867 15.6255 16.2806 15.7194C16.3745 15.8133 16.4862 15.8875 16.609 15.9378C16.7319 15.9881 16.8636 16.0134 16.9964 16.0123C17.1292 16.0111 17.2604 15.9835 17.3824 15.9311C17.5044 15.8787 17.6148 15.8025 17.707 15.707L20 13.414L22.293 15.707C22.4816 15.8892 22.7342 15.99 22.9964 15.9877C23.2586 15.9854 23.5094 15.8802 23.6948 15.6948C23.8802 15.5094 23.9854 15.2586 23.9877 14.9964C23.99 14.7342 23.8892 14.4816 23.707 14.293L21.414 12ZM3 6C2.20435 6 1.44129 6.31607 0.87868 6.87868C0.31607 7.44129 0 8.20435 0 9L0 15C0 15.7956 0.31607 16.5587 0.87868 17.1213C1.44129 17.6839 2.20435 18 3 18H5.649L12 23V1L5.649 6H3Z"
    fill="currentColor" />
</svg>`,WO=`.video{display:contents}.video:hover,.video:has(:focus-visible){--controls-opacity: 1;--controls-translate-y: 0}.controls{display:flex;position:absolute;z-index:1;right:0;bottom:0;left:0;align-items:center;padding:20px 24px;transform:translateY(8px);transform:translateY(var(--controls-translate-y, 8px));transition:all .25s cubic-bezier(.34,1.56,.64,1);opacity:0;opacity:var(--controls-opacity, 0);background:linear-gradient(0deg,rgba(58,53,70,.21),transparent);grid-gap:14px;gap:14px}.controls button{--btn-height: 60px;--btn-icon-size: 24px;--btn-bg-color-hover: #fff;--btn-text-color-hover: #ea4c89;transition:none}.controls button:active{transform:scale(.95)}.controls button[hidden]{display:none}.play-btn{--btn-bg-color-hover: #fff;--btn-text-color-hover: #ea4c89}.play-btn svg{margin-left:2px}.progress-bar{display:flex;flex:1 1;align-items:center;height:40px;cursor:pointer}.progress-bar:hover{--progress-color: #f96fa4}.progress-bar__container{position:relative;width:100%;height:6px;height:var(--progress-height, 6px);overflow:hidden;border:2px solid #fff;border-radius:9999999px;background-color:#fff}.progress-bar__fill{position:absolute;width:100%;height:100%;transform:translate(-100%);transform:translate(calc(-1 * (100% - var(--progress-percent, 0%))));background-color:#ea4c89;background-color:var(--progress-color, #ea4c89)}
`;var qO=Object.defineProperty,UO=Object.getOwnPropertyDescriptor,de=(n,t,e,r)=>{for(var i=r>1?void 0:r?UO(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&qO(t,e,i),i};let Bt=class extends G{constructor(){super(...arguments),this.progressBarRef=Re(),this.wasPaused=!1,this.videoHasLoaded=!1,this.hidePlayPause=!1,this.hideVolume=!1,this.togglePlayOnClick=!1,this.isPlaying=!1,this.isMuted=!0,this.isDragging=!1,this.duration=0,this.progressPercent=0,this.hasAudio=!1,this.checkIfVideoHasLoaded=()=>{if(this.videoHasLoaded)return!0;(this.videoEl.readyState>=2||this.videoEl.currentTime>0)&&(this.videoHasLoaded=!0,this.checkForAudio(),this.dispatchEvent(new Event("video-loaded",{bubbles:!0,composed:!0})))},this.handleProgressDragMove=n=>{this.isDragging&&(n.preventDefault(),this.updateVideoTimeFromEvent(n))},this.handleProgressDragEnd=n=>{this.isDragging&&(this.updateVideoTimeFromEvent(n),this.stopDragging())},this.renderProgressAnimationFrame=()=>{this.duration&&(this.progressPercent=Math.min(this.videoEl.currentTime/this.duration,1),this.isPlaying&&(this.progressAnimationId=requestAnimationFrame(this.renderProgressAnimationFrame)))}}connectedCallback(){if(super.connectedCallback(),this.videoEl=this.querySelector("video"),!this.videoEl)return;this.videoEl.poster||console.warn("drb-video: No poster image set on video element"),this.videoEl.addEventListener("play",this.syncPlayState.bind(this)),this.videoEl.addEventListener("pause",this.syncPlayState.bind(this)),this.videoEl.addEventListener("volumechange",this.syncMutedState.bind(this)),this.videoEl.addEventListener("loadedmetadata",this.handleMetadataLoaded.bind(this)),this.videoEl.addEventListener("loadeddata",this.checkIfVideoHasLoaded.bind(this)),this.videoEl.addEventListener("timeupdate",this.handleTimeUpdate.bind(this)),!matchMedia("(hover: none)").matches&&this.togglePlayOnClick&&this.videoEl.addEventListener("click",this.togglePlayPause.bind(this)),this.videoEl.removeAttribute("controls"),this.syncPlayState(),this.syncMutedState(),this.syncDuration(),this.checkForAudio(),this.checkIfVideoHasLoaded()}disconnectedCallback(){super.disconnectedCallback(),this.removeDragListeners()}checkForAudio(){var n;this.hasAudio=this.videoEl.mozHasAudio||!!this.videoEl.webkitAudioDecodedByteCount||!!((n=this.videoEl.audioTracks)!=null&&n.length)}syncDuration(){this.duration=this.videoEl.duration||0}syncPlayState(){this.isPlaying!==!this.videoEl.paused&&(this.isPlaying=!this.videoEl.paused,this.updateProgress())}syncMutedState(){this.isMuted=this.videoEl.muted}handleTimeUpdate(){this.checkIfVideoHasLoaded(),this.updateProgress()}handleMetadataLoaded(){this.syncDuration(),this.checkIfVideoHasLoaded()}handleProgressDragStart(n){n.preventDefault(),this.startDragging(),this.updateVideoTimeFromEvent(n),n instanceof TouchEvent?(document.addEventListener("touchmove",this.handleProgressDragMove,{passive:!1}),document.addEventListener("touchend",this.handleProgressDragEnd),document.addEventListener("touchcancel",this.handleProgressDragEnd)):(document.addEventListener("mousemove",this.handleProgressDragMove),document.addEventListener("mouseup",this.handleProgressDragEnd))}startDragging(){this.isDragging=!0,this.wasPaused=this.videoEl.paused,this.wasPaused||this.videoEl.pause()}stopDragging(){this.isDragging&&(this.isDragging=!1,this.removeDragListeners(),this.wasPaused||this.videoEl.play())}removeDragListeners(){document.removeEventListener("mousemove",this.handleProgressDragMove),document.removeEventListener("mouseup",this.handleProgressDragEnd),document.removeEventListener("touchmove",this.handleProgressDragMove),document.removeEventListener("touchend",this.handleProgressDragEnd),document.removeEventListener("touchcancel",this.handleProgressDragEnd)}updateVideoTimeFromEvent(n){if(!this.progressBarRef.value)return;const t=this.progressBarRef.value.getBoundingClientRect();let e;if(n instanceof TouchEvent){const o=n.touches[0]||n.changedTouches[0];if(!o)return;e=o.clientX}else e=n.clientX;let r=Math.max(0,Math.min(e-t.left,t.width));const i=Math.min(r/t.width,.999);this.videoEl.currentTime=i*this.duration,this.updateProgress()}updateProgress(){cancelAnimationFrame(this.progressAnimationId),this.renderProgressAnimationFrame()}togglePlayPause(){this.videoEl.paused?this.videoEl.play():this.videoEl.pause()}toggleMuteUnmute(){this.videoEl.muted=!this.videoEl.muted}render(){return z`
      <div class="video">
        <slot></slot>

        <div class="controls">
          <button
            class="${kt({btn2:!0,"btn2--circle":!0,"btn2--secondary-alt":!0,"play-btn":!this.isPlaying})}"
            @click="${this.togglePlayPause}"
            ?hidden="${this.hidePlayPause}"
            aria-label="${this.isPlaying?"Pause":"Play"}"
          >
            ${this.isPlaying?xt(FO):xt(jO)}
          </button>

          <button
            class="btn2 btn2--circle btn2--secondary-alt"
            @click="${this.toggleMuteUnmute}"
            ?hidden="${this.hideVolume||!this.hasAudio}"
            aria-label="${this.isMuted?"Unmute":"Mute"}"
          >
            ${this.isMuted?xt(HO):xt(VO)}
          </button>

          <div
            class="progress-bar"
            @mousedown="${this.handleProgressDragStart}"
            @touchstart="${this.handleProgressDragStart}"
            @click="${this.updateVideoTimeFromEvent}"
            ${Le(this.progressBarRef)}
          >
            <div class="progress-bar__container">
              <div
                class="progress-bar__fill"
                style="--progress-percent: ${this.progressPercent*100}%"
              ></div>
            </div>
          </div>
        </div>
      </div>
    `}};Bt.styles=Z([WO,ih]);de([b({attribute:"hide-play-pause",type:Boolean})],Bt.prototype,"hidePlayPause",2);de([b({attribute:"hide-volume",type:Boolean})],Bt.prototype,"hideVolume",2);de([b({attribute:"toggle-play-on-click",type:Boolean})],Bt.prototype,"togglePlayOnClick",2);de([F()],Bt.prototype,"isPlaying",2);de([F()],Bt.prototype,"isMuted",2);de([F()],Bt.prototype,"isDragging",2);de([F()],Bt.prototype,"duration",2);de([F()],Bt.prototype,"progressPercent",2);de([F()],Bt.prototype,"hasAudio",2);de([Yu({passive:!1})],Bt.prototype,"handleProgressDragStart",1);Bt=de([J("drb-video")],Bt);op.bindListeners();document.addEventListener("click",n=>{n.target.closest("[data-sl-dialog-show]")&&document.querySelector(`sl-dialog#${n.target.dataset.slDialogShow}`).show(),n.target.closest("[data-sl-dialog-hide]")&&n.target.closest("sl-dialog").hide()});const rM={init({isFramer:n=!1}={}){this.bindFooterMarqueeScroll()},bindFooterMarqueeScroll(){const n=document.querySelector("[data-site-footer-marquee]");n&&n.addEventListener("scroll",()=>{n.scrollLeft>0&&n.classList.add("site-footer-marquee--scrolled")})}};export{rM as S};
//# sourceMappingURL=site-footer-18cb97ce.js.map
