import{d as l}from"./debounce-323e2cb5.js";import{g as c}from"./request-8716ca80.js";const h={init(){window.projectCostBreakdownInitialized||(this.fetchAbortController=null,window.projectCostBreakdownInitialized=!0,this.bindListeners())},getClosestBreakdownContainer(t){return t.closest("[data-project-breakdown]")},getMilestoneSelect(t){return t==null?void 0:t.querySelector("[data-project-breakdown-milestone-select]")},bindListeners(){document.addEventListener("click",t=>{var r,i;const o=(r=t.target.closest("[data-project-breakdown-set-mode]"))==null?void 0:r.getAttribute("data-project-breakdown-set-mode");o&&((i=this.getClosestBreakdownContainer(t.target))==null||i.setAttribute("data-project-breakdown-filter-mode",o))}),document.addEventListener("change",t=>{const o=this.getClosestBreakdownContainer(t.target),r=this.getMilestoneSelect(o);r===t.target&&(o==null||o.querySelectorAll("[data-project-breakdown-milestone-identifier]").forEach(e=>{e.toggleAttribute("hidden",e.getAttribute("data-project-breakdown-milestone-identifier")!==r.value)}))})},refetch:l(async function({form:t,path:o,previewMilestones:r=[],extraParams:i={}}){const e=t==null?void 0:t.querySelector("[data-project-breakdown]"),a=e==null?void 0:e.querySelector("[data-project-breakdown-content-container]"),n=this.getMilestoneSelect(e);if(!(!o||!e||!a))try{this.fetchAbortController&&this.fetchAbortController.abort("fetch cancelled"),this.fetchAbortController=new AbortController,e.setAttribute("loading","");const s=await fetch(o,{method:"POST",body:JSON.stringify({preview_milestones:r,selected_milestone_identifier:n!=null&&n.hasAttribute("hidden")?null:n==null?void 0:n.value,...i}),headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json","X-CSRF-Token":c()},signal:this.fetchAbortController.signal});a.innerHTML=await s.text()}catch(s){s.name!=="AbortError"&&console.warn(s)}finally{e==null||e.removeAttribute("loading")}},200)};export{h as P};
//# sourceMappingURL=project-cost-breakdown-b1fba35b.js.map
